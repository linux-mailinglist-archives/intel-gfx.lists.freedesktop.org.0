Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8A0F72D73D3
	for <lists+intel-gfx@lfdr.de>; Fri, 11 Dec 2020 11:22:17 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EF87B6ED34;
	Fri, 11 Dec 2020 10:22:13 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7E2DC6ED34
 for <intel-gfx@lists.freedesktop.org>; Fri, 11 Dec 2020 10:22:12 +0000 (UTC)
IronPort-SDR: pbpGaLtZLj7MjV+UdfLMBdNAJdoJeVJe2D8JVD4rQzu5XEHW30F9mRpVnQNUYmJ4by4LOQzbxd
 n8gZ9xFvwP9Q==
X-IronPort-AV: E=McAfee;i="6000,8403,9831"; a="170903685"
X-IronPort-AV: E=Sophos;i="5.78,411,1599548400"; d="scan'208";a="170903685"
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by fmsmga102.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 11 Dec 2020 02:22:11 -0800
IronPort-SDR: InzFm8jRkEdjrFRvEUNpIyzVl/s1rtv5/jvXFl7n9E3L35h795s9bnfMJ0MZ7Tddheqi+Bn1oV
 TijulhDum9Ng==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.78,411,1599548400"; d="scan'208";a="322052371"
Received: from fmsmsx604.amr.corp.intel.com ([10.18.126.84])
 by fmsmga007.fm.intel.com with ESMTP; 11 Dec 2020 02:22:11 -0800
Received: from bgsmsx601.gar.corp.intel.com (10.109.78.80) by
 fmsmsx604.amr.corp.intel.com (10.18.126.84) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.1713.5; Fri, 11 Dec 2020 02:22:09 -0800
Received: from irsmsx605.ger.corp.intel.com (163.33.146.138) by
 BGSMSX601.gar.corp.intel.com (10.109.78.80) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.1713.5; Fri, 11 Dec 2020 15:52:06 +0530
Received: from irsmsx605.ger.corp.intel.com ([163.33.146.138]) by
 IRSMSX605.ger.corp.intel.com ([163.33.146.138]) with mapi id 15.01.1713.004;
 Fri, 11 Dec 2020 10:22:05 +0000
From: "Mun, Gwan-gyeong" <gwan-gyeong.mun@intel.com>
To: "Gupta, Anshuman" <anshuman.gupta@intel.com>
Thread-Topic: [Intel-gfx] [PATCH v4 1/2] drm/i915/display: Support PSR
 Multiple Transcoders
Thread-Index: AQHWtCW5HUJLNoSYaEmiv3XYcL9jsKnnT5cAgAqW94A=
Date: Fri, 11 Dec 2020 10:22:05 +0000
Message-ID: <09fc5bb5aac38a15ab9d8783d1be57679169587b.camel@intel.com>
References: <20201106101443.686053-1-gwan-gyeong.mun@intel.com>
 <20201204163849.GF30377@intel.com>
In-Reply-To: <20201204163849.GF30377@intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [163.33.253.164]
Content-ID: <FD5E2FE1BE99964AA1CCEE7BAF2740AA@intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH v4 1/2] drm/i915/display: Support PSR
 Multiple Transcoders
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "intel-gfx@lists.freedesktop.org" <intel-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gRnJpLCAyMDIwLTEyLTA0IGF0IDIyOjA4ICswNTMwLCBBbnNodW1hbiBHdXB0YSB3cm90ZToN
Cj4gT24gMjAyMC0xMS0wNiBhdCAxNTo0NDo0MiArMDUzMCwgR3dhbi1neWVvbmcgTXVuIHdyb3Rl
Og0KPiA+IEl0IGlzIGEgcHJlbGltaW5hcnkgd29yayBmb3Igc3VwcG9ydGluZyBtdWx0aXBsZSBF
RFAgUFNSIGFuZA0KPiA+IERQIFBhbmVsUmVwbGF5LiBBbmQgaXQgcmVmYWN0b3JzIHNpbmdsZXRv
biBQU1IgdG8gTXVsdGkgVHJhbnNjb2Rlcg0KPiA+IHN1cHBvcnRhYmxlIFBTUi4NCj4gPiBBbmQg
dGhpcyBtb3ZlcyBhbmQgcmVuYW1lcyB0aGUgaTkxNV9wc3Igc3RydWN0dXJlIG9mDQo+ID4gZHJt
X2k5MTVfcHJpdmF0ZSdzIHRvDQo+ID4gaW50ZWxfZHAncyBpbnRlbF9wc3Igc3RydWN0dXJlLg0K
PiA+IEl0IGFsc28gY2F1c2VzIGNoYW5nZXMgaW4gUFNSIGludGVycnVwdCBoYW5kbGluZyByb3V0
aW5lIGZvcg0KPiA+IHN1cHBvcnRpbmcNCj4gPiBtdWx0aXBsZSB0cmFuc2NvZGVycy4gQnV0IGl0
IGRvZXMgbm90IGNoYW5nZSB0aGUgc2NlbmFyaW8gYW5kDQo+ID4gdGltaW5nIG9mDQo+ID4gZW5h
YmxpbmcgYW5kIGRpc2FibGluZyBQU1IuDQo+IENvdWxkIHlvdSBwbGVhc2UgYnJlYWsgdGhpcyBw
YXRjaCwgaXQgY2FuIGJlIGJyZWFrIGluIGZvbGxvd2luZw0KPiBwYXJ0cy4NCj4gMS4gcHNyIGlu
aXQgcGF0aA0KPiAyLiBhdG9taWMgY29tbWl0IHBhdGgNCj4gMy4gaXJxIHBhdGgNCj4gMy4gZGVi
dWdmcyBwYXRoIA0KPiANCkhpLCANClRoYW5rIHlvdSBmb3IgY2hlY2tpbmcgdGhlIHBhdGNoLg0K
DQpCZWNhdXNlIHRoZSBpOTE1X3BzciBzdHJ1Y3R1cmUgb2YgZHJtX2k5MTVfcHJpdmF0ZSdzIGhh
cyBtb3ZlZCB0bw0KaW50ZWxfZHAncyBpbnRlbF9wc3Igc3RydWN0dXJlLA0KSW4gb3JkZXIgdG8g
YmUgYWJsZSB0byBjb21waWxlIHRoZSBwYXRjaCwgYWxsIG9mIHRoZSBhZmZlY3RlZCBjb2RlIGhh
cw0KYmVlbiBpbmNsdWRlZC4NClNvIGl0J3MgaGFyZCB0byBzcGxpdCB3aGF0IHlvdSBtZW50aW9u
ZWQuDQp0aGVyZWZvcmUgdGhpcyBwYXRjaCBkb2VzIG5vdCBpbmNsdWRlIGEgbmV3IGZlYXR1cmUg
ZXhjZXB0IHN1cHBvcnRpbmcNCm11bHRpcGxlIHRyYW5zY29kZXIncyBwc3IuDQoNCj4gVGhlcmUg
YXJlIGNvdXBsZSBvZiBjb21tZW50cywgc2VlIGJlbG93LiANCj4gPiB2MjogRml4IGluZGVudGF0
aW9uIGFuZCBhZGQgY29tbWVudHMNCj4gPiB2MzogUmVtb3ZlIEJsYW5rIGxpbmUNCj4gPiB2NDog
UmViYXNlZA0KPiA+IA0KPiA+IFNpZ25lZC1vZmYtYnk6IEd3YW4tZ3llb25nIE11biA8Z3dhbi1n
eWVvbmcubXVuQGludGVsLmNvbT4NCj4gPiBDYzogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9z
ZS5zb3V6YUBpbnRlbC5jb20+DQo+ID4gQ2M6IEp1aGEtUGVra2EgSGVpa2tpbGEgPGp1aGFwZWtr
YS5oZWlra2lsYUBnbWFpbC5jb20+DQo+ID4gLS0tDQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGRpLmMgICAgICB8ICAgNSArDQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICB8ICAgNCAtDQo+ID4gIC4uLi9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jICB8IDExMSArKy0tDQo+ID4gIC4uLi9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCAgICB8ICAzOCArKw0KPiA+ICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMgICAgICAgfCAgMjMgKy0NCj4gPiAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYyAgICAgIHwgNTg1ICsrKysr
KysrKystLQ0KPiA+IC0tLS0tLQ0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Bzci5oICAgICAgfCAgMTQgKy0NCj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9zcHJpdGUuYyAgIHwgICA2ICstDQo+ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZHJ2LmggICAgICAgICAgICAgICB8ICAzOCAtLQ0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2lycS5jICAgICAgICAgICAgICAgfCAgNDcgKy0NCj4gPiAgMTAgZmlsZXMgY2hhbmdl
ZCwgNDkxIGluc2VydGlvbnMoKyksIDM4MCBkZWxldGlvbnMoLSkNCj4gPiANCj4gPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYw0KPiA+IGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYw0KPiA+IGluZGV4IDE5YjE2NTE3
YTUwMi4uOTgzNzgxY2UzNjgzIDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGRpLmMNCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RkaS5jDQo+ID4gQEAgLTQxMjcsNyArNDEyNywxMCBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9kZGlfdXBkYXRlX3BpcGVfZHAoc3RydWN0DQo+ID4gaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSwNCj4gPiAgDQo+ID4gIAlpbnRlbF9kZGlfc2V0X2RwX21zYShjcnRjX3N0YXRlLCBjb25u
X3N0YXRlKTsNCj4gPiAgDQo+ID4gKwkvL1RPRE86IG1vdmUgUFNSIHJlbGF0ZWQgZnVuY3Rpb25z
IGludG8gaW50ZWxfcHNyX3VwZGF0ZSgpDQo+ID4gKwlpbnRlbF9wc3IyX3Byb2dyYW1fdHJhbnNf
bWFuX3Rya19jdGwoaW50ZWxfZHAsIGNydGNfc3RhdGUpOw0KPiA+ICAJaW50ZWxfcHNyX3VwZGF0
ZShpbnRlbF9kcCwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7DQo+ID4gKw0KPiA+ICAJaW50ZWxf
ZHBfc2V0X2luZm9mcmFtZXMoZW5jb2RlciwgdHJ1ZSwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7
DQo+ID4gIAlpbnRlbF9lZHBfZHJyc191cGRhdGUoaW50ZWxfZHAsIGNydGNfc3RhdGUpOw0KPiA+
ICANCj4gPiBAQCAtNTI3NSw2ICs1Mjc4LDggQEAgdm9pZCBpbnRlbF9kZGlfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpDQo+ID4gIAkJ
CWdvdG8gZXJyOw0KPiA+ICANCj4gPiAgCQlkaWdfcG9ydC0+aHBkX3B1bHNlID0gaW50ZWxfZHBf
aHBkX3B1bHNlOw0KPiA+ICsNCj4gPiArCQlpbnRlbF9wc3JfaW5pdCgmZGlnX3BvcnQtPmRwKTsN
Cj4gSU1ITyB0aGlzIHNob3VsZCBiZSBjYWxsZWQgZnJvbSBpbnRlbF9kcF9pbml0X2Nvbm5lY3Rv
ci4NCllvdXIgcmVjb21tZW5kYXRpb24gc2VlbXMgYmV0dGVyLCBJJ2xsIHVwZGF0ZSBpdC4NCj4g
PiAgCX0NCj4gPiAgDQo+ID4gIAkvKiBJbiB0aGVvcnkgd2UgZG9uJ3QgbmVlZCB0aGUgZW5jb2Rl
ci0+dHlwZSBjaGVjaywgYnV0IGxlYXZlDQo+ID4gaXQganVzdCBpbg0KPiA+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYw0KPiA+IGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMNCj4gPiBpbmRleCA4YzQ2
ODdiMTk4MTQuLjQ2NjkyM2E1NDM3MCAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYw0KPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jDQo+ID4gQEAgLTE1NTA2LDggKzE1NTA2LDYgQEAg
c3RhdGljIHZvaWQgY29tbWl0X3BpcGVfY29uZmlnKHN0cnVjdA0KPiA+IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsDQo+ID4gIA0KPiA+ICAJCWlmIChuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3Bp
cGUpDQo+ID4gIAkJCWludGVsX3BpcGVfZmFzdHNldChvbGRfY3J0Y19zdGF0ZSwNCj4gPiBuZXdf
Y3J0Y19zdGF0ZSk7DQo+ID4gLQ0KPiA+IC0JCWludGVsX3BzcjJfcHJvZ3JhbV90cmFuc19tYW5f
dHJrX2N0bChuZXdfY3J0Y19zdGF0ZSk7DQo+ID4gIAl9DQo+ID4gIA0KPiA+ICAJaWYgKGRldl9w
cml2LT5kaXNwbGF5LmF0b21pY191cGRhdGVfd2F0ZXJtYXJrcykNCj4gPiBAQCAtMTc0MzUsOCAr
MTc0MzMsNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZXR1cF9vdXRwdXRzKHN0cnVjdA0KPiA+IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICAJCWludGVsX2R2b19pbml0KGRldl9wcml2
KTsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gLQlpbnRlbF9wc3JfaW5pdChkZXZfcHJpdik7DQo+ID4g
LQ0KPiA+ICAJZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmZGV2X3ByaXYtPmRybSwgZW5jb2Rlcikg
ew0KPiA+ICAJCWVuY29kZXItPmJhc2UucG9zc2libGVfY3J0Y3MgPQ0KPiA+ICAJCQlpbnRlbF9l
bmNvZGVyX3Bvc3NpYmxlX2NydGNzKGVuY29kZXIpOw0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jDQo+ID4gYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jDQo+ID4gaW5k
ZXggY2ZiNGMxNDc0OTgyLi44NDAyZTZhYzlmNzYgMTAwNjQ0DQo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X2RlYnVnZnMuYw0KPiA+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9kZWJ1Z2ZzLmMNCj4gPiBA
QCAtMjQ4LDE4ICsyNDgsMTcgQEAgc3RhdGljIGludCBpOTE1X3Bzcl9zaW5rX3N0YXR1c19zaG93
KHN0cnVjdA0KPiA+IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQ0KPiA+ICAJCSJzaW5rIGludGVy
bmFsIGVycm9yIiwNCj4gPiAgCX07DQo+ID4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVj
dG9yID0gbS0+cHJpdmF0ZTsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOw0KPiA+ICAJc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCA9DQo+ID4gIAkJaW50ZWxfYXR0YWNoZWRfZHAodG9faW50ZWxfY29ubmVjdG9yKGNvbm5l
Y3RvcikpOw0KPiA+ICAJaW50IHJldDsNCj4gPiAgDQo+ID4gLQlpZiAoIUNBTl9QU1IoZGV2X3By
aXYpKSB7DQo+ID4gLQkJc2VxX3B1dHMobSwgIlBTUiBVbnN1cHBvcnRlZFxuIik7DQo+ID4gKwlp
ZiAoY29ubmVjdG9yLT5zdGF0dXMgIT0gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQpDQo+ID4g
IAkJcmV0dXJuIC1FTk9ERVY7DQo+ID4gLQl9DQo+ID4gIA0KPiA+IC0JaWYgKGNvbm5lY3Rvci0+
c3RhdHVzICE9IGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkKQ0KPiA+ICsJaWYgKCFDQU5fUFNS
KGludGVsX2RwKSkgew0KPiA+ICsJCXNlcV9wdXRzKG0sICJQU1IgVW5zdXBwb3J0ZWRcbiIpOw0K
PiA+ICAJCXJldHVybiAtRU5PREVWOw0KPiA+ICsJfQ0KPiA+ICANCj4gPiAgCXJldCA9IGRybV9k
cF9kcGNkX3JlYWRiKCZpbnRlbF9kcC0+YXV4LCBEUF9QU1JfU1RBVFVTLCAmdmFsKTsNCj4gPiAg
DQo+ID4gQEAgLTI3OSwxMiArMjc4LDEzIEBAIHN0YXRpYyBpbnQgaTkxNV9wc3Jfc2lua19zdGF0
dXNfc2hvdyhzdHJ1Y3QNCj4gPiBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkNCj4gPiAgREVGSU5F
X1NIT1dfQVRUUklCVVRFKGk5MTVfcHNyX3Npbmtfc3RhdHVzKTsNCj4gPiAgDQo+ID4gIHN0YXRp
YyB2b2lkDQo+ID4gLXBzcl9zb3VyY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgc3RydWN0DQo+ID4gc2VxX2ZpbGUgKm0pDQo+ID4gK3Bzcl9zb3VyY2Vfc3RhdHVz
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHN0cnVjdCBzZXFfZmlsZSAqbSkNCj4gPiAgew0K
PiA+ICAJdTMyIHZhbCwgc3RhdHVzX3ZhbDsNCj4gPiAgCWNvbnN0IGNoYXIgKnN0YXR1cyA9ICJ1
bmtub3duIjsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3Rv
X2k5MTUoaW50ZWxfZHApOw0KPiA+ICANCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5h
YmxlZCkgew0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkKSB7DQo+ID4gIAkJ
c3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBsaXZlX3N0YXR1c1tdID0gew0KPiA+ICAJCQkiSURM
RSIsDQo+ID4gIAkJCSJDQVBUVVJFIiwNCj4gPiBAQCAtMjk5LDcgKzI5OSw3IEBAIHBzcl9zb3Vy
Y2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2LCBzdHJ1Y3Qg
c2VxX2ZpbGUgKm0pDQo+ID4gIAkJCSJUR19PTiINCj4gPiAgCQl9Ow0KPiA+ICAJCXZhbCA9IGlu
dGVsX2RlX3JlYWQoZGV2X3ByaXYsDQo+ID4gLQkJCQkgICAgRURQX1BTUjJfU1RBVFVTKGRldl9w
cml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICsJCQkJICAgIEVEUF9QU1IyX1NUQVRV
UyhpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiAgCQlzdGF0dXNfdmFsID0g
KHZhbCAmIEVEUF9QU1IyX1NUQVRVU19TVEFURV9NQVNLKSA+Pg0KPiA+ICAJCQkgICAgICBFRFBf
UFNSMl9TVEFUVVNfU1RBVEVfU0hJRlQ7DQo+ID4gIAkJaWYgKHN0YXR1c192YWwgPCBBUlJBWV9T
SVpFKGxpdmVfc3RhdHVzKSkNCj4gPiBAQCAtMzE2LDcgKzMxNiw3IEBAIHBzcl9zb3VyY2Vfc3Rh
dHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2LCBzdHJ1Y3Qgc2VxX2Zp
bGUgKm0pDQo+ID4gIAkJCSJTUkRFTlRfT04iLA0KPiA+ICAJCX07DQo+ID4gIAkJdmFsID0gaW50
ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4gPiAtCQkJCSAgICBFRFBfUFNSX1NUQVRVUyhkZXZfcHJp
di0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiArCQkJCSAgICBFRFBfUFNSX1NUQVRVUyhp
bnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiAgCQlzdGF0dXNfdmFsID0gKHZh
bCAmIEVEUF9QU1JfU1RBVFVTX1NUQVRFX01BU0spID4+DQo+ID4gIAkJCSAgICAgIEVEUF9QU1Jf
U1RBVFVTX1NUQVRFX1NISUZUOw0KPiA+ICAJCWlmIChzdGF0dXNfdmFsIDwgQVJSQVlfU0laRShs
aXZlX3N0YXR1cykpDQo+ID4gQEAgLTMyNiwyMSArMzI2LDE4IEBAIHBzcl9zb3VyY2Vfc3RhdHVz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2LCBzdHJ1Y3Qgc2VxX2ZpbGUg
Km0pDQo+ID4gIAlzZXFfcHJpbnRmKG0sICJTb3VyY2UgUFNSIHN0YXR1czogJXMgWzB4JTA4eF1c
biIsIHN0YXR1cywgdmFsKTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAtc3RhdGljIGludCBpOTE1X2Vk
cF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkNCj4gPiArc3RhdGlj
IGludCBpbnRlbF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGludGVsX2Rw
DQo+ID4gKmludGVsX2RwKQ0KPiA+ICB7DQo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7DQo+ID4gLQlzdHJ1Y3QgaTkxNV9w
c3IgKnBzciA9ICZkZXZfcHJpdi0+cHNyOw0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gKwlzdHJ1Y3QgaW50ZWxfcHNy
ICpwc3IgPSAmaW50ZWxfZHAtPnBzcjsNCj4gPiAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOw0K
PiA+ICAJY29uc3QgY2hhciAqc3RhdHVzOw0KPiA+ICAJYm9vbCBlbmFibGVkOw0KPiA+ICAJdTMy
IHZhbDsNCj4gPiAgDQo+ID4gLQlpZiAoIUhBU19QU1IoZGV2X3ByaXYpKQ0KPiA+IC0JCXJldHVy
biAtRU5PREVWOw0KPiA+IC0NCj4gPiAgCXNlcV9wcmludGYobSwgIlNpbmsgc3VwcG9ydDogJXMi
LCB5ZXNubyhwc3ItPnNpbmtfc3VwcG9ydCkpOw0KPiA+IC0JaWYgKHBzci0+ZHApDQo+ID4gLQkJ
c2VxX3ByaW50ZihtLCAiIFsweCUwMnhdIiwgcHNyLT5kcC0+cHNyX2RwY2RbMF0pOw0KPiA+ICsJ
aWYgKHBzci0+c2lua19zdXBwb3J0KQ0KPiA+ICsJCXNlcV9wcmludGYobSwgIiBbMHglMDJ4XSIs
IGludGVsX2RwLT5wc3JfZHBjZFswXSk7DQo+ID4gIAlzZXFfcHV0cyhtLCAiXG4iKTsNCj4gPiAg
DQo+ID4gIAlpZiAoIXBzci0+c2lua19zdXBwb3J0KQ0KPiA+IEBAIC0zNjQsMTYgKzM2MSwxNiBA
QCBzdGF0aWMgaW50IGk5MTVfZWRwX3Bzcl9zdGF0dXMoc3RydWN0DQo+ID4gc2VxX2ZpbGUgKm0s
IHZvaWQgKmRhdGEpDQo+ID4gIA0KPiA+ICAJaWYgKHBzci0+cHNyMl9lbmFibGVkKSB7DQo+ID4g
IAkJdmFsID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4gPiAtCQkJCSAgICBFRFBfUFNSMl9D
VEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gKwkJCQkgICAgRURQX1BT
UjJfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICAJCWVuYWJsZWQg
PSB2YWwgJiBFRFBfUFNSMl9FTkFCTEU7DQo+ID4gIAl9IGVsc2Ugew0KPiA+ICAJCXZhbCA9IGlu
dGVsX2RlX3JlYWQoZGV2X3ByaXYsDQo+ID4gLQkJCQkgICAgRURQX1BTUl9DVEwoZGV2X3ByaXYt
DQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gKwkJCQkgICAgRURQX1BTUl9DVEwoaW50ZWxf
ZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gIAkJZW5hYmxlZCA9IHZhbCAmIEVEUF9Q
U1JfRU5BQkxFOw0KPiA+ICAJfQ0KPiA+ICAJc2VxX3ByaW50ZihtLCAiU291cmNlIFBTUiBjdGw6
ICVzIFsweCUwOHhdXG4iLA0KPiA+ICAJCSAgIGVuYWJsZWRkaXNhYmxlZChlbmFibGVkKSwgdmFs
KTsNCj4gPiAtCXBzcl9zb3VyY2Vfc3RhdHVzKGRldl9wcml2LCBtKTsNCj4gPiArCXBzcl9zb3Vy
Y2Vfc3RhdHVzKGludGVsX2RwLCBtKTsNCj4gPiAgCXNlcV9wcmludGYobSwgIkJ1c3kgZnJvbnRi
dWZmZXIgYml0czogMHglMDh4XG4iLA0KPiA+ICAJCSAgIHBzci0+YnVzeV9mcm9udGJ1ZmZlcl9i
aXRzKTsNCj4gPiAgDQo+ID4gQEAgLTM4Miw3ICszNzksNyBAQCBzdGF0aWMgaW50IGk5MTVfZWRw
X3Bzcl9zdGF0dXMoc3RydWN0IHNlcV9maWxlDQo+ID4gKm0sIHZvaWQgKmRhdGEpDQo+ID4gIAkg
Ki8NCj4gPiAgCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3By
aXYpKSB7DQo+ID4gIAkJdmFsID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4gPiAtCQkJCSAg
ICBFRFBfUFNSX1BFUkZfQ05UKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+
ICsJCQkJICAgIEVEUF9QU1JfUEVSRl9DTlQoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVy
KSk7DQo+ID4gIAkJdmFsICY9IEVEUF9QU1JfUEVSRl9DTlRfTUFTSzsNCj4gPiAgCQlzZXFfcHJp
bnRmKG0sICJQZXJmb3JtYW5jZSBjb3VudGVyOiAldVxuIiwgdmFsKTsNCj4gPiAgCX0NCj4gPiBA
QCAtNDAzLDcgKzQwMCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9lZHBfcHNyX3N0YXR1cyhzdHJ1Y3Qg
c2VxX2ZpbGUNCj4gPiAqbSwgdm9pZCAqZGF0YSkNCj4gPiAgCQkgKi8NCj4gPiAgCQlmb3IgKGZy
YW1lID0gMDsgZnJhbWUgPCBQU1IyX1NVX1NUQVRVU19GUkFNRVM7IGZyYW1lICs9DQo+ID4gMykg
ew0KPiA+ICAJCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+IC0JCQkJCSAgICBQ
U1IyX1NVX1NUQVRVUyhkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIsIGZyYW1lKSk7DQo+
ID4gKwkJCQkJICAgIFBTUjJfU1VfU1RBVFVTKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2Rl
ciwgZnJhbWUpKTsNCj4gPiAgCQkJc3VfZnJhbWVzX3ZhbFtmcmFtZSAvIDNdID0gdmFsOw0KPiA+
ICAJCX0NCj4gPiAgDQo+ID4gQEAgLTQyOSwyMyArNDI2LDU3IEBAIHN0YXRpYyBpbnQgaTkxNV9l
ZHBfcHNyX3N0YXR1cyhzdHJ1Y3QNCj4gPiBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkNCj4gPiAg
CXJldHVybiAwOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICtzdGF0aWMgaW50IGk5MTVfZWRwX3Bzcl9z
dGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQ0KPiA+ICt7DQo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
DQo+ID4gKwlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsNCj4gPiArCXN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAgPSBOVUxMOw0KPiA+ICsNCj4gPiArCWlmICghSEFTX1BTUihkZXZfcHJp
dikpDQo+ID4gKwkJcmV0dXJuIC1FTk9ERVY7DQo+ID4gKw0KPiA+ICsJLyogRmluZCB0aGUgZmly
c3QgRURQICovDQo+ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRybSwgZW5jb2Rl
cikgew0KPiA+ICsJCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFApIHsNCj4g
PiArCQkJaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoZW5jb2Rlcik7DQo+ID4gKwkJCWJyZWFr
Ow0KPiA+ICsJCX0NCj4gPiArCX0NCj4gPiArDQo+ID4gKwlpZiAoIWludGVsX2RwKQ0KPiA+ICsJ
CXJldHVybiAtRU5PREVWOw0KPiA+ICsNCj4gPiArCXJldHVybiBpbnRlbF9wc3Jfc3RhdHVzKG0s
IGludGVsX2RwKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiAgc3RhdGljIGludA0KPiA+ICBpOTE1X2Vk
cF9wc3JfZGVidWdfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpDQo+ID4gIHsNCj4gPiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRhdGE7DQo+ID4gIAlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZjsNCj4gPiAtCWludCByZXQ7DQo+ID4gKwlpbnQgcmV0ID0gLUVOT0RFVjsNCj4g
PiArCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOw0KPiA+ICANCj4gPiAtCWlmICghQ0FO
X1BTUihkZXZfcHJpdikpDQo+ID4gLQkJcmV0dXJuIC1FTk9ERVY7DQo+ID4gKwlpZiAoIUhBU19Q
U1IoZGV2X3ByaXYpKQ0KPiA+ICsJCXJldHVybiByZXQ7DQo+ID4gIA0KPiA+IC0JZHJtX2RiZ19r
bXMoJmRldl9wcml2LT5kcm0sICJTZXR0aW5nIFBTUiBkZWJ1ZyB0byAlbGx4XG4iLA0KPiA+IHZh
bCk7DQo+ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRybSwgZW5jb2Rlcikgew0K
PiA+ICsJCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoZW5jb2Rl
cik7DQo+ID4gIA0KPiA+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJp
di0+cnVudGltZV9wbSk7DQo+ID4gKwkJaWYgKCFDQU5fUFNSKGludGVsX2RwKSkNCj4gPiArCQkJ
Y29udGludWU7DQo+ID4gIA0KPiA+IC0JcmV0ID0gaW50ZWxfcHNyX2RlYnVnX3NldChkZXZfcHJp
diwgdmFsKTsNCj4gPiArCQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQKSB7
DQo+ID4gKwkJCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLCAiU2V0dGluZyBQU1IgZGVidWcN
Cj4gPiB0byAlbGx4XG4iLCB2YWwpOw0KPiA+ICANCj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0
KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7DQo+ID4gKwkJCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtDQo+ID4gPnJ1bnRpbWVfcG0pOw0KPiA+ICsNCj4g
PiArCQkJLy8gVE9ETzogc3BsaXQgdG8gZWFjaCB0cmFuc2NvZGVyJ3MgUFNSIGRlYnVnDQo+ID4g
c3RhdGUNCj4gPiArCQkJcmV0ID0gaW50ZWxfcHNyX2RlYnVnX3NldChpbnRlbF9kcCwgdmFsKTsN
Cj4gPiArDQo+ID4gKwkJCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9w
bSwNCj4gPiB3YWtlcmVmKTsNCj4gPiArCQl9DQo+ID4gKwl9DQo+ID4gIA0KPiA+ICAJcmV0dXJu
IHJldDsNCj4gPiAgfQ0KPiA+IEBAIC00NTQsMTIgKzQ4NSwyNSBAQCBzdGF0aWMgaW50DQo+ID4g
IGk5MTVfZWRwX3Bzcl9kZWJ1Z19nZXQodm9pZCAqZGF0YSwgdTY0ICp2YWwpDQo+ID4gIHsNCj4g
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRhdGE7DQo+ID4gKwlzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsNCj4gPiAgDQo+ID4gLQlpZiAoIUNBTl9QU1IoZGV2
X3ByaXYpKQ0KPiA+ICsJaWYgKCFIQVNfUFNSKGRldl9wcml2KSkNCj4gPiAgCQlyZXR1cm4gLUVO
T0RFVjsNCj4gPiAgDQo+ID4gLQkqdmFsID0gUkVBRF9PTkNFKGRldl9wcml2LT5wc3IuZGVidWcp
Ow0KPiA+IC0JcmV0dXJuIDA7DQo+ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRy
bSwgZW5jb2Rlcikgew0KPiA+ICsJCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9f
aW50ZWxfZHAoZW5jb2Rlcik7DQo+ID4gKw0KPiA+ICsJCWlmICghQ0FOX1BTUihpbnRlbF9kcCkp
DQo+ID4gKwkJCWNvbnRpbnVlOw0KPiA+ICsNCj4gPiArCQkvLyBUT0RPOiBzcGxpdCB0byBlYWNo
IHRyYW5zY29kZXIncyBQU1IgZGVidWcgc3RhdGUNCj4gPiArCQlpZiAoZW5jb2Rlci0+dHlwZSA9
PSBJTlRFTF9PVVRQVVRfRURQKSB7DQo+ID4gKwkJCSp2YWwgPSBSRUFEX09OQ0UoaW50ZWxfZHAt
PnBzci5kZWJ1Zyk7DQo+ID4gKwkJCXJldHVybiAwOw0KPiA+ICsJCX0NCj4gPiArCX0NCj4gPiAr
DQo+ID4gKwlyZXR1cm4gLUVOT0RFVjsNCj4gPiAgfQ0KPiA+ICANCj4gPiAgREVGSU5FX1NJTVBM
RV9BVFRSSUJVVEUoaTkxNV9lZHBfcHNyX2RlYnVnX2ZvcHMsDQo+ID4gQEAgLTExMDMsOSArMTE0
Nyw2IEBAIHN0YXRpYyB2b2lkIGRycnNfc3RhdHVzX3Blcl9jcnRjKHN0cnVjdA0KPiA+IHNlcV9m
aWxlICptLA0KPiA+ICAJCS8qIGRpc2FibGVfZHJycygpIHdpbGwgbWFrZSBkcnJzLT5kcCBOVUxM
ICovDQo+ID4gIAkJaWYgKCFkcnJzLT5kcCkgew0KPiA+ICAJCQlzZXFfcHV0cyhtLCAiSWRsZW5l
c3MgRFJSUzogRGlzYWJsZWRcbiIpOw0KPiA+IC0JCQlpZiAoZGV2X3ByaXYtPnBzci5lbmFibGVk
KQ0KPiA+IC0JCQkJc2VxX3B1dHMobSwNCj4gPiAtCQkJCSJcdEFzIFBTUiBpcyBlbmFibGVkLCBE
UlJTIGlzIG5vdA0KPiA+IGVuYWJsZWRcbiIpOw0KPiA+ICAJCQltdXRleF91bmxvY2soJmRycnMt
Pm11dGV4KTsNCj4gPiAgCQkJcmV0dXJuOw0KPiA+ICAJCX0NCj4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgNCj4gPiBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oDQo+ID4gaW5k
ZXggZjZmMDYyNjY0OWUwLi4yZTQwZmNiYWIyYWEgMTAwNjQ0DQo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgNCj4gPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaA0KPiA+IEBAIC0x
Mjg2LDYgKzEyODYsNDIgQEAgc3RydWN0IGludGVsX2RwX2NvbXBsaWFuY2Ugew0KPiA+ICAJdTgg
dGVzdF9sYW5lX2NvdW50Ow0KPiA+ICB9Ow0KPiA+ICANCj4gPiArc3RydWN0IGludGVsX3BzciB7
DQo+ID4gKwkvKiBNdXRleCBmb3IgUFNSIHN0YXRlIG9mIHRoZSB0cmFuc2NvZGVyICovDQo+ID4g
KwlzdHJ1Y3QgbXV0ZXggbG9jazsNCj4gPiArDQo+ID4gKyNkZWZpbmUgSTkxNV9QU1JfREVCVUdf
TU9ERV9NQVNLCTB4MGYNCj4gPiArI2RlZmluZSBJOTE1X1BTUl9ERUJVR19ERUZBVUxUCQkweDAw
DQo+ID4gKyNkZWZpbmUgSTkxNV9QU1JfREVCVUdfRElTQUJMRQkJMHgwMQ0KPiA+ICsjZGVmaW5l
IEk5MTVfUFNSX0RFQlVHX0VOQUJMRQkJMHgwMg0KPiA+ICsjZGVmaW5lIEk5MTVfUFNSX0RFQlVH
X0ZPUkNFX1BTUjEJMHgwMw0KPiA+ICsjZGVmaW5lIEk5MTVfUFNSX0RFQlVHX0lSUQkJMHgxMA0K
PiA+ICsNCj4gPiArCXUzMiBkZWJ1ZzsNCj4gPiArCWJvb2wgc2lua19zdXBwb3J0Ow0KPiA+ICsJ
Ym9vbCBlbmFibGVkOw0KPiA+ICsJZW51bSBwaXBlIHBpcGU7DQo+ID4gKwllbnVtIHRyYW5zY29k
ZXIgdHJhbnNjb2RlcjsNCj4gPiArCWJvb2wgYWN0aXZlOw0KPiA+ICsJc3RydWN0IHdvcmtfc3Ry
dWN0IHdvcms7DQo+ID4gKwl1bnNpZ25lZCBpbnQgYnVzeV9mcm9udGJ1ZmZlcl9iaXRzOw0KPiA+
ICsJYm9vbCBzaW5rX3BzcjJfc3VwcG9ydDsNCj4gPiArCWJvb2wgbGlua19zdGFuZGJ5Ow0KPiA+
ICsJYm9vbCBjb2xvcmltZXRyeV9zdXBwb3J0Ow0KPiA+ICsJYm9vbCBwc3IyX2VuYWJsZWQ7DQo+
ID4gKwlib29sIHBzcjJfc2VsX2ZldGNoX2VuYWJsZWQ7DQo+ID4gKwl1OCBzaW5rX3N5bmNfbGF0
ZW5jeTsNCj4gPiArCWt0aW1lX3QgbGFzdF9lbnRyeV9hdHRlbXB0Ow0KPiA+ICsJa3RpbWVfdCBs
YXN0X2V4aXQ7DQo+ID4gKwlib29sIHNpbmtfbm90X3JlbGlhYmxlOw0KPiA+ICsJYm9vbCBpcnFf
YXV4X2Vycm9yOw0KPiA+ICsJdTE2IHN1X3hfZ3JhbnVsYXJpdHk7DQo+ID4gKwlib29sIGRjM2Nv
X2VuYWJsZWQ7DQo+ID4gKwl1MzIgZGMzY29fZXhpdF9kZWxheTsNCj4gPiArCXN0cnVjdCBkZWxh
eWVkX3dvcmsgZGMzY29fd29yazsNCj4gPiArCXN0cnVjdCBkcm1fZHBfdnNjX3NkcCB2c2M7DQo+
ID4gK307DQo+ID4gKw0KPiA+ICBzdHJ1Y3QgaW50ZWxfZHAgew0KPiA+ICAJaTkxNV9yZWdfdCBv
dXRwdXRfcmVnOw0KPiA+ICAJdTMyIERQOw0KPiA+IEBAIC0xNDA2LDYgKzE0NDIsOCBAQCBzdHJ1
Y3QgaW50ZWxfZHAgew0KPiA+ICANCj4gPiAgCWJvb2wgaG9ibF9mYWlsZWQ7DQo+ID4gIAlib29s
IGhvYmxfYWN0aXZlOw0KPiA+ICsNCj4gPiArCXN0cnVjdCBpbnRlbF9wc3IgcHNyOw0KPiA+ICB9
Ow0KPiA+ICANCj4gPiAgZW51bSBsc3Bjb25fdmVuZG9yIHsNCj4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jDQo+ID4gYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMNCj4gPiBpbmRleCAzYjBkYmRhNTkxOWEuLjY0YWJj
OWQwMzdmOCAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2RwLmMNCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rw
LmMNCj4gPiBAQCAtMjY0MCwxMiArMjY0MCwxMCBAQCB2b2lkIGludGVsX2RwX2NvbXB1dGVfcHNy
X3ZzY19zZHAoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwLA0KPiA+ICAJCQkJICBjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZQ0KPiA+ICpjb25uX3N0YXRlLA0KPiA+ICAJCQkJ
ICBzdHJ1Y3QgZHJtX2RwX3ZzY19zZHAgKnZzYykNCj4gPiAgew0KPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gLQ0KPiA+
ICAJdnNjLT5zZHBfdHlwZSA9IERQX1NEUF9WU0M7DQo+ID4gIA0KPiA+IC0JaWYgKGRldl9wcml2
LT5wc3IucHNyMl9lbmFibGVkKSB7DQo+ID4gLQkJaWYgKGRldl9wcml2LT5wc3IuY29sb3JpbWV0
cnlfc3VwcG9ydCAmJg0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkKSB7DQo+
ID4gKwkJaWYgKGludGVsX2RwLT5wc3IuY29sb3JpbWV0cnlfc3VwcG9ydCAmJg0KPiA+ICAJCSAg
ICBpbnRlbF9kcF9uZWVkc192c2Nfc2RwKGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpKSB7DQo+ID4g
IAkJCS8qIFtQU1IyLCArQ29sb3JpbWV0cnldICovDQo+ID4gIAkJCWludGVsX2RwX2NvbXB1dGVf
dnNjX2NvbG9yaW1ldHJ5KGNydGNfc3RhdGUsDQo+ID4gY29ubl9zdGF0ZSwNCj4gPiBAQCAtMzc3
OCw3ICszNzc2LDcgQEAgYm9vbCBpbnRlbF9kcF9pbml0aWFsX2Zhc3RzZXRfY2hlY2soc3RydWN0
DQo+ID4gaW50ZWxfZW5jb2RlciAqZW5jb2RlciwNCj4gPiAgCQlyZXR1cm4gZmFsc2U7DQo+ID4g
IAl9DQo+ID4gIA0KPiA+IC0JaWYgKENBTl9QU1IoaTkxNSkgJiYgaW50ZWxfZHBfaXNfZWRwKGlu
dGVsX2RwKSkgew0KPiA+ICsJaWYgKENBTl9QU1IoaW50ZWxfZHApICYmIGludGVsX2RwX2lzX2Vk
cChpbnRlbF9kcCkpIHsNCj4gPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLCAiRm9yY2luZyBm
dWxsIG1vZGVzZXQgdG8NCj4gPiBjb21wdXRlIFBTUiBzdGF0ZVxuIik7DQo+ID4gIAkJY3J0Y19z
dGF0ZS0+dWFwaS5tb2RlX2NoYW5nZWQgPSB0cnVlOw0KPiA+ICAJCXJldHVybiBmYWxzZTsNCj4g
PiBAQCAtNzk3OCw2ICs3OTc2LDE3IEBAIHN0YXRpYyB2b2lkDQo+ID4gaW50ZWxfZHBfbW9kZXNl
dF9yZXRyeV93b3JrX2ZuKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykNCj4gPiAgCWRybV9rbXNf
aGVscGVyX2hvdHBsdWdfZXZlbnQoY29ubmVjdG9yLT5kZXYpOw0KPiA+ICB9DQo+ID4gIA0KPiA+
ICtzdGF0aWMgdm9pZCBpbnRlbF9kcF91cGRhdGVfcGlwZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwNCj4gPiArCQkJCSBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwNCj4g
PiArCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpjcnRjX3N0YXRlLA0K
PiA+ICsJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlDQo+ID4gKmNvbm5fc3Rh
dGUpDQo+ID4gK3sNCj4gPiArCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50
ZWxfZHAoZW5jb2Rlcik7DQo+ID4gKw0KPiA+ICsJaW50ZWxfcGFuZWxfdXBkYXRlX2JhY2tsaWdo
dChzdGF0ZSwgZW5jb2RlciwgY3J0Y19zdGF0ZSwNCj4gPiBjb25uX3N0YXRlKTsNCj4gPiArCWlu
dGVsX3BzcjJfcHJvZ3JhbV90cmFuc19tYW5fdHJrX2N0bChpbnRlbF9kcCwgY3J0Y19zdGF0ZSk7
DQo+ID4gK30NCj4gPiArDQo+ID4gIGJvb2wNCj4gPiAgaW50ZWxfZHBfaW5pdF9jb25uZWN0b3Io
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsDQo+ID4gIAkJCXN0cnVjdCBpbnRl
bF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcikNCj4gPiBAQCAtODEzMyw3ICs4MTQyLDcgQEAg
Ym9vbCBpbnRlbF9kcF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2
LA0KPiA+ICAJaW50ZWxfZW5jb2Rlci0+Z2V0X2NvbmZpZyA9IGludGVsX2RwX2dldF9jb25maWc7
DQo+ID4gIAlpbnRlbF9lbmNvZGVyLT5zeW5jX3N0YXRlID0gaW50ZWxfZHBfc3luY19zdGF0ZTsN
Cj4gPiAgCWludGVsX2VuY29kZXItPmluaXRpYWxfZmFzdHNldF9jaGVjayA9DQo+ID4gaW50ZWxf
ZHBfaW5pdGlhbF9mYXN0c2V0X2NoZWNrOw0KPiA+IC0JaW50ZWxfZW5jb2Rlci0+dXBkYXRlX3Bp
cGUgPSBpbnRlbF9wYW5lbF91cGRhdGVfYmFja2xpZ2h0Ow0KPiA+ICsJaW50ZWxfZW5jb2Rlci0+
dXBkYXRlX3BpcGUgPSBpbnRlbF9kcF91cGRhdGVfcGlwZTsNCj4gPiAgCWludGVsX2VuY29kZXIt
PnN1c3BlbmQgPSBpbnRlbF9kcF9lbmNvZGVyX3N1c3BlbmQ7DQo+ID4gIAlpbnRlbF9lbmNvZGVy
LT5zaHV0ZG93biA9IGludGVsX2RwX2VuY29kZXJfc2h1dGRvd247DQo+ID4gIAlpZiAoSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpIHsNCj4gPiBAQCAtODIyMCw2ICs4MjI5LDggQEAgYm9vbCBpbnRl
bF9kcF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2LA0KPiA+ICAJ
aWYgKCFpbnRlbF9kcF9pbml0X2Nvbm5lY3RvcihkaWdfcG9ydCwgaW50ZWxfY29ubmVjdG9yKSkN
Cj4gPiAgCQlnb3RvIGVycl9pbml0X2Nvbm5lY3RvcjsNCj4gPiAgDQo+ID4gKwlpbnRlbF9wc3Jf
aW5pdCgmZGlnX3BvcnQtPmRwKTsNCj4gSU1ITyB0aGlzIHdpbGwgbm90IGdldCBjYWxsZWQgZm9y
IERESSBlbmNvZGVyIGludGVsX2RwX2luaXRfY29ubmVjdG9yDQo+IGlzIGNvcnJlY3IgcGxhY2UN
Cj4gdG8gaW5pdGlhbGl6ZSBpdC4NCj4gDQo+IFRoYW5rcywNCj4gQW5zaHVtYW4gR3VwdGEuDQo+
ID4gKw0KPiA+ICAJcmV0dXJuIHRydWU7DQo+ID4gIA0KPiA+ICBlcnJfaW5pdF9jb25uZWN0b3I6
DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNy
LmMNCj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmMNCj4gPiBp
bmRleCBiMzYzMWI3MjJkZTMuLjhkODU4ZDU2YzczNiAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jDQo+ID4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYw0KPiA+IEBAIC03OSwxMSArNzksMTMgQEANCj4g
PiAgICogdXNlIHBhZ2UgZmxpcHMuDQo+ID4gICAqLw0KPiA+ICANCj4gPiAtc3RhdGljIGJvb2wg
cHNyX2dsb2JhbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQ0KPiA+ICtz
dGF0aWMgYm9vbCBwc3JfZ2xvYmFsX2VuYWJsZWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkN
Cj4gPiAgew0KPiA+IC0Jc3dpdGNoIChpOTE1LT5wc3IuZGVidWcgJiBJOTE1X1BTUl9ERUJVR19N
T0RFX01BU0spIHsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRw
X3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICsNCj4gPiArCXN3aXRjaCAoaW50ZWxfZHAtPnBzci5k
ZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSykgew0KPiA+ICAJY2FzZSBJOTE1X1BTUl9E
RUJVR19ERUZBVUxUOg0KPiA+IC0JCXJldHVybiBpOTE1LT5wYXJhbXMuZW5hYmxlX3BzcjsNCj4g
PiArCQlyZXR1cm4gZGV2X3ByaXYtPnBhcmFtcy5lbmFibGVfcHNyOw0KPiA+ICAJY2FzZSBJOTE1
X1BTUl9ERUJVR19ESVNBQkxFOg0KPiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiAgCWRlZmF1bHQ6
DQo+ID4gQEAgLTkxLDkgKzkzLDkgQEAgc3RhdGljIGJvb2wgcHNyX2dsb2JhbF9lbmFibGVkKHN0
cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpDQo+ID4gIAl9DQo+ID4gIH0NCj4gPiAg
DQo+ID4gLXN0YXRpYyBib29sIHBzcjJfZ2xvYmFsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQ0KPiA+ICtzdGF0aWMgYm9vbCBwc3IyX2dsb2JhbF9lbmFibGVkKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAtCXN3aXRjaCAoZGV2X3ByaXYt
PnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSykgew0KPiA+ICsJc3dpdGNoIChp
bnRlbF9kcC0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfTU9ERV9NQVNLKSB7DQo+ID4gIAlj
YXNlIEk5MTVfUFNSX0RFQlVHX0RJU0FCTEU6DQo+ID4gIAljYXNlIEk5MTVfUFNSX0RFQlVHX0ZP
UkNFX1BTUjE6DQo+ID4gIAkJcmV0dXJuIGZhbHNlOw0KPiA+IEBAIC0xMDIsMTEgKzEwNCwxMiBA
QCBzdGF0aWMgYm9vbCBwc3IyX2dsb2JhbF9lbmFibGVkKHN0cnVjdA0KPiA+IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQ0KPiA+ICAJfQ0KPiA+ICB9DQo+ID4gIA0KPiA+IC1zdGF0aWMgdm9p
ZCBwc3JfaXJxX2NvbnRyb2woc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+
ICtzdGF0aWMgdm9pZCBwc3JfaXJxX2NvbnRyb2woc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkN
Cj4gPiAgew0KPiA+ICAJZW51bSB0cmFuc2NvZGVyIHRyYW5zX3NoaWZ0Ow0KPiA+ICAJdTMyIG1h
c2ssIHZhbDsNCj4gPiAgCWk5MTVfcmVnX3QgaW1yX3JlZzsNCj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICANCj4gPiAg
CS8qDQo+ID4gIAkgKiBnZW4xMisgaGFzIHJlZ2lzdGVycyByZWxhdGl2ZSB0byB0cmFuc2NvZGVy
IGFuZCBvbmUgcGVyDQo+ID4gdHJhbnNjb2Rlcg0KPiA+IEBAIC0xMTUsMTQgKzExOCwxNCBAQCBz
dGF0aWMgdm9pZCBwc3JfaXJxX2NvbnRyb2woc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpDQo+ID4gIAkgKi8NCj4gPiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEy
KSB7DQo+ID4gIAkJdHJhbnNfc2hpZnQgPSAwOw0KPiA+IC0JCWltcl9yZWcgPSBUUkFOU19QU1Jf
SU1SKGRldl9wcml2LT5wc3IudHJhbnNjb2Rlcik7DQo+ID4gKwkJaW1yX3JlZyA9IFRSQU5TX1BT
Ul9JTVIoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4gPiAgCX0gZWxzZSB7DQo+ID4gLQkJ
dHJhbnNfc2hpZnQgPSBkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXI7DQo+ID4gKwkJdHJhbnNfc2hp
ZnQgPSBpbnRlbF9kcC0+cHNyLnRyYW5zY29kZXI7DQo+ID4gIAkJaW1yX3JlZyA9IEVEUF9QU1Jf
SU1SOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiAgCW1hc2sgPSBFRFBfUFNSX0VSUk9SKHRyYW5zX3No
aWZ0KTsNCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfSVJR
KQ0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IuZGVidWcgJiBJOTE1X1BTUl9ERUJVR19JUlEpDQo+
ID4gIAkJbWFzayB8PSBFRFBfUFNSX1BPU1RfRVhJVCh0cmFuc19zaGlmdCkgfA0KPiA+ICAJCQlF
RFBfUFNSX1BSRV9FTlRSWSh0cmFuc19zaGlmdCk7DQo+ID4gIA0KPiA+IEBAIC0xNzEsMzggKzE3
NCwzNyBAQCBzdGF0aWMgdm9pZCBwc3JfZXZlbnRfcHJpbnQoc3RydWN0DQo+ID4gZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwNCj4gPiAgCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLCAiXHRQU1IgZGlz
YWJsZWRcbiIpOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC12b2lkIGludGVsX3Bzcl9pcnFfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMg0KPiA+IHBzcl9paXIpDQo+
ID4gK3ZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAs
IHUzMiBwc3JfaWlyKQ0KPiA+ICB7DQo+ID4gLQllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29k
ZXIgPSBkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXI7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsNCj4gPiArCWVudW0gdHJhbnNj
b2RlciBjcHVfdHJhbnNjb2RlciA9IGludGVsX2RwLT5wc3IudHJhbnNjb2RlcjsNCj4gPiAgCWVu
dW0gdHJhbnNjb2RlciB0cmFuc19zaGlmdDsNCj4gPiAgCWk5MTVfcmVnX3QgaW1yX3JlZzsNCj4g
PiAgCWt0aW1lX3QgdGltZV9ucyA9ICBrdGltZV9nZXQoKTsNCj4gPiAgDQo+ID4gIAlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMikgew0KPiA+ICAJCXRyYW5zX3NoaWZ0ID0gMDsNCj4gPiAt
CQlpbXJfcmVnID0gVFJBTlNfUFNSX0lNUihkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpOw0KPiA+
ICsJCWltcl9yZWcgPSBUUkFOU19QU1JfSU1SKGludGVsX2RwLT5wc3IudHJhbnNjb2Rlcik7DQo+
ID4gIAl9IGVsc2Ugew0KPiA+IC0JCXRyYW5zX3NoaWZ0ID0gZGV2X3ByaXYtPnBzci50cmFuc2Nv
ZGVyOw0KPiA+ICsJCXRyYW5zX3NoaWZ0ID0gaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyOw0KPiA+
ICAJCWltcl9yZWcgPSBFRFBfUFNSX0lNUjsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gIAlpZiAocHNy
X2lpciAmIEVEUF9QU1JfUFJFX0VOVFJZKHRyYW5zX3NoaWZ0KSkgew0KPiA+IC0JCWRldl9wcml2
LT5wc3IubGFzdF9lbnRyeV9hdHRlbXB0ID0gdGltZV9uczsNCj4gPiAtCQlkcm1fZGJnX2ttcygm
ZGV2X3ByaXYtPmRybSwNCj4gPiAtCQkJICAgICJbdHJhbnNjb2RlciAlc10gUFNSIGVudHJ5IGF0
dGVtcHQgaW4gMg0KPiA+IHZibGFua3NcbiIsDQo+ID4gLQkJCSAgICB0cmFuc2NvZGVyX25hbWUo
Y3B1X3RyYW5zY29kZXIpKTsNCj4gPiArCQlpbnRlbF9kcC0+cHNyLmxhc3RfZW50cnlfYXR0ZW1w
dCA9IHRpbWVfbnM7DQo+ID4gKwkJRFJNX0RFQlVHX0tNUygiW3RyYW5zY29kZXIgJXNdIFBTUiBl
bnRyeSBhdHRlbXB0IGluIDINCj4gPiB2YmxhbmtzXG4iLA0KPiA+ICsJCQkgICAgICB0cmFuc2Nv
ZGVyX25hbWUoY3B1X3RyYW5zY29kZXIpKTsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gIAlpZiAocHNy
X2lpciAmIEVEUF9QU1JfUE9TVF9FWElUKHRyYW5zX3NoaWZ0KSkgew0KPiA+IC0JCWRldl9wcml2
LT5wc3IubGFzdF9leGl0ID0gdGltZV9uczsNCj4gPiAtCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYt
PmRybSwNCj4gPiAtCQkJICAgICJbdHJhbnNjb2RlciAlc10gUFNSIGV4aXQgY29tcGxldGVkXG4i
LA0KPiA+IC0JCQkgICAgdHJhbnNjb2Rlcl9uYW1lKGNwdV90cmFuc2NvZGVyKSk7DQo+ID4gKwkJ
aW50ZWxfZHAtPnBzci5sYXN0X2V4aXQgPSB0aW1lX25zOw0KPiA+ICsJCURSTV9ERUJVR19LTVMo
Ilt0cmFuc2NvZGVyICVzXSBQU1IgZXhpdCBjb21wbGV0ZWRcbiIsDQo+ID4gKwkJCSAgICAgIHRy
YW5zY29kZXJfbmFtZShjcHVfdHJhbnNjb2RlcikpOw0KPiA+ICANCj4gPiAgCQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA5KSB7DQo+ID4gIAkJCXUzMiB2YWwgPSBpbnRlbF9kZV9yZWFkKGRl
dl9wcml2LA0KPiA+ICAJCQkJCQlQU1JfRVZFTlQoY3B1X3RyYW5zY29kZQ0KPiA+IHIpKTsNCj4g
PiAtCQkJYm9vbCBwc3IyX2VuYWJsZWQgPSBkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZDsNCj4g
PiArCQkJYm9vbCBwc3IyX2VuYWJsZWQgPSBpbnRlbF9kcC0+cHNyLnBzcjJfZW5hYmxlZDsNCj4g
PiAgDQo+ID4gIAkJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LA0KPiA+IFBTUl9FVkVOVChjcHVf
dHJhbnNjb2RlciksDQo+ID4gIAkJCQkgICAgICAgdmFsKTsNCj4gPiBAQCAtMjEzLDEwICsyMTUs
MTAgQEAgdm9pZCBpbnRlbF9wc3JfaXJxX2hhbmRsZXIoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIHUzMiBwc3JfaWlyKQ0KPiA+ICAJaWYgKHBzcl9paXIgJiBFRFBfUFNS
X0VSUk9SKHRyYW5zX3NoaWZ0KSkgew0KPiA+ICAJCXUzMiB2YWw7DQo+ID4gIA0KPiA+IC0JCWRy
bV93YXJuKCZkZXZfcHJpdi0+ZHJtLCAiW3RyYW5zY29kZXIgJXNdIFBTUiBhdXgNCj4gPiBlcnJv
clxuIiwNCj4gPiArCQlEUk1fV0FSTigiW3RyYW5zY29kZXIgJXNdIFBTUiBhdXggZXJyb3JcbiIs
DQo+ID4gIAkJCSB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIpKTsNCj4gPiAgDQo+ID4g
LQkJZGV2X3ByaXYtPnBzci5pcnFfYXV4X2Vycm9yID0gdHJ1ZTsNCj4gPiArCQlpbnRlbF9kcC0+
cHNyLmlycV9hdXhfZXJyb3IgPSB0cnVlOw0KPiA+ICANCj4gPiAgCQkvKg0KPiA+ICAJCSAqIElm
IHRoaXMgaW50ZXJydXB0aW9uIGlzIG5vdCBtYXNrZWQgaXQgd2lsbCBrZWVwDQo+ID4gQEAgLTIz
MCw3ICsyMzIsNyBAQCB2b2lkIGludGVsX3Bzcl9pcnFfaGFuZGxlcihzdHJ1Y3QNCj4gPiBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHBzcl9paXIpDQo+ID4gIAkJdmFsIHw9IEVEUF9Q
U1JfRVJST1IodHJhbnNfc2hpZnQpOw0KPiA+ICAJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBp
bXJfcmVnLCB2YWwpOw0KPiA+ICANCj4gPiAtCQlzY2hlZHVsZV93b3JrKCZkZXZfcHJpdi0+cHNy
LndvcmspOw0KPiA+ICsJCXNjaGVkdWxlX3dvcmsoJmludGVsX2RwLT5wc3Iud29yayk7DQo+ID4g
IAl9DQo+ID4gIH0NCj4gPiAgDQo+ID4gQEAgLTI5MSwxMiArMjkzLDYgQEAgdm9pZCBpbnRlbF9w
c3JfaW5pdF9kcGNkKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9DQo+ID4gIAkJdG9faTkxNShkcF90b19kaWdf
cG9ydChpbnRlbF9kcCktPmJhc2UuYmFzZS5kZXYpOw0KPiA+ICANCj4gPiAtCWlmIChkZXZfcHJp
di0+cHNyLmRwKSB7DQo+ID4gLQkJZHJtX3dhcm4oJmRldl9wcml2LT5kcm0sDQo+ID4gLQkJCSAi
TW9yZSB0aGFuIG9uZSBlRFAgcGFuZWwgZm91bmQsIFBTUiBzdXBwb3J0DQo+ID4gc2hvdWxkIGJl
IGV4dGVuZGVkXG4iKTsNCj4gPiAtCQlyZXR1cm47DQo+ID4gLQl9DQo+ID4gLQ0KPiA+ICAJZHJt
X2RwX2RwY2RfcmVhZCgmaW50ZWxfZHAtPmF1eCwgRFBfUFNSX1NVUFBPUlQsIGludGVsX2RwLQ0K
PiA+ID5wc3JfZHBjZCwNCj4gPiAgCQkJIHNpemVvZihpbnRlbF9kcC0+cHNyX2RwY2QpKTsNCj4g
PiAgDQo+ID4gQEAgLTMxNywxMiArMzEzLDEwIEBAIHZvaWQgaW50ZWxfcHNyX2luaXRfZHBjZChz
dHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICAJfQ0K
PiA+ICANCj4gPiAtCWRldl9wcml2LT5wc3Iuc2lua19zdXBwb3J0ID0gdHJ1ZTsNCj4gPiAtCWRl
dl9wcml2LT5wc3Iuc2lua19zeW5jX2xhdGVuY3kgPQ0KPiA+ICsJaW50ZWxfZHAtPnBzci5zaW5r
X3N1cHBvcnQgPSB0cnVlOw0KPiA+ICsJaW50ZWxfZHAtPnBzci5zaW5rX3N5bmNfbGF0ZW5jeSA9
DQo+ID4gIAkJaW50ZWxfZHBfZ2V0X3Npbmtfc3luY19sYXRlbmN5KGludGVsX2RwKTsNCj4gPiAg
DQo+ID4gLQlkZXZfcHJpdi0+cHNyLmRwID0gaW50ZWxfZHA7DQo+ID4gLQ0KPiA+ICAJaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gOSAmJg0KPiA+ICAJICAgIChpbnRlbF9kcC0+cHNyX2RwY2Rb
MF0gPT0NCj4gPiBEUF9QU1IyX1dJVEhfWV9DT09SRF9JU19TVVBQT1JURUQpKSB7DQo+ID4gIAkJ
Ym9vbCB5X3JlcSA9IGludGVsX2RwLT5wc3JfZHBjZFsxXSAmDQo+ID4gQEAgLTM0MCwxNCArMzM0
LDE0IEBAIHZvaWQgaW50ZWxfcHNyX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50
ZWxfZHApDQo+ID4gIAkJICogWS1jb29yZGluYXRlIHJlcXVpcmVtZW50IHBhbmVscyB3ZSB3b3Vs
ZCBuZWVkIHRvDQo+ID4gZW5hYmxlDQo+ID4gIAkJICogR1RDIGZpcnN0Lg0KPiA+ICAJCSAqLw0K
PiA+IC0JCWRldl9wcml2LT5wc3Iuc2lua19wc3IyX3N1cHBvcnQgPSB5X3JlcSAmJiBhbHBtOw0K
PiA+ICsJCWludGVsX2RwLT5wc3Iuc2lua19wc3IyX3N1cHBvcnQgPSB5X3JlcSAmJiBhbHBtOw0K
PiA+ICAJCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLCAiUFNSMiAlc3N1cHBvcnRlZFxuIiwN
Cj4gPiAtCQkJICAgIGRldl9wcml2LT5wc3Iuc2lua19wc3IyX3N1cHBvcnQgPyAiIiA6ICJub3QN
Cj4gPiAiKTsNCj4gPiArCQkJICAgIGludGVsX2RwLT5wc3Iuc2lua19wc3IyX3N1cHBvcnQgPyAi
IiA6ICJub3QNCj4gPiAiKTsNCj4gPiAgDQo+ID4gLQkJaWYgKGRldl9wcml2LT5wc3Iuc2lua19w
c3IyX3N1cHBvcnQpIHsNCj4gPiAtCQkJZGV2X3ByaXYtPnBzci5jb2xvcmltZXRyeV9zdXBwb3J0
ID0NCj4gPiArCQlpZiAoaW50ZWxfZHAtPnBzci5zaW5rX3BzcjJfc3VwcG9ydCkgew0KPiA+ICsJ
CQlpbnRlbF9kcC0+cHNyLmNvbG9yaW1ldHJ5X3N1cHBvcnQgPQ0KPiA+ICAJCQkJaW50ZWxfZHBf
Z2V0X2NvbG9yaW1ldHJ5X3N0YXR1cyhpbnRlbF9kDQo+ID4gcCk7DQo+ID4gLQkJCWRldl9wcml2
LT5wc3Iuc3VfeF9ncmFudWxhcml0eSA9DQo+ID4gKwkJCWludGVsX2RwLT5wc3Iuc3VfeF9ncmFu
dWxhcml0eSA9DQo+ID4gIAkJCQlpbnRlbF9kcF9nZXRfc3VfeF9ncmFudWxhcnRpeShpbnRlbF9k
cCkNCj4gPiA7DQo+ID4gIAkJfQ0KPiA+ICAJfQ0KPiA+IEBAIC0zNzMsNyArMzY3LDcgQEAgc3Rh
dGljIHZvaWQgaHN3X3Bzcl9zZXR1cF9hdXgoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2Rw
KQ0KPiA+ICAJQlVJTERfQlVHX09OKHNpemVvZihhdXhfbXNnKSA+IDIwKTsNCj4gPiAgCWZvciAo
aSA9IDA7IGkgPCBzaXplb2YoYXV4X21zZyk7IGkgKz0gNCkNCj4gPiAgCQlpbnRlbF9kZV93cml0
ZShkZXZfcHJpdiwNCj4gPiAtCQkJICAgICAgIEVEUF9QU1JfQVVYX0RBVEEoZGV2X3ByaXYtDQo+
ID4gPnBzci50cmFuc2NvZGVyLCBpID4+IDIpLA0KPiA+ICsJCQkgICAgICAgRURQX1BTUl9BVVhf
REFUQShpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIsIGkgPj4gMiksDQo+ID4gIAkJCSAg
ICAgICBpbnRlbF9kcF9wYWNrX2F1eCgmYXV4X21zZ1tpXSwNCj4gPiBzaXplb2YoYXV4X21zZykg
LSBpKSk7DQo+ID4gIA0KPiA+ICAJYXV4X2Nsb2NrX2RpdmlkZXIgPSBpbnRlbF9kcC0+Z2V0X2F1
eF9jbG9ja19kaXZpZGVyKGludGVsX2RwLA0KPiA+IDApOw0KPiA+IEBAIC0zODQsNyArMzc4LDcg
QEAgc3RhdGljIHZvaWQgaHN3X3Bzcl9zZXR1cF9hdXgoc3RydWN0IGludGVsX2RwDQo+ID4gKmlu
dGVsX2RwKQ0KPiA+ICANCj4gPiAgCS8qIFNlbGVjdCBvbmx5IHZhbGlkIGJpdHMgZm9yIFNSRF9B
VVhfQ1RMICovDQo+ID4gIAlhdXhfY3RsICY9IHBzcl9hdXhfbWFzazsNCj4gPiAtCWludGVsX2Rl
X3dyaXRlKGRldl9wcml2LCBFRFBfUFNSX0FVWF9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFu
c2NvZGVyKSwNCj4gPiArCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNSX0FVWF9DVEwo
aW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwNCj4gPiAgCQkgICAgICAgYXV4X2N0bCk7
DQo+ID4gIH0NCj4gPiAgDQo+ID4gQEAgLTM5NCwxNCArMzg4LDE0IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX3Bzcl9lbmFibGVfc2luayhzdHJ1Y3QNCj4gPiBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4g
IAl1OCBkcGNkX3ZhbCA9IERQX1BTUl9FTkFCTEU7DQo+ID4gIA0KPiA+ICAJLyogRW5hYmxlIEFM
UE0gYXQgc2luayBmb3IgcHNyMiAqLw0KPiA+IC0JaWYgKGRldl9wcml2LT5wc3IucHNyMl9lbmFi
bGVkKSB7DQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJsZWQpIHsNCj4gPiAgCQlk
cm1fZHBfZHBjZF93cml0ZWIoJmludGVsX2RwLT5hdXgsDQo+ID4gRFBfUkVDRUlWRVJfQUxQTV9D
T05GSUcsDQo+ID4gIAkJCQkgICBEUF9BTFBNX0VOQUJMRSB8DQo+ID4gIAkJCQkgICBEUF9BTFBN
X0xPQ0tfRVJST1JfSVJRX0hQRF9FTkFCTEUpOw0KPiA+ICANCj4gPiAgCQlkcGNkX3ZhbCB8PSBE
UF9QU1JfRU5BQkxFX1BTUjIgfA0KPiA+IERQX1BTUl9JUlFfSFBEX1dJVEhfQ1JDX0VSUk9SUzsN
Cj4gPiAgCX0gZWxzZSB7DQo+ID4gLQkJaWYgKGRldl9wcml2LT5wc3IubGlua19zdGFuZGJ5KQ0K
PiA+ICsJCWlmIChpbnRlbF9kcC0+cHNyLmxpbmtfc3RhbmRieSkNCj4gPiAgCQkJZHBjZF92YWwg
fD0gRFBfUFNSX01BSU5fTElOS19BQ1RJVkU7DQo+ID4gIA0KPiA+ICAJCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDgpDQo+ID4gQEAgLTQ2NCw3ICs0NTgsNyBAQCBzdGF0aWMgdTggcHNyX2Nv
bXB1dGVfaWRsZV9mcmFtZXMoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwKQ0KPiA+ICAJ
ICogb2ZmLWJ5LW9uZSBpc3N1ZSB0aGF0IEhXIGhhcyBpbiBzb21lIGNhc2VzLg0KPiA+ICAJICov
DQo+ID4gIAlpZGxlX2ZyYW1lcyA9IG1heCg2LCBkZXZfcHJpdi0+dmJ0LnBzci5pZGxlX2ZyYW1l
cyk7DQo+ID4gLQlpZGxlX2ZyYW1lcyA9IG1heChpZGxlX2ZyYW1lcywgZGV2X3ByaXYtPnBzci5z
aW5rX3N5bmNfbGF0ZW5jeQ0KPiA+ICsgMSk7DQo+ID4gKwlpZGxlX2ZyYW1lcyA9IG1heChpZGxl
X2ZyYW1lcywgaW50ZWxfZHAtPnBzci5zaW5rX3N5bmNfbGF0ZW5jeQ0KPiA+ICsgMSk7DQo+ID4g
IA0KPiA+ICAJaWYgKGRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCBpZGxlX2ZyYW1lcyA+IDB4
ZikpDQo+ID4gIAkJaWRsZV9mcmFtZXMgPSAweGY7DQo+ID4gQEAgLTQ4NCw3ICs0NzgsNyBAQCBz
dGF0aWMgdm9pZCBoc3dfYWN0aXZhdGVfcHNyMShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxf
ZHApDQo+ID4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpDQo+ID4gIAkJdmFsIHw9IEVEUF9Q
U1JfTUlOX0xJTktfRU5UUllfVElNRV84X0xJTkVTOw0KPiA+ICANCj4gPiAtCWlmIChkZXZfcHJp
di0+cHNyLmxpbmtfc3RhbmRieSkNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNyLmxpbmtfc3RhbmRi
eSkNCj4gPiAgCQl2YWwgfD0gRURQX1BTUl9MSU5LX1NUQU5EQlk7DQo+ID4gIA0KPiA+ICAJdmFs
IHw9IGludGVsX3BzcjFfZ2V0X3RwX3RpbWUoaW50ZWxfZHApOw0KPiA+IEBAIC00OTIsOSArNDg2
LDkgQEAgc3RhdGljIHZvaWQgaHN3X2FjdGl2YXRlX3BzcjEoc3RydWN0IGludGVsX2RwDQo+ID4g
KmludGVsX2RwKQ0KPiA+ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkNCj4gPiAgCQl2
YWwgfD0gRURQX1BTUl9DUkNfRU5BQkxFOw0KPiA+ICANCj4gPiAtCXZhbCB8PSAoaW50ZWxfZGVf
cmVhZChkZXZfcHJpdiwgRURQX1BTUl9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVy
KSkgJg0KPiA+ICsJdmFsIHw9IChpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBFRFBfUFNSX0NUTChp
bnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKSAmDQo+ID4gIAkJRURQX1BTUl9SRVNUT1JF
X1BTUl9BQ1RJVkVfQ1RYX01BU0spOw0KPiA+IC0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIEVE
UF9QU1JfQ1RMKGRldl9wcml2LT5wc3IudHJhbnNjb2RlciksIA0KPiA+IHZhbCk7DQo+ID4gKwlp
bnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRURQX1BTUl9DVEwoaW50ZWxfZHAtPnBzci50cmFuc2Nv
ZGVyKSwgDQo+ID4gdmFsKTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAgc3RhdGljIHUzMiBpbnRlbF9w
c3IyX2dldF90cF90aW1lKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gQEAgLTUyOSw3
ICs1MjMsNyBAQCBzdGF0aWMgdm9pZCBoc3dfYWN0aXZhdGVfcHNyMihzdHJ1Y3QgaW50ZWxfZHAN
Cj4gPiAqaW50ZWxfZHApDQo+ID4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJ
U19HRU1JTklMQUtFKGRldl9wcml2KSkNCj4gPiAgCQl2YWwgfD0gRURQX1lfQ09PUkRJTkFURV9F
TkFCTEU7DQo+ID4gIA0KPiA+IC0JdmFsIHw9IEVEUF9QU1IyX0ZSQU1FX0JFRk9SRV9TVShkZXZf
cHJpdi0+cHNyLnNpbmtfc3luY19sYXRlbmN5IA0KPiA+ICsgMSk7DQo+ID4gKwl2YWwgfD0gRURQ
X1BTUjJfRlJBTUVfQkVGT1JFX1NVKGludGVsX2RwLT5wc3Iuc2lua19zeW5jX2xhdGVuY3kgDQo+
ID4gKyAxKTsNCj4gPiAgCXZhbCB8PSBpbnRlbF9wc3IyX2dldF90cF90aW1lKGludGVsX2RwKTsN
Cj4gPiAgDQo+ID4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMikgew0KPiA+IEBAIC01
NDgsNyArNTQyLDcgQEAgc3RhdGljIHZvaWQgaHN3X2FjdGl2YXRlX3BzcjIoc3RydWN0IGludGVs
X2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICAJCXZhbCB8PSBFRFBfUFNSMl9GQVNUX1dBS0UoNyk7
DQo+ID4gIAl9DQo+ID4gIA0KPiA+IC0JaWYgKGRldl9wcml2LT5wc3IucHNyMl9zZWxfZmV0Y2hf
ZW5hYmxlZCkgew0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3IucHNyMl9zZWxfZmV0Y2hfZW5hYmxl
ZCkgew0KPiA+ICAJCS8qIFdBIDE0MDgzMzA4NDcgKi8NCj4gPiAgCQlpZiAoSVNfVEdMX0RJU1Bf
UkVWSUQoZGV2X3ByaXYsIFRHTF9SRVZJRF9BMCwNCj4gPiBUR0xfUkVWSURfQTApIHx8DQo+ID4g
IAkJICAgIElTX1JLTF9SRVZJRChkZXZfcHJpdiwgUktMX1JFVklEX0EwLCBSS0xfUkVWSURfQTAp
KQ0KPiA+IEBAIC01NTcsMjAgKzU1MSwyMCBAQCBzdGF0aWMgdm9pZCBoc3dfYWN0aXZhdGVfcHNy
MihzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIAkJCQkgICAgIERJU19SQU1f
QllQQVNTX1BTUjJfTUFOX1RSQUNLKTsNCj4gPiAgDQo+ID4gIAkJaW50ZWxfZGVfd3JpdGUoZGV2
X3ByaXYsDQo+ID4gLQkJCSAgICAgICBQU1IyX01BTl9UUktfQ1RMKGRldl9wcml2LQ0KPiA+ID5w
c3IudHJhbnNjb2RlciksDQo+ID4gKwkJCSAgICAgICBQU1IyX01BTl9UUktfQ1RMKGludGVsX2Rw
LQ0KPiA+ID5wc3IudHJhbnNjb2RlciksDQo+ID4gIAkJCSAgICAgICBQU1IyX01BTl9UUktfQ1RM
X0VOQUJMRSk7DQo+ID4gIAl9IGVsc2UgaWYgKEhBU19QU1IyX1NFTF9GRVRDSChkZXZfcHJpdikp
IHsNCj4gPiAgCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwNCj4gPiAtCQkJICAgICAgIFBTUjJf
TUFOX1RSS19DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwgMCk7DQo+ID4gKwkJ
CSAgICAgICBQU1IyX01BTl9UUktfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2Rlciks
IDApOw0KPiA+ICAJfQ0KPiA+ICANCj4gPiAgCS8qDQo+ID4gIAkgKiBQU1IyIEhXIGlzIGluY29y
cmVjdGx5IHVzaW5nIEVEUF9QU1JfVFAxX1RQM19TRUwgYW5kIEJTcGVjDQo+ID4gaXMNCj4gPiAg
CSAqIHJlY29tbWVuZGluZyBrZWVwIHRoaXMgYml0IHVuc2V0IHdoaWxlIFBTUjIgaXMgZW5hYmxl
ZC4NCj4gPiAgCSAqLw0KPiA+IC0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIEVEUF9QU1JfQ1RM
KGRldl9wcml2LT5wc3IudHJhbnNjb2RlciksIA0KPiA+IDApOw0KPiA+ICsJaW50ZWxfZGVfd3Jp
dGUoZGV2X3ByaXYsIEVEUF9QU1JfQ1RMKGludGVsX2RwLT5wc3IudHJhbnNjb2RlciksIA0KPiA+
IDApOw0KPiA+ICANCj4gPiAtCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBFRFBfUFNSMl9DVEwo
ZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwgdmFsKTsNCj4gPiArCWludGVsX2RlX3dy
aXRlKGRldl9wcml2LCBFRFBfUFNSMl9DVEwoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVy
KSwgdmFsKTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAgc3RhdGljIGJvb2wNCj4gPiBAQCAtNTkzLDU1
ICs1ODcsNTggQEAgc3RhdGljIHUzMiBpbnRlbF9nZXRfZnJhbWVfdGltZV91cyhjb25zdA0KPiA+
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpDQo+ID4gIAkJCSAgICBkcm1fbW9kZV92
cmVmcmVzaCgmY3N0YXRlLQ0KPiA+ID5ody5hZGp1c3RlZF9tb2RlKSk7DQo+ID4gIH0NCj4gPiAg
DQo+ID4gLXN0YXRpYyB2b2lkIHBzcjJfcHJvZ3JhbV9pZGxlX2ZyYW1lcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdiwNCj4gPiArc3RhdGljIHZvaWQgcHNyMl9wcm9ncmFt
X2lkbGVfZnJhbWVzKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gIAkJCQkgICAgIHUz
MiBpZGxlX2ZyYW1lcykNCj4gPiAgew0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gIAl1MzIgdmFsOw0KPiA+ICANCj4g
PiAgCWlkbGVfZnJhbWVzIDw8PSAgRURQX1BTUjJfSURMRV9GUkFNRV9TSElGVDsNCj4gPiAtCXZh
bCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIEVEUF9QU1IyX0NUTChkZXZfcHJpdi0NCj4gPiA+
cHNyLnRyYW5zY29kZXIpKTsNCj4gPiArCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIEVE
UF9QU1IyX0NUTChpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiAgCXZhbCAm
PSB+RURQX1BTUjJfSURMRV9GUkFNRV9NQVNLOw0KPiA+ICAJdmFsIHw9IGlkbGVfZnJhbWVzOw0K
PiA+IC0JaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIEVEUF9QU1IyX0NUTChkZXZfcHJpdi0NCj4g
PiA+cHNyLnRyYW5zY29kZXIpLCB2YWwpOw0KPiA+ICsJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYs
IEVEUF9QU1IyX0NUTChpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpLCB2YWwpOw0KPiA+
ICB9DQo+ID4gIA0KPiA+IC1zdGF0aWMgdm9pZCB0Z2xfcHNyMl9lbmFibGVfZGMzY28oc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUNCj4gPiAqZGV2X3ByaXYpDQo+ID4gK3N0YXRpYyB2b2lkIHRnbF9w
c3IyX2VuYWJsZV9kYzNjbyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQ0KPiA+ICB7DQo+ID4g
LQlwc3IyX3Byb2dyYW1faWRsZV9mcmFtZXMoZGV2X3ByaXYsIDApOw0KPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gKw0K
PiA+ICsJcHNyMl9wcm9ncmFtX2lkbGVfZnJhbWVzKGludGVsX2RwLCAwKTsNCj4gPiAgCWludGVs
X2Rpc3BsYXlfcG93ZXJfc2V0X3RhcmdldF9kY19zdGF0ZShkZXZfcHJpdiwNCj4gPiBEQ19TVEFU
RV9FTl9EQzNDTyk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gLXN0YXRpYyB2b2lkIHRnbF9wc3IyX2Rp
c2FibGVfZGMzY28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUNCj4gPiAqZGV2X3ByaXYpDQo+ID4g
K3N0YXRpYyB2b2lkIHRnbF9wc3IyX2Rpc2FibGVfZGMzY28oc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkNCj4gPiAgew0KPiA+IC0Jc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGRldl9wcml2
LT5wc3IuZHA7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90
b19pOTE1KGludGVsX2RwKTsNCj4gPiAgDQo+ID4gIAlpbnRlbF9kaXNwbGF5X3Bvd2VyX3NldF90
YXJnZXRfZGNfc3RhdGUoZGV2X3ByaXYsDQo+ID4gRENfU1RBVEVfRU5fVVBUT19EQzYpOw0KPiA+
IC0JcHNyMl9wcm9ncmFtX2lkbGVfZnJhbWVzKGRldl9wcml2LA0KPiA+IHBzcl9jb21wdXRlX2lk
bGVfZnJhbWVzKGludGVsX2RwKSk7DQo+ID4gKwlwc3IyX3Byb2dyYW1faWRsZV9mcmFtZXMoaW50
ZWxfZHAsDQo+ID4gcHNyX2NvbXB1dGVfaWRsZV9mcmFtZXMoaW50ZWxfZHApKTsNCj4gPiAgfQ0K
PiA+ICANCj4gPiAgc3RhdGljIHZvaWQgdGdsX2RjM2NvX2Rpc2FibGVfd29yayhzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspDQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9DQo+ID4gLQkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZGV2X3ByaXYpLA0K
PiA+IHBzci5kYzNjb193b3JrLndvcmspOw0KPiA+ICsJc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCA9DQo+ID4gKwkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqaW50ZWxfZHApLA0KPiA+IHBz
ci5kYzNjb193b3JrLndvcmspOw0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5w
c3IubG9jayk7DQo+ID4gKwltdXRleF9sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICAJ
LyogSWYgZGVsYXllZCB3b3JrIGlzIHBlbmRpbmcsIGl0IGlzIG5vdCBpZGxlICovDQo+ID4gLQlp
ZiAoZGVsYXllZF93b3JrX3BlbmRpbmcoJmRldl9wcml2LT5wc3IuZGMzY29fd29yaykpDQo+ID4g
KwlpZiAoZGVsYXllZF93b3JrX3BlbmRpbmcoJmludGVsX2RwLT5wc3IuZGMzY29fd29yaykpDQo+
ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gIA0KPiA+IC0JdGdsX3BzcjJfZGlzYWJsZV9kYzNjbyhk
ZXZfcHJpdik7DQo+ID4gKwl0Z2xfcHNyMl9kaXNhYmxlX2RjM2NvKGludGVsX2RwKTsNCj4gPiAg
dW5sb2NrOg0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJ
bXV0ZXhfdW5sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC1z
dGF0aWMgdm9pZCB0Z2xfZGlzYWxsb3dfZGMzY29fb25fcHNyMl9leGl0KHN0cnVjdA0KPiA+IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICtzdGF0aWMgdm9pZCB0Z2xfZGlzYWxsb3df
ZGMzY29fb25fcHNyMl9leGl0KHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCkNCj4gPiAg
ew0KPiA+IC0JaWYgKCFkZXZfcHJpdi0+cHNyLmRjM2NvX2VuYWJsZWQpDQo+ID4gKwlpZiAoIWlu
dGVsX2RwLT5wc3IuZGMzY29fZW5hYmxlZCkNCj4gPiAgCQlyZXR1cm47DQo+ID4gIA0KPiA+IC0J
Y2FuY2VsX2RlbGF5ZWRfd29yaygmZGV2X3ByaXYtPnBzci5kYzNjb193b3JrKTsNCj4gPiArCWNh
bmNlbF9kZWxheWVkX3dvcmsoJmludGVsX2RwLT5wc3IuZGMzY29fd29yayk7DQo+ID4gIAkvKiBC
ZWZvcmUgUFNSMiBleGl0IGRpc2FsbG93IGRjM2NvKi8NCj4gPiAtCXRnbF9wc3IyX2Rpc2FibGVf
ZGMzY28oZGV2X3ByaXYpOw0KPiA+ICsJdGdsX3BzcjJfZGlzYWJsZV9kYzNjbyhpbnRlbF9kcCk7
DQo+ID4gIH0NCj4gPiAgDQo+ID4gIHN0YXRpYyB2b2lkDQo+ID4gQEAgLTcxNCw3ICs3MTEsNyBA
QCBzdGF0aWMgYm9vbCBpbnRlbF9wc3IyX2NvbmZpZ192YWxpZChzdHJ1Y3QNCj4gPiBpbnRlbF9k
cCAqaW50ZWxfZHAsDQo+ID4gIAlpbnQgY3J0Y192ZGlzcGxheSA9IGNydGNfc3RhdGUtPmh3LmFk
anVzdGVkX21vZGUuY3J0Y192ZGlzcGxheTsNCj4gPiAgCWludCBwc3JfbWF4X2ggPSAwLCBwc3Jf
bWF4X3YgPSAwLCBtYXhfYnBwID0gMDsNCj4gPiAgDQo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3Iu
c2lua19wc3IyX3N1cHBvcnQpDQo+ID4gKwlpZiAoIWludGVsX2RwLT5wc3Iuc2lua19wc3IyX3N1
cHBvcnQpDQo+ID4gIAkJcmV0dXJuIGZhbHNlOw0KPiA+ICANCj4gPiAgCWlmICghdHJhbnNjb2Rl
cl9oYXNfcHNyMihkZXZfcHJpdiwgY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXIpKSANCj4gPiB7
DQo+ID4gQEAgLTcyNCw3ICs3MjEsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9wc3IyX2NvbmZpZ192
YWxpZChzdHJ1Y3QNCj4gPiBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gIAkJcmV0dXJuIGZhbHNl
Ow0KPiA+ICAJfQ0KPiA+ICANCj4gPiAtCWlmICghcHNyMl9nbG9iYWxfZW5hYmxlZChkZXZfcHJp
dikpIHsNCj4gPiArCWlmICghcHNyMl9nbG9iYWxfZW5hYmxlZChpbnRlbF9kcCkpIHsNCj4gPiAg
CQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwgIlBTUjIgZGlzYWJsZWQgYnkgZmxhZ1xuIik7
DQo+ID4gIAkJcmV0dXJuIGZhbHNlOw0KPiA+ICAJfQ0KPiA+IEBAIC03NzMsMTAgKzc3MCwxMCBA
QCBzdGF0aWMgYm9vbCBpbnRlbF9wc3IyX2NvbmZpZ192YWxpZChzdHJ1Y3QNCj4gPiBpbnRlbF9k
cCAqaW50ZWxfZHAsDQo+ID4gIAkgKiBvbmx5IG5lZWQgdG8gdmFsaWRhdGUgdGhlIFNVIGJsb2Nr
IHdpZHRoIGlzIGEgbXVsdGlwbGUgb2YNCj4gPiAgCSAqIHggZ3JhbnVsYXJpdHkuDQo+ID4gIAkg
Ki8NCj4gPiAtCWlmIChjcnRjX2hkaXNwbGF5ICUgZGV2X3ByaXYtPnBzci5zdV94X2dyYW51bGFy
aXR5KSB7DQo+ID4gKwlpZiAoY3J0Y19oZGlzcGxheSAlIGludGVsX2RwLT5wc3Iuc3VfeF9ncmFu
dWxhcml0eSkgew0KPiA+ICAJCWRybV9kYmdfa21zKCZkZXZfcHJpdi0+ZHJtLA0KPiA+ICAJCQkg
ICAgIlBTUjIgbm90IGVuYWJsZWQsIGhkaXNwbGF5KCVkKSBub3QNCj4gPiBtdWx0aXBsZSBvZiAl
ZFxuIiwNCj4gPiAtCQkJICAgIGNydGNfaGRpc3BsYXksIGRldl9wcml2LQ0KPiA+ID5wc3Iuc3Vf
eF9ncmFudWxhcml0eSk7DQo+ID4gKwkJCSAgICBjcnRjX2hkaXNwbGF5LCBpbnRlbF9kcC0NCj4g
PiA+cHNyLnN1X3hfZ3JhbnVsYXJpdHkpOw0KPiA+ICAJCXJldHVybiBmYWxzZTsNCj4gPiAgCX0N
Cj4gPiAgDQo+ID4gQEAgLTgxMSwxMyArODA4LDEwIEBAIHZvaWQgaW50ZWxfcHNyX2NvbXB1dGVf
Y29uZmlnKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiAgCQkmY3J0Y19zdGF0
ZS0+aHcuYWRqdXN0ZWRfbW9kZTsNCj4gPiAgCWludCBwc3Jfc2V0dXBfdGltZTsNCj4gPiAgDQo+
ID4gLQlpZiAoIUNBTl9QU1IoZGV2X3ByaXYpKQ0KPiA+IC0JCXJldHVybjsNCj4gPiAtDQo+ID4g
LQlpZiAoaW50ZWxfZHAgIT0gZGV2X3ByaXYtPnBzci5kcCkNCj4gPiArCWlmICghQ0FOX1BTUihp
bnRlbF9kcCkpDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAtCWlmICghcHNyX2dsb2JhbF9l
bmFibGVkKGRldl9wcml2KSkgew0KPiA+ICsJaWYgKCFwc3JfZ2xvYmFsX2VuYWJsZWQoaW50ZWxf
ZHApKSB7DQo+ID4gIAkJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5kcm0sICJQU1IgZGlzYWJsZWQg
YnkgZmxhZ1xuIik7DQo+ID4gIAkJcmV0dXJuOw0KPiA+ICAJfQ0KPiA+IEBAIC04MzQsNyArODI4
LDcgQEAgdm9pZCBpbnRlbF9wc3JfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2RwDQo+ID4g
KmludGVsX2RwLA0KPiA+ICAJCXJldHVybjsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gLQlpZiAoZGV2
X3ByaXYtPnBzci5zaW5rX25vdF9yZWxpYWJsZSkgew0KPiA+ICsJaWYgKGludGVsX2RwLT5wc3Iu
c2lua19ub3RfcmVsaWFibGUpIHsNCj4gPiAgCQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwN
Cj4gPiAgCQkJICAgICJQU1Igc2luayBpbXBsZW1lbnRhdGlvbiBpcyBub3QNCj4gPiByZWxpYWJs
ZVxuIik7DQo+ID4gIAkJcmV0dXJuOw0KPiA+IEBAIC04NzAsMjMgKzg2NCwyNCBAQCB2b2lkIGlu
dGVsX3Bzcl9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHAsDQo+
ID4gIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9hY3RpdmF0ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwKQ0KPiA+ICB7DQo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBk
cF90b19pOTE1KGludGVsX2RwKTsNCj4gPiArCWVudW0gdHJhbnNjb2RlciB0cmFuc2NvZGVyID0g
aW50ZWxfZHAtPnBzci50cmFuc2NvZGVyOw0KPiA+ICANCj4gPiAtCWlmICh0cmFuc2NvZGVyX2hh
c19wc3IyKGRldl9wcml2LCBkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpKQ0KPiA+ICsJaWYgKHRy
YW5zY29kZXJfaGFzX3BzcjIoZGV2X3ByaXYsIHRyYW5zY29kZXIpKQ0KPiA+ICAJCWRybV9XQVJO
X09OKCZkZXZfcHJpdi0+ZHJtLA0KPiA+IC0JCQkgICAgaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwN
Cj4gPiBFRFBfUFNSMl9DVEwoZGV2X3ByaXYtPnBzci50cmFuc2NvZGVyKSkgJiBFRFBfUFNSMl9F
TkFCTEUpOw0KPiA+ICsJCQkgICAgaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4gPiBFRFBfUFNS
Ml9DVEwodHJhbnNjb2RlcikpICYgRURQX1BTUjJfRU5BQkxFKTsNCj4gPiAgDQo+ID4gIAlkcm1f
V0FSTl9PTigmZGV2X3ByaXYtPmRybSwNCj4gPiAtCQkgICAgaW50ZWxfZGVfcmVhZChkZXZfcHJp
diwgRURQX1BTUl9DVEwoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSkgJiBFRFBfUFNS
X0VOQUJMRSk7DQo+ID4gLQlkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgZGV2X3ByaXYtPnBz
ci5hY3RpdmUpOw0KPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPnBzci5sb2Nr
KTsNCj4gPiArCQkgICAgaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgRURQX1BTUl9DVEwodHJhbnNj
b2RlcikpICYNCj4gPiBFRFBfUFNSX0VOQUJMRSk7DQo+ID4gKwlkcm1fV0FSTl9PTigmZGV2X3By
aXYtPmRybSwgaW50ZWxfZHAtPnBzci5hY3RpdmUpOw0KPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgDQo+ID4gIAkvKiBwc3IxIGFuZCBwc3IyIGFy
ZSBtdXR1YWxseSBleGNsdXNpdmUuKi8NCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5h
YmxlZCkNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNyLnBzcjJfZW5hYmxlZCkNCj4gPiAgCQloc3df
YWN0aXZhdGVfcHNyMihpbnRlbF9kcCk7DQo+ID4gIAllbHNlDQo+ID4gIAkJaHN3X2FjdGl2YXRl
X3BzcjEoaW50ZWxfZHApOw0KPiA+ICANCj4gPiAtCWRldl9wcml2LT5wc3IuYWN0aXZlID0gdHJ1
ZTsNCj4gPiArCWludGVsX2RwLT5wc3IuYWN0aXZlID0gdHJ1ZTsNCj4gPiAgfQ0KPiA+ICANCj4g
PiAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9zb3VyY2Uoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCwNCj4gPiBAQCAtOTAyLDcgKzg5Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9l
bmFibGVfc291cmNlKHN0cnVjdA0KPiA+IGludGVsX2RwICppbnRlbF9kcCwNCj4gPiAgCWlmIChJ
U19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQ0KPiA+ICAJCWhz
d19wc3Jfc2V0dXBfYXV4KGludGVsX2RwKTsNCj4gPiAgDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBz
ci5wc3IyX2VuYWJsZWQgJiYgKElTX0dFTihkZXZfcHJpdiwgOSkgJiYNCj4gPiArCWlmIChpbnRl
bF9kcC0+cHNyLnBzcjJfZW5hYmxlZCAmJiAoSVNfR0VOKGRldl9wcml2LCA5KSAmJg0KPiA+ICAJ
CQkJCSAgICFJU19HRU1JTklMQUtFKGRldl9wcml2KSkpIHsNCj4gPiAgCQlpOTE1X3JlZ190IHJl
ZyA9IENISUNLRU5fVFJBTlMoY3B1X3RyYW5zY29kZXIpOw0KPiA+ICAJCXUzMiBjaGlja2VuID0g
aW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgcmVnKTsNCj4gPiBAQCAtOTI2LDEwICs5MjEsMTAgQEAg
c3RhdGljIHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9zb3VyY2Uoc3RydWN0DQo+ID4gaW50ZWxfZHAg
KmludGVsX2RwLA0KPiA+ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkNCj4gPiAgCQlt
YXNrIHw9IEVEUF9QU1JfREVCVUdfTUFTS19ESVNQX1JFR19XUklURTsNCj4gPiAgDQo+ID4gLQlp
bnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRURQX1BTUl9ERUJVRyhkZXZfcHJpdi0NCj4gPiA+cHNy
LnRyYW5zY29kZXIpLA0KPiA+ICsJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIEVEUF9QU1JfREVC
VUcoaW50ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSwNCj4gPiAgCQkgICAgICAgbWFzayk7
DQo+ID4gIA0KPiA+IC0JcHNyX2lycV9jb250cm9sKGRldl9wcml2KTsNCj4gPiArCXBzcl9pcnFf
Y29udHJvbChpbnRlbF9kcCk7DQo+ID4gIA0KPiA+ICAJaWYgKGNydGNfc3RhdGUtPmRjM2NvX2V4
aXRsaW5lKSB7DQo+ID4gIAkJdTMyIHZhbDsNCj4gPiBAQCAtOTQ3LDMwICs5NDIsMzAgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9zb3VyY2Uoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmlu
dGVsX2RwLA0KPiA+ICANCj4gPiAgCWlmIChIQVNfUFNSX0hXX1RSQUNLSU5HKGRldl9wcml2KSAm
Jg0KPiA+IEhBU19QU1IyX1NFTF9GRVRDSChkZXZfcHJpdikpDQo+ID4gIAkJaW50ZWxfZGVfcm13
KGRldl9wcml2LCBDSElDS0VOX1BBUjFfMSwNCj4gPiBJR05PUkVfUFNSMl9IV19UUkFDS0lORywN
Cj4gPiAtCQkJICAgICBkZXZfcHJpdi0+cHNyLnBzcjJfc2VsX2ZldGNoX2VuYWJsZWQgPw0KPiA+
ICsJCQkgICAgIGludGVsX2RwLT5wc3IucHNyMl9zZWxfZmV0Y2hfZW5hYmxlZCA/DQo+ID4gIAkJ
CSAgICAgSUdOT1JFX1BTUjJfSFdfVFJBQ0tJTkcgOiAwKTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAt
c3RhdGljIHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUNCj4gPiAqZGV2X3ByaXYsDQo+ID4gK3N0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfbG9j
a2VkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gIAkJCQkgICAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUNCj4gPiAqY3J0Y19zdGF0ZSwNCj4gPiAgCQkJCSAgICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZQ0KPiA+ICpjb25uX3N0YXRlKQ0KPiA+ICB7DQo+ID4g
LQlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZGV2X3ByaXYtPnBzci5kcDsNCj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0K
PiA+ICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9y
dChpbnRlbF9kcCk7DQo+ID4gIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciA9ICZkaWdf
cG9ydC0+YmFzZTsNCj4gPiAgCXUzMiB2YWw7DQo+ID4gIA0KPiA+IC0JZHJtX1dBUk5fT04oJmRl
dl9wcml2LT5kcm0sIGRldl9wcml2LT5wc3IuZW5hYmxlZCk7DQo+ID4gKwlkcm1fV0FSTl9PTigm
ZGV2X3ByaXYtPmRybSwgaW50ZWxfZHAtPnBzci5lbmFibGVkKTsNCj4gPiAgDQo+ID4gLQlkZXZf
cHJpdi0+cHNyLnBzcjJfZW5hYmxlZCA9IGNydGNfc3RhdGUtPmhhc19wc3IyOw0KPiA+IC0JZGV2
X3ByaXYtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgPSAwOw0KPiA+IC0JZGV2X3ByaXYtPnBz
ci5waXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpLQ0KPiA+ID5waXBl
Ow0KPiA+IC0JZGV2X3ByaXYtPnBzci5kYzNjb19lbmFibGVkID0gISFjcnRjX3N0YXRlLT5kYzNj
b19leGl0bGluZTsNCj4gPiAtCWRldl9wcml2LT5wc3IudHJhbnNjb2RlciA9IGNydGNfc3RhdGUt
PmNwdV90cmFuc2NvZGVyOw0KPiA+ICsJaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJsZWQgPSBjcnRj
X3N0YXRlLT5oYXNfcHNyMjsNCj4gPiArCWludGVsX2RwLT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9i
aXRzID0gMDsNCj4gPiArCWludGVsX2RwLT5wc3IucGlwZSA9IHRvX2ludGVsX2NydGMoY3J0Y19z
dGF0ZS0+dWFwaS5jcnRjKS0NCj4gPiA+cGlwZTsNCj4gPiArCWludGVsX2RwLT5wc3IuZGMzY29f
ZW5hYmxlZCA9ICEhY3J0Y19zdGF0ZS0+ZGMzY29fZXhpdGxpbmU7DQo+ID4gKwlpbnRlbF9kcC0+
cHNyLnRyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsNCj4gPiAgCS8qIERD
NS9EQzYgcmVxdWlyZXMgYXQgbGVhc3QgNiBpZGxlIGZyYW1lcyAqLw0KPiA+ICAJdmFsID0gdXNl
Y3NfdG9famlmZmllcyhpbnRlbF9nZXRfZnJhbWVfdGltZV91cyhjcnRjX3N0YXRlKSAqDQo+ID4g
Nik7DQo+ID4gLQlkZXZfcHJpdi0+cHNyLmRjM2NvX2V4aXRfZGVsYXkgPSB2YWw7DQo+ID4gLQlk
ZXZfcHJpdi0+cHNyLnBzcjJfc2VsX2ZldGNoX2VuYWJsZWQgPSBjcnRjX3N0YXRlLQ0KPiA+ID5l
bmFibGVfcHNyMl9zZWxfZmV0Y2g7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLmRjM2NvX2V4aXRfZGVs
YXkgPSB2YWw7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLnBzcjJfc2VsX2ZldGNoX2VuYWJsZWQgPSBj
cnRjX3N0YXRlLQ0KPiA+ID5lbmFibGVfcHNyMl9zZWxfZmV0Y2g7DQo+ID4gIA0KPiA+ICAJLyoN
Cj4gPiAgCSAqIElmIGEgUFNSIGVycm9yIGhhcHBlbmVkIGFuZCB0aGUgZHJpdmVyIGlzIHJlbG9h
ZGVkLCB0aGUNCj4gPiBFRFBfUFNSX0lJUg0KPiA+IEBAIC05ODIsMjcgKzk3NywyNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX2xvY2tlZChzdHJ1Y3QNCj4gPiBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwNCj4gPiAgCSAqLw0KPiA+ICAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gMTIpIHsNCj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+IC0JCQkJ
ICAgIFRSQU5TX1BTUl9JSVIoZGV2X3ByaXYtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4g
KwkJCQkgICAgVFJBTlNfUFNSX0lJUihpbnRlbF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsN
Cj4gPiAgCQl2YWwgJj0gRURQX1BTUl9FUlJPUigwKTsNCj4gPiAgCX0gZWxzZSB7DQo+ID4gIAkJ
dmFsID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgRURQX1BTUl9JSVIpOw0KPiA+IC0JCXZhbCAm
PSBFRFBfUFNSX0VSUk9SKGRldl9wcml2LT5wc3IudHJhbnNjb2Rlcik7DQo+ID4gKwkJdmFsICY9
IEVEUF9QU1JfRVJST1IoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4gPiAgCX0NCj4gPiAg
CWlmICh2YWwpIHsNCj4gPiAtCQlkZXZfcHJpdi0+cHNyLnNpbmtfbm90X3JlbGlhYmxlID0gdHJ1
ZTsNCj4gPiArCQlpbnRlbF9kcC0+cHNyLnNpbmtfbm90X3JlbGlhYmxlID0gdHJ1ZTsNCj4gPiAg
CQlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwNCj4gPiAgCQkJICAgICJQU1IgaW50ZXJydXB0
aW9uIGVycm9yIHNldCwgbm90IGVuYWJsaW5nDQo+ID4gUFNSXG4iKTsNCj4gPiAgCQlyZXR1cm47
DQo+ID4gIAl9DQo+ID4gIA0KPiA+ICAJZHJtX2RiZ19rbXMoJmRldl9wcml2LT5kcm0sICJFbmFi
bGluZyBQU1Ilc1xuIiwNCj4gPiAtCQkgICAgZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQgPyAi
MiIgOiAiMSIpOw0KPiA+ICsJCSAgICBpbnRlbF9kcC0+cHNyLnBzcjJfZW5hYmxlZCA/ICIyIiA6
ICIxIik7DQo+ID4gIAlpbnRlbF9kcF9jb21wdXRlX3Bzcl92c2Nfc2RwKGludGVsX2RwLCBjcnRj
X3N0YXRlLCBjb25uX3N0YXRlLA0KPiA+IC0JCQkJICAgICAmZGV2X3ByaXYtPnBzci52c2MpOw0K
PiA+IC0JaW50ZWxfd3JpdGVfZHBfdnNjX3NkcChlbmNvZGVyLCBjcnRjX3N0YXRlLCAmZGV2X3By
aXYtDQo+ID4gPnBzci52c2MpOw0KPiA+ICsJCQkJICAgICAmaW50ZWxfZHAtPnBzci52c2MpOw0K
PiA+ICsJaW50ZWxfd3JpdGVfZHBfdnNjX3NkcChlbmNvZGVyLCBjcnRjX3N0YXRlLCAmaW50ZWxf
ZHAtDQo+ID4gPnBzci52c2MpOw0KPiA+ICAJaW50ZWxfcHNyX2VuYWJsZV9zaW5rKGludGVsX2Rw
KTsNCj4gPiAgCWludGVsX3Bzcl9lbmFibGVfc291cmNlKGludGVsX2RwLCBjcnRjX3N0YXRlKTsN
Cj4gPiAtCWRldl9wcml2LT5wc3IuZW5hYmxlZCA9IHRydWU7DQo+ID4gKwlpbnRlbF9kcC0+cHNy
LmVuYWJsZWQgPSB0cnVlOw0KPiA+ICANCj4gPiAgCWludGVsX3Bzcl9hY3RpdmF0ZShpbnRlbF9k
cCk7DQo+ID4gIH0NCj4gPiBAQCAtMTAyMSw3ICsxMDE2LDcgQEAgdm9pZCBpbnRlbF9wc3JfZW5h
YmxlKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiAgew0KPiA+ICAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4g
IA0KPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSB8fCBkZXZfcHJpdi0+cHNyLmRwICE9IGlu
dGVsX2RwKQ0KPiA+ICsJaWYgKCFDQU5fUFNSKGludGVsX2RwKSkNCj4gPiAgCQlyZXR1cm47DQo+
ID4gIA0KPiA+ICAJaWYgKCFjcnRjX3N0YXRlLT5oYXNfcHNyKQ0KPiA+IEBAIC0xMDI5LDQ2ICsx
MDI0LDQ3IEBAIHZvaWQgaW50ZWxfcHNyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50
ZWxfZHAsDQo+ID4gIA0KPiA+ICAJZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sIGRldl9wcml2
LT5kcnJzLmRwKTsNCj4gPiAgDQo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2sp
Ow0KPiA+IC0JaW50ZWxfcHNyX2VuYWJsZV9sb2NrZWQoZGV2X3ByaXYsIGNydGNfc3RhdGUsIGNv
bm5fc3RhdGUpOw0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+
ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiArCWludGVsX3Bzcl9lbmFi
bGVfbG9ja2VkKGludGVsX2RwLCBjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsNCj4gPiArCW11dGV4
X3VubG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgfQ0KPiA+ICANCj4gPiAtc3RhdGlj
IHZvaWQgaW50ZWxfcHNyX2V4aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQ0K
PiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZXhpdChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
KQ0KPiA+ICB7DQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90
b19pOTE1KGludGVsX2RwKTsNCj4gPiAgCXUzMiB2YWw7DQo+ID4gIA0KPiA+IC0JaWYgKCFkZXZf
cHJpdi0+cHNyLmFjdGl2ZSkgew0KPiA+IC0JCWlmICh0cmFuc2NvZGVyX2hhc19wc3IyKGRldl9w
cml2LCBkZXZfcHJpdi0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKSB7DQo+ID4gKwlpZiAoIWludGVs
X2RwLT5wc3IuYWN0aXZlKSB7DQo+ID4gKwkJaWYgKHRyYW5zY29kZXJfaGFzX3BzcjIoZGV2X3By
aXYsIGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpIHsNCj4gPiAgCQkJdmFsID0gaW50
ZWxfZGVfcmVhZChkZXZfcHJpdiwNCj4gPiAtCQkJCQkgICAgRURQX1BTUjJfQ1RMKGRldl9wcml2
LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICsJCQkJCSAgICBFRFBfUFNSMl9DVEwoaW50
ZWxfZHAtDQo+ID4gPnBzci50cmFuc2NvZGVyKSk7DQo+ID4gIAkJCWRybV9XQVJOX09OKCZkZXZf
cHJpdi0+ZHJtLCB2YWwgJg0KPiA+IEVEUF9QU1IyX0VOQUJMRSk7DQo+ID4gIAkJfQ0KPiA+ICAN
Cj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LA0KPiA+IC0JCQkJICAgIEVEUF9Q
U1JfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICsJCQkJICAgIEVE
UF9QU1JfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICAJCWRybV9X
QVJOX09OKCZkZXZfcHJpdi0+ZHJtLCB2YWwgJiBFRFBfUFNSX0VOQUJMRSk7DQo+ID4gIA0KPiA+
ICAJCXJldHVybjsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5wc3Iy
X2VuYWJsZWQpIHsNCj4gPiAtCQl0Z2xfZGlzYWxsb3dfZGMzY29fb25fcHNyMl9leGl0KGRldl9w
cml2KTsNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+ICsJCXRn
bF9kaXNhbGxvd19kYzNjb19vbl9wc3IyX2V4aXQoaW50ZWxfZHApOw0KPiA+ICAJCXZhbCA9IGlu
dGVsX2RlX3JlYWQoZGV2X3ByaXYsDQo+ID4gLQkJCQkgICAgRURQX1BTUjJfQ1RMKGRldl9wcml2
LQ0KPiA+ID5wc3IudHJhbnNjb2RlcikpOw0KPiA+ICsJCQkJICAgIEVEUF9QU1IyX0NUTChpbnRl
bF9kcC0NCj4gPiA+cHNyLnRyYW5zY29kZXIpKTsNCj4gPiAgCQlkcm1fV0FSTl9PTigmZGV2X3By
aXYtPmRybSwgISh2YWwgJiBFRFBfUFNSMl9FTkFCTEUpKTsNCj4gPiAgCQl2YWwgJj0gfkVEUF9Q
U1IyX0VOQUJMRTsNCj4gPiAgCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwNCj4gPiAtCQkJICAg
ICAgIEVEUF9QU1IyX0NUTChkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIpLA0KPiA+IHZhbCk7DQo+
ID4gKwkJCSAgICAgICBFRFBfUFNSMl9DVEwoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKSwNCj4g
PiB2YWwpOw0KPiA+ICAJfSBlbHNlIHsNCj4gPiAgCQl2YWwgPSBpbnRlbF9kZV9yZWFkKGRldl9w
cml2LA0KPiA+IC0JCQkJICAgIEVEUF9QU1JfQ1RMKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNj
b2RlcikpOw0KPiA+ICsJCQkJICAgIEVEUF9QU1JfQ1RMKGludGVsX2RwLQ0KPiA+ID5wc3IudHJh
bnNjb2RlcikpOw0KPiA+ICAJCWRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCAhKHZhbCAmIEVE
UF9QU1JfRU5BQkxFKSk7DQo+ID4gIAkJdmFsICY9IH5FRFBfUFNSX0VOQUJMRTsNCj4gPiAgCQlp
bnRlbF9kZV93cml0ZShkZXZfcHJpdiwNCj4gPiAtCQkJICAgICAgIEVEUF9QU1JfQ1RMKGRldl9w
cml2LT5wc3IudHJhbnNjb2RlciksDQo+ID4gdmFsKTsNCj4gPiArCQkJICAgICAgIEVEUF9QU1Jf
Q1RMKGludGVsX2RwLT5wc3IudHJhbnNjb2RlciksDQo+ID4gdmFsKTsNCj4gPiAgCX0NCj4gPiAt
CWRldl9wcml2LT5wc3IuYWN0aXZlID0gZmFsc2U7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLmFjdGl2
ZSA9IGZhbHNlOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZGlz
YWJsZV9sb2NrZWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkNCj4gPiBAQCAtMTA3NywyMSAr
MTA3MywyMSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZGlzYWJsZV9sb2NrZWQoc3RydWN0DQo+
ID4gaW50ZWxfZHAgKmludGVsX2RwKQ0KPiA+ICAJaTkxNV9yZWdfdCBwc3Jfc3RhdHVzOw0KPiA+
ICAJdTMyIHBzcl9zdGF0dXNfbWFzazsNCj4gPiAgDQo+ID4gLQlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaW50ZWxf
ZHAtPnBzci5sb2NrKTsNCj4gPiAgDQo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxlZCkN
Cj4gPiArCWlmICghaW50ZWxfZHAtPnBzci5lbmFibGVkKQ0KPiA+ICAJCXJldHVybjsNCj4gPiAg
DQo+ID4gIAlkcm1fZGJnX2ttcygmZGV2X3ByaXYtPmRybSwgIkRpc2FibGluZyBQU1Ilc1xuIiwN
Cj4gPiAtCQkgICAgZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQgPyAiMiIgOiAiMSIpOw0KPiA+
ICsJCSAgICBpbnRlbF9kcC0+cHNyLnBzcjJfZW5hYmxlZCA/ICIyIiA6ICIxIik7DQo+ID4gIA0K
PiA+IC0JaW50ZWxfcHNyX2V4aXQoZGV2X3ByaXYpOw0KPiA+ICsJaW50ZWxfcHNyX2V4aXQoaW50
ZWxfZHApOw0KPiA+ICANCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkgew0K
PiA+IC0JCXBzcl9zdGF0dXMgPSBFRFBfUFNSMl9TVEFUVVMoZGV2X3ByaXYtPnBzci50cmFuc2Nv
ZGVyKTsNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNyLnBzcjJfZW5hYmxlZCkgew0KPiA+ICsJCXBz
cl9zdGF0dXMgPSBFRFBfUFNSMl9TVEFUVVMoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4g
PiAgCQlwc3Jfc3RhdHVzX21hc2sgPSBFRFBfUFNSMl9TVEFUVVNfU1RBVEVfTUFTSzsNCj4gPiAg
CX0gZWxzZSB7DQo+ID4gLQkJcHNyX3N0YXR1cyA9IEVEUF9QU1JfU1RBVFVTKGRldl9wcml2LT5w
c3IudHJhbnNjb2Rlcik7DQo+ID4gKwkJcHNyX3N0YXR1cyA9IEVEUF9QU1JfU1RBVFVTKGludGVs
X2RwLT5wc3IudHJhbnNjb2Rlcik7DQo+ID4gIAkJcHNyX3N0YXR1c19tYXNrID0gRURQX1BTUl9T
VEFUVVNfU1RBVEVfTUFTSzsNCj4gPiAgCX0NCj4gPiAgDQo+ID4gQEAgLTExMDEsNyArMTA5Nyw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChzdHJ1Y3QNCj4gPiBpbnRl
bF9kcCAqaW50ZWxfZHApDQo+ID4gIAkJZHJtX2VycigmZGV2X3ByaXYtPmRybSwgIlRpbWVkIG91
dCB3YWl0aW5nIFBTUiBpZGxlDQo+ID4gc3RhdGVcbiIpOw0KPiA+ICANCj4gPiAgCS8qIFdBIDE0
MDgzMzA4NDcgKi8NCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfc2VsX2ZldGNoX2VuYWJs
ZWQgJiYNCj4gPiArCWlmIChpbnRlbF9kcC0+cHNyLnBzcjJfc2VsX2ZldGNoX2VuYWJsZWQgJiYN
Cj4gPiAgCSAgICAoSVNfVEdMX0RJU1BfUkVWSUQoZGV2X3ByaXYsIFRHTF9SRVZJRF9BMCwgVEdM
X1JFVklEX0EwKSB8fA0KPiA+ICAJICAgICBJU19SS0xfUkVWSUQoZGV2X3ByaXYsIFJLTF9SRVZJ
RF9BMCwgUktMX1JFVklEX0EwKSkpDQo+ID4gIAkJaW50ZWxfZGVfcm13KGRldl9wcml2LCBDSElD
S0VOX1BBUjFfMSwNCj4gPiBAQCAtMTExMCwxMCArMTEwNiwxMCBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9wc3JfZGlzYWJsZV9sb2NrZWQoc3RydWN0DQo+ID4gaW50ZWxfZHAgKmludGVsX2RwKQ0KPiA+
ICAJLyogRGlzYWJsZSBQU1Igb24gU2luayAqLw0KPiA+ICAJZHJtX2RwX2RwY2Rfd3JpdGViKCZp
bnRlbF9kcC0+YXV4LCBEUF9QU1JfRU5fQ0ZHLCAwKTsNCj4gPiAgDQo+ID4gLQlpZiAoZGV2X3By
aXYtPnBzci5wc3IyX2VuYWJsZWQpDQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJs
ZWQpDQo+ID4gIAkJZHJtX2RwX2RwY2Rfd3JpdGViKCZpbnRlbF9kcC0+YXV4LA0KPiA+IERQX1JF
Q0VJVkVSX0FMUE1fQ09ORklHLCAwKTsNCj4gPiAgDQo+ID4gLQlkZXZfcHJpdi0+cHNyLmVuYWJs
ZWQgPSBmYWxzZTsNCj4gPiArCWludGVsX2RwLT5wc3IuZW5hYmxlZCA9IGZhbHNlOw0KPiA+ICB9
DQo+ID4gIA0KPiA+ICAvKioNCj4gPiBAQCAtMTEzMSwyMCArMTEyNywyMiBAQCB2b2lkIGludGVs
X3Bzcl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiAgCWlmICgh
b2xkX2NydGNfc3RhdGUtPmhhc19wc3IpDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAtCWlm
IChkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgIUNBTl9QU1IoZGV2X3ByaXYpKSkNCj4gPiAr
CWlmIChkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgIUNBTl9QU1IoaW50ZWxfZHApKSkNCj4g
PiAgCQlyZXR1cm47DQo+ID4gIA0KPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBzci5sb2Nr
KTsNCj4gPiArCW11dGV4X2xvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIA0KPiA+ICAJ
aW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKGludGVsX2RwKTsNCj4gPiAgDQo+ID4gLQltdXRleF91
bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gLQljYW5jZWxfd29ya19zeW5jKCZkZXZf
cHJpdi0+cHNyLndvcmspOw0KPiA+IC0JY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZkZXZfcHJp
di0+cHNyLmRjM2NvX3dvcmspOw0KPiA+ICsJbXV0ZXhfdW5sb2NrKCZpbnRlbF9kcC0+cHNyLmxv
Y2spOw0KPiA+ICsJY2FuY2VsX3dvcmtfc3luYygmaW50ZWxfZHAtPnBzci53b3JrKTsNCj4gPiAr
CWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmaW50ZWxfZHAtPnBzci5kYzNjb193b3JrKTsNCj4g
PiAgfQ0KPiA+ICANCj4gPiAtc3RhdGljIHZvaWQgcHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUNCj4gPiAqZGV2X3ByaXYpDQo+ID4gK3N0YXRpYyB2b2lk
IHBzcl9mb3JjZV9od190cmFja2luZ19leGl0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+
ID4gIHsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5
MTUoaW50ZWxfZHApOw0KPiA+ICsNCj4gPiAgCWlmIChJU19USUdFUkxBS0UoZGV2X3ByaXYpKQ0K
PiA+ICAJCS8qDQo+ID4gIAkJICogV3JpdGVzIHRvIENVUlNVUkZMSVZFIGluIFRHTCBhcmUgY2F1
c2luZyBJT01NVQ0KPiA+IGVycm9ycyBhbmQNCj4gPiBAQCAtMTE1OCw3ICsxMTU2LDcgQEAgc3Rh
dGljIHZvaWQgcHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQoc3RydWN0DQo+ID4gZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpDQo+ID4gIAkJICogU28gdXNpbmcgdGhpcyB3b3JrYXJvdW5kIHVu
dGlsIHRoaXMgaXNzdWUgaXMgcm9vdA0KPiA+IGNhdXNlZA0KPiA+ICAJCSAqIGFuZCBhIGJldHRl
ciBmaXggaXMgZm91bmQuDQo+ID4gIAkJICovDQo+ID4gLQkJaW50ZWxfcHNyX2V4aXQoZGV2X3By
aXYpOw0KPiA+ICsJCWludGVsX3Bzcl9leGl0KGludGVsX2RwKTsNCj4gPiAgCWVsc2UgaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gOSkNCj4gPiAgCQkvKg0KPiA+ICAJCSAqIERpc3BsYXkgV0Eg
IzA4ODQ6IHNrbCsNCj4gPiBAQCAtMTE2OSwxMyArMTE2NywxMyBAQCBzdGF0aWMgdm9pZA0KPiA+
IHBzcl9mb3JjZV9od190cmFja2luZ19leGl0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikNCj4gPiAgCQkgKiBidXQgaXQgbWFrZXMgbW9yZSBzZW5zZSB3cml0ZSB0byB0aGUgY3Vy
cmVudCBhY3RpdmUNCj4gPiAgCQkgKiBwaXBlLg0KPiA+ICAJCSAqLw0KPiA+IC0JCWludGVsX2Rl
X3dyaXRlKGRldl9wcml2LCBDVVJTVVJGTElWRShkZXZfcHJpdi0NCj4gPiA+cHNyLnBpcGUpLCAw
KTsNCj4gPiArCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgQ1VSU1VSRkxJVkUoaW50ZWxfZHAt
DQo+ID4gPnBzci5waXBlKSwgMCk7DQo+ID4gIAllbHNlDQo+ID4gIAkJLyoNCj4gPiAgCQkgKiBB
IHdyaXRlIHRvIENVUlNVUkZMSVZFIGRvIG5vdCBjYXVzZSBIVyB0cmFja2luZyB0bw0KPiA+IGV4
aXQgUFNSDQo+ID4gIAkJICogb24gb2xkZXIgZ2VucyBzbyBkb2luZyB0aGUgbWFudWFsIGV4aXQg
aW5zdGVhZC4NCj4gPiAgCQkgKi8NCj4gPiAtCQlpbnRlbF9wc3JfZXhpdChkZXZfcHJpdik7DQo+
ID4gKwkJaW50ZWxfcHNyX2V4aXQoaW50ZWxfZHApOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICB2b2lk
IGludGVsX3BzcjJfcHJvZ3JhbV9wbGFuZV9zZWxfZmV0Y2goc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSwNCj4gPiBAQCAtMTIxMCwxMSArMTIwOCwxMSBAQCB2b2lkDQo+ID4gaW50ZWxfcHNyMl9w
cm9ncmFtX3BsYW5lX3NlbF9mZXRjaChzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLA0KPiA+ICAJ
aW50ZWxfZGVfd3JpdGVfZncoZGV2X3ByaXYsIFBMQU5FX1NFTF9GRVRDSF9TSVpFKHBpcGUsIHBs
YW5lLQ0KPiA+ID5pZCksIHZhbCk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gLXZvaWQgaW50ZWxfcHNy
Ml9wcm9ncmFtX3RyYW5zX21hbl90cmtfY3RsKGNvbnN0IHN0cnVjdA0KPiA+IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpDQo+ID4gK3ZvaWQgaW50ZWxfcHNyMl9wcm9ncmFtX3RyYW5zX21h
bl90cmtfY3RsKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiArCQkJCQkgIGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlDQo+ID4gKmNydGNfc3RhdGUpDQo+ID4gIHsNCj4g
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51
YXBpLmNydGMpOw0KPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7DQo+ID4gLQlzdHJ1Y3QgaTkxNV9wc3IgKnBzciA9ICZkZXZf
cHJpdi0+cHNyOw0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBf
dG9faTkxNShpbnRlbF9kcCk7DQo+ID4gKwlzdHJ1Y3QgaW50ZWxfcHNyICpwc3IgPSAmaW50ZWxf
ZHAtPnBzcjsNCj4gPiAgDQo+ID4gIAlpZiAoIUhBU19QU1IyX1NFTF9GRVRDSChkZXZfcHJpdikg
fHwNCj4gPiAgCSAgICAhY3J0Y19zdGF0ZS0+ZW5hYmxlX3BzcjJfc2VsX2ZldGNoKQ0KPiA+IEBA
IC0xMzI2LDEzICsxMzI0LDEzIEBAIHZvaWQgaW50ZWxfcHNyX3VwZGF0ZShzdHJ1Y3QgaW50ZWxf
ZHANCj4gPiAqaW50ZWxfZHAsDQo+ID4gIAkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0
b3Jfc3RhdGUgKmNvbm5fc3RhdGUpDQo+ID4gIHsNCj4gPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+IC0Jc3RydWN0IGk5MTVf
cHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsNCj4gPiArCXN0cnVjdCBpbnRlbF9wc3IgKnBzciA9
ICZpbnRlbF9kcC0+cHNyOw0KPiA+ICAJYm9vbCBlbmFibGUsIHBzcjJfZW5hYmxlOw0KPiA+ICAN
Cj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikgfHwgUkVBRF9PTkNFKHBzci0+ZHApICE9IGlu
dGVsX2RwKQ0KPiA+ICsJaWYgKCFDQU5fUFNSKGludGVsX2RwKSkNCj4gPiAgCQlyZXR1cm47DQo+
ID4gIA0KPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsNCj4gPiArCW11dGV4
X2xvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIA0KPiA+ICAJZW5hYmxlID0gY3J0Y19z
dGF0ZS0+aGFzX3BzcjsNCj4gPiAgCXBzcjJfZW5hYmxlID0gY3J0Y19zdGF0ZS0+aGFzX3BzcjI7
DQo+ID4gQEAgLTEzNDAsMTUgKzEzMzgsMTUgQEAgdm9pZCBpbnRlbF9wc3JfdXBkYXRlKHN0cnVj
dCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiAgCWlmIChlbmFibGUgPT0gcHNyLT5lbmFi
bGVkICYmIHBzcjJfZW5hYmxlID09IHBzci0+cHNyMl9lbmFibGVkKSANCj4gPiB7DQo+ID4gIAkJ
LyogRm9yY2UgYSBQU1IgZXhpdCB3aGVuIGVuYWJsaW5nIENSQyB0byBhdm9pZCBDUkMNCj4gPiB0
aW1lb3V0cyAqLw0KPiA+ICAJCWlmIChjcnRjX3N0YXRlLT5jcmNfZW5hYmxlZCAmJiBwc3ItPmVu
YWJsZWQpDQo+ID4gLQkJCXBzcl9mb3JjZV9od190cmFja2luZ19leGl0KGRldl9wcml2KTsNCj4g
PiArCQkJcHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQoaW50ZWxfZHApOw0KPiA+ICAJCWVsc2Ug
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA5ICYmIHBzci0+ZW5hYmxlZCkgew0KPiA+ICAJCQkv
Kg0KPiA+ICAJCQkgKiBBY3RpdmF0ZSBQU1IgYWdhaW4gYWZ0ZXIgYSBmb3JjZSBleGl0IHdoZW4N
Cj4gPiBlbmFibGluZw0KPiA+ICAJCQkgKiBDUkMgaW4gb2xkZXIgZ2Vucw0KPiA+ICAJCQkgKi8N
Cj4gPiAtCQkJaWYgKCFkZXZfcHJpdi0+cHNyLmFjdGl2ZSAmJg0KPiA+IC0JCQkgICAgIWRldl9w
cml2LT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzKQ0KPiA+IC0JCQkJc2NoZWR1bGVfd29yaygm
ZGV2X3ByaXYtPnBzci53b3JrKTsNCj4gPiArCQkJaWYgKCFpbnRlbF9kcC0+cHNyLmFjdGl2ZSAm
Jg0KPiA+ICsJCQkgICAgIWludGVsX2RwLT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzKQ0KPiA+
ICsJCQkJc2NoZWR1bGVfd29yaygmaW50ZWxfZHAtPnBzci53b3JrKTsNCj4gPiAgCQl9DQo+ID4g
IA0KPiA+ICAJCWdvdG8gdW5sb2NrOw0KPiA+IEBAIC0xMzU4LDM0ICsxMzU2LDIzIEBAIHZvaWQg
aW50ZWxfcHNyX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHAsDQo+ID4gIAkJ
aW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKGludGVsX2RwKTsNCj4gPiAgDQo+ID4gIAlpZiAoZW5h
YmxlKQ0KPiA+IC0JCWludGVsX3Bzcl9lbmFibGVfbG9ja2VkKGRldl9wcml2LCBjcnRjX3N0YXRl
LA0KPiA+IGNvbm5fc3RhdGUpOw0KPiA+ICsJCWludGVsX3Bzcl9lbmFibGVfbG9ja2VkKGludGVs
X2RwLCBjcnRjX3N0YXRlLA0KPiA+IGNvbm5fc3RhdGUpOw0KPiA+ICANCj4gPiAgdW5sb2NrOg0K
PiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfdW5s
b2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICAvKioNCj4gPiAt
ICogaW50ZWxfcHNyX3dhaXRfZm9yX2lkbGUgLSB3YWl0IGZvciBQU1IxIHRvIGlkbGUNCj4gPiAt
ICogQG5ld19jcnRjX3N0YXRlOiBuZXcgQ1JUQyBzdGF0ZQ0KPiA+ICsgKiBwc3Jfd2FpdF9mb3Jf
aWRsZSAtIHdhaXQgZm9yIFBTUjEgdG8gaWRsZQ0KPiA+ICsgKiBAaW50ZWxfZHA6IEludGVsIERQ
DQo+ID4gICAqIEBvdXRfdmFsdWU6IFBTUiBzdGF0dXMgaW4gY2FzZSBvZiBmYWlsdXJlDQo+ID4g
ICAqDQo+ID4gLSAqIFRoaXMgZnVuY3Rpb24gaXMgZXhwZWN0ZWQgdG8gYmUgY2FsbGVkIGZyb20g
cGlwZV91cGRhdGVfc3RhcnQoKQ0KPiA+IHdoZXJlIGl0IGlzDQo+ID4gLSAqIG5vdCBleHBlY3Rl
ZCB0byByYWNlIHdpdGggUFNSIGVuYWJsZSBvciBkaXNhYmxlLg0KPiA+IC0gKg0KPiA+ICAgKiBS
ZXR1cm5zOiAwIG9uIHN1Y2Nlc3Mgb3IgLUVUSU1FT1VUIGlmIFBTUiBzdGF0dXMgZG9lcyBub3Qg
aWRsZS4NCj4gPiArICoNCj4gPiAgICovDQo+ID4gLWludCBpbnRlbF9wc3Jfd2FpdF9mb3JfaWRs
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpuZXdfY3J0Y19zdGF0ZSwNCj4g
PiAtCQkJICAgIHUzMiAqb3V0X3ZhbHVlKQ0KPiA+ICtzdGF0aWMgaW50IHBzcl93YWl0X2Zvcl9p
ZGxlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHUzMg0KPiA+ICpvdXRfdmFsdWUpDQo+ID4g
IHsNCj4gPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0
Y19zdGF0ZS0NCj4gPiA+dWFwaS5jcnRjKTsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOw0KPiA+IC0NCj4gPiAtCWlmICgh
ZGV2X3ByaXYtPnBzci5lbmFibGVkIHx8ICFuZXdfY3J0Y19zdGF0ZS0+aGFzX3BzcikNCj4gPiAt
CQlyZXR1cm4gMDsNCj4gPiAtDQo+ID4gLQkvKiBGSVhNRTogVXBkYXRlIHRoaXMgZm9yIFBTUjIg
aWYgd2UgbmVlZCB0byB3YWl0IGZvciBpZGxlICovDQo+ID4gLQlpZiAoUkVBRF9PTkNFKGRldl9w
cml2LT5wc3IucHNyMl9lbmFibGVkKSkNCj4gPiAtCQlyZXR1cm4gMDsNCj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAN
Cj4gPiAgCS8qDQo+ID4gIAkgKiBGcm9tIGJzcGVjOiBQYW5lbCBTZWxmIFJlZnJlc2ggKEJEVysp
DQo+ID4gQEAgLTEzOTMsMzIgKzEzODAsNjcgQEAgaW50IGludGVsX3Bzcl93YWl0X2Zvcl9pZGxl
KGNvbnN0IHN0cnVjdA0KPiA+IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlLA0KPiA+
ICAJICogZXhpdCB0cmFpbmluZyB0aW1lICsgMS41IG1zIG9mIGF1eCBjaGFubmVsIGhhbmRzaGFr
ZS4gNTAgbXMNCj4gPiBpcw0KPiA+ICAJICogZGVmZW5zaXZlIGVub3VnaCB0byBjb3ZlciBldmVy
eXRoaW5nLg0KPiA+ICAJICovDQo+ID4gLQ0KPiA+ICAJcmV0dXJuIF9faW50ZWxfd2FpdF9mb3Jf
cmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsDQo+ID4gLQkJCQkJIEVEUF9QU1JfU1RBVFVTKGRl
dl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2RlciksDQo+ID4gKwkJCQkJIEVEUF9QU1JfU1RBVFVT
KGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2RlciksDQo+ID4gIAkJCQkJIEVEUF9QU1JfU1RB
VFVTX1NUQVRFX01BU0ssDQo+ID4gIAkJCQkJIEVEUF9QU1JfU1RBVFVTX1NUQVRFX0lETEUsIDIs
DQo+ID4gNTAsDQo+ID4gIAkJCQkJIG91dF92YWx1ZSk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gLXN0
YXRpYyBib29sIF9fcHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlDQo+ID4gKmRldl9wcml2KQ0KPiA+ICsvKioNCj4gPiArICogaW50ZWxfcHNyX3dhaXRfZm9y
X2lkbGUgLSB3YWl0IGZvciBQU1IxIHRvIGlkbGUNCj4gPiArICogQG5ld19jcnRjX3N0YXRlOiBu
ZXcgQ1JUQyBzdGF0ZQ0KPiA+ICsgKg0KPiA+ICsgKiBUaGlzIGZ1bmN0aW9uIGlzIGV4cGVjdGVk
IHRvIGJlIGNhbGxlZCBmcm9tIHBpcGVfdXBkYXRlX3N0YXJ0KCkNCj4gPiB3aGVyZSBpdCBpcw0K
PiA+ICsgKiBub3QgZXhwZWN0ZWQgdG8gcmFjZSB3aXRoIFBTUiBlbmFibGUgb3IgZGlzYWJsZS4N
Cj4gPiArICovDQo+ID4gK3ZvaWQgaW50ZWxfcHNyX3dhaXRfZm9yX2lkbGUoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUNCj4gPiAqbmV3X2NydGNfc3RhdGUpDQo+ID4gK3sNCj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUobmV3X2NydGNfc3RhdGUt
DQo+ID4gPnVhcGkuY3J0Yy0+ZGV2KTsNCj4gPiArCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyOw0KPiA+ICsJdTMyIHBzcl9zdGF0dXM7DQo+ID4gKw0KPiA+ICsJaWYgKCFuZXdfY3J0Y19z
dGF0ZS0+aGFzX3BzcikNCj4gPiArCQlyZXR1cm47DQo+ID4gKw0KPiA+ICsJZm9yX2VhY2hfaW50
ZWxfZHAoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiArCQlzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+ICsNCj4gPiArCQlpZiAo
ZW5jb2Rlci0+dHlwZSAhPSBJTlRFTF9PVVRQVVRfRURQKQ0KPiA+ICsJCQljb250aW51ZTsNCj4g
PiArDQo+ID4gKwkJLyogd2hlbiB0aGUgUFNSMSBpcyBlbmFibGVkICovDQo+ID4gKwkJaWYgKGlu
dGVsX2RwLT5wc3IuZW5hYmxlZCAmJiAhaW50ZWxfZHAtDQo+ID4gPnBzci5wc3IyX2VuYWJsZWQp
IHsNCj4gPiArCQkJaWYgKHBzcl93YWl0X2Zvcl9pZGxlKGludGVsX2RwLCAmcHNyX3N0YXR1cykp
DQo+ID4gKwkJCQlkcm1fZXJyKCZkZXZfcHJpdi0+ZHJtLA0KPiA+ICsJCQkJCSJQU1IgaWRsZSB0
aW1lZCBvdXQgMHgleCwNCj4gPiBhdG9taWMgdXBkYXRlIG1heSBmYWlsXG4iLA0KPiA+ICsJCQkJ
CXBzcl9zdGF0dXMpOw0KPiA+ICsNCj4gPiArCQkJLyogb25seSBvbmUgdHJhbmNvZGVyIGNhbiBl
bmFibGUgUFNSMSAqLw0KPiA+ICsJCQlicmVhazsNCj4gPiArCQl9DQo+ID4gKwl9DQo+ID4gK30N
Cj4gPiArDQo+ID4gK3N0YXRpYyBib29sIF9fcHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAgCWk5MTVfcmVnX3QgcmVnOw0KPiA+
ICAJdTMyIG1hc2s7DQo+ID4gIAlpbnQgZXJyOw0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gIA0KPiA+IC0JaWYgKCFk
ZXZfcHJpdi0+cHNyLmVuYWJsZWQpDQo+ID4gKwlpZiAoIWludGVsX2RwLT5wc3IuZW5hYmxlZCkN
Cj4gPiAgCQlyZXR1cm4gZmFsc2U7DQo+ID4gIA0KPiA+IC0JaWYgKGRldl9wcml2LT5wc3IucHNy
Ml9lbmFibGVkKSB7DQo+ID4gLQkJcmVnID0gRURQX1BTUjJfU1RBVFVTKGRldl9wcml2LT5wc3Iu
dHJhbnNjb2Rlcik7DQo+ID4gKwlpZiAoaW50ZWxfZHAtPnBzci5wc3IyX2VuYWJsZWQpIHsNCj4g
PiArCQlyZWcgPSBFRFBfUFNSMl9TVEFUVVMoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4g
PiAgCQltYXNrID0gRURQX1BTUjJfU1RBVFVTX1NUQVRFX01BU0s7DQo+ID4gIAl9IGVsc2Ugew0K
PiA+IC0JCXJlZyA9IEVEUF9QU1JfU1RBVFVTKGRldl9wcml2LT5wc3IudHJhbnNjb2Rlcik7DQo+
ID4gKwkJcmVnID0gRURQX1BTUl9TVEFUVVMoaW50ZWxfZHAtPnBzci50cmFuc2NvZGVyKTsNCj4g
PiAgCQltYXNrID0gRURQX1BTUl9TVEFUVVNfU1RBVEVfTUFTSzsNCj4gPiAgCX0NCj4gPiAgDQo+
ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gKwltdXRleF91bmxv
Y2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gIA0KPiA+ICAJZXJyID0gaW50ZWxfZGVfd2Fp
dF9mb3JfY2xlYXIoZGV2X3ByaXYsIHJlZywgbWFzaywgNTApOw0KPiA+ICAJaWYgKGVycikNCj4g
PiBAQCAtMTQyNiw4ICsxNDQ4LDggQEAgc3RhdGljIGJvb2wgX19wc3Jfd2FpdF9mb3JfaWRsZV9s
b2NrZWQoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpDQo+ID4gIAkJCSJU
aW1lZCBvdXQgd2FpdGluZyBmb3IgUFNSIElkbGUgZm9yIHJlLQ0KPiA+IGVuYWJsZVxuIik7DQo+
ID4gIA0KPiA+ICAJLyogQWZ0ZXIgdGhlIHVubG9ja2VkIHdhaXQsIHZlcmlmeSB0aGF0IFBTUiBp
cyBzdGlsbCB3YW50ZWQhICovDQo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2sp
Ow0KPiA+IC0JcmV0dXJuIGVyciA9PSAwICYmIGRldl9wcml2LT5wc3IuZW5hYmxlZDsNCj4gPiAr
CW11dGV4X2xvY2soJmludGVsX2RwLT5wc3IubG9jayk7DQo+ID4gKwlyZXR1cm4gZXJyID09IDAg
JiYgaW50ZWxfZHAtPnBzci5lbmFibGVkOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICBzdGF0aWMgaW50
IGludGVsX3Bzcl9mYXN0c2V0X2ZvcmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRl
dl9wcml2KQ0KPiA+IEBAIC0xNDkzLDExICsxNTE1LDEyIEBAIHN0YXRpYyBpbnQgaW50ZWxfcHNy
X2Zhc3RzZXRfZm9yY2Uoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpDQo+
ID4gIAlyZXR1cm4gZXJyOw0KPiA+ICB9DQo+ID4gIA0KPiA+IC1pbnQgaW50ZWxfcHNyX2RlYnVn
X3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU2NA0KPiA+IHZhbCkNCj4g
PiAraW50IGludGVsX3Bzcl9kZWJ1Z19zZXQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgdTY0
IHZhbCkNCj4gPiAgew0KPiA+ICAJY29uc3QgdTMyIG1vZGUgPSB2YWwgJiBJOTE1X1BTUl9ERUJV
R19NT0RFX01BU0s7DQo+ID4gIAl1MzIgb2xkX21vZGU7DQo+ID4gIAlpbnQgcmV0Ow0KPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7
DQo+ID4gIA0KPiA+ICAJaWYgKHZhbCAmIH4oSTkxNV9QU1JfREVCVUdfSVJRIHwgSTkxNV9QU1Jf
REVCVUdfTU9ERV9NQVNLKSB8fA0KPiA+ICAJICAgIG1vZGUgPiBJOTE1X1BTUl9ERUJVR19GT1JD
RV9QU1IxKSB7DQo+ID4gQEAgLTE1MDUsMjEgKzE1MjgsMjEgQEAgaW50IGludGVsX3Bzcl9kZWJ1
Z19zZXQoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU2NCB2YWwpDQo+
ID4gIAkJcmV0dXJuIC1FSU5WQUw7DQo+ID4gIAl9DQo+ID4gIA0KPiA+IC0JcmV0ID0gbXV0ZXhf
bG9ja19pbnRlcnJ1cHRpYmxlKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJcmV0ID0gbXV0
ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICAJaWYgKHJl
dCkNCj4gPiAgCQlyZXR1cm4gcmV0Ow0KPiA+ICANCj4gPiAtCW9sZF9tb2RlID0gZGV2X3ByaXYt
PnBzci5kZWJ1ZyAmIEk5MTVfUFNSX0RFQlVHX01PREVfTUFTSzsNCj4gPiAtCWRldl9wcml2LT5w
c3IuZGVidWcgPSB2YWw7DQo+ID4gKwlvbGRfbW9kZSA9IGludGVsX2RwLT5wc3IuZGVidWcgJiBJ
OTE1X1BTUl9ERUJVR19NT0RFX01BU0s7DQo+ID4gKwlpbnRlbF9kcC0+cHNyLmRlYnVnID0gdmFs
Ow0KPiA+ICANCj4gPiAgCS8qDQo+ID4gIAkgKiBEbyBpdCByaWdodCBhd2F5IGlmIGl0J3MgYWxy
ZWFkeSBlbmFibGVkLCBvdGhlcndpc2UgaXQgd2lsbA0KPiA+IGJlIGRvbmUNCj4gPiAgCSAqIHdo
ZW4gZW5hYmxpbmcgdGhlIHNvdXJjZS4NCj4gPiAgCSAqLw0KPiA+IC0JaWYgKGRldl9wcml2LT5w
c3IuZW5hYmxlZCkNCj4gPiAtCQlwc3JfaXJxX2NvbnRyb2woZGV2X3ByaXYpOw0KPiA+ICsJaWYg
KGludGVsX2RwLT5wc3IuZW5hYmxlZCkNCj4gPiArCQlwc3JfaXJxX2NvbnRyb2woaW50ZWxfZHAp
Ow0KPiA+ICANCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsNCj4gPiAr
CW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgDQo+ID4gIAlpZiAob2xk
X21vZGUgIT0gbW9kZSkNCj4gPiAgCQlyZXQgPSBpbnRlbF9wc3JfZmFzdHNldF9mb3JjZShkZXZf
cHJpdik7DQo+ID4gQEAgLTE1MjcsMjggKzE1NTAsMjggQEAgaW50IGludGVsX3Bzcl9kZWJ1Z19z
ZXQoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU2NCB2YWwpDQo+ID4g
IAlyZXR1cm4gcmV0Ow0KPiA+ICB9DQo+ID4gIA0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9wc3Jf
aGFuZGxlX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdikNCj4gPiAr
c3RhdGljIHZvaWQgaW50ZWxfcHNyX2hhbmRsZV9pcnEoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCkNCj4gPiAgew0KPiA+IC0Jc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsN
Cj4gPiArCXN0cnVjdCBpbnRlbF9wc3IgKnBzciA9ICZpbnRlbF9kcC0+cHNyOw0KPiA+ICANCj4g
PiAtCWludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChwc3ItPmRwKTsNCj4gPiArCWludGVsX3Bzcl9k
aXNhYmxlX2xvY2tlZChpbnRlbF9kcCk7DQo+ID4gIAlwc3ItPnNpbmtfbm90X3JlbGlhYmxlID0g
dHJ1ZTsNCj4gPiAgCS8qIGxldCdzIG1ha2Ugc3VyZSB0aGF0IHNpbmsgaXMgYXdha2VuICovDQo+
ID4gLQlkcm1fZHBfZHBjZF93cml0ZWIoJnBzci0+ZHAtPmF1eCwgRFBfU0VUX1BPV0VSLA0KPiA+
IERQX1NFVF9QT1dFUl9EMCk7DQo+ID4gKwlkcm1fZHBfZHBjZF93cml0ZWIoJmludGVsX2RwLT5h
dXgsIERQX1NFVF9QT1dFUiwNCj4gPiBEUF9TRVRfUE9XRVJfRDApOw0KPiA+ICB9DQo+ID4gIA0K
PiA+ICBzdGF0aWMgdm9pZCBpbnRlbF9wc3Jfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmsp
DQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9DQo+ID4g
LQkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZGV2X3ByaXYpLCBwc3Iud29yayk7DQo+ID4g
KwlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0NCj4gPiArCQljb250YWluZXJfb2Yod29yaywg
dHlwZW9mKCppbnRlbF9kcCksIHBzci53b3JrKTsNCj4gPiAgDQo+ID4gLQltdXRleF9sb2NrKCZk
ZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2Nr
KTsNCj4gPiAgDQo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxlZCkNCj4gPiArCWlmICgh
aW50ZWxfZHAtPnBzci5lbmFibGVkKQ0KPiA+ICAJCWdvdG8gdW5sb2NrOw0KPiA+ICANCj4gPiAt
CWlmIChSRUFEX09OQ0UoZGV2X3ByaXYtPnBzci5pcnFfYXV4X2Vycm9yKSkNCj4gPiAtCQlpbnRl
bF9wc3JfaGFuZGxlX2lycShkZXZfcHJpdik7DQo+ID4gKwlpZiAoUkVBRF9PTkNFKGludGVsX2Rw
LT5wc3IuaXJxX2F1eF9lcnJvcikpDQo+ID4gKwkJaW50ZWxfcHNyX2hhbmRsZV9pcnEoaW50ZWxf
ZHApOw0KPiA+ICANCj4gPiAgCS8qDQo+ID4gIAkgKiBXZSBoYXZlIHRvIG1ha2Ugc3VyZSBQU1Ig
aXMgcmVhZHkgZm9yIHJlLWVuYWJsZQ0KPiA+IEBAIC0xNTU2LDcgKzE1NzksNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9wc3Jfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QNCj4gPiAqd29yaykNCj4gPiAg
CSAqIFBTUiBtaWdodCB0YWtlIHNvbWUgdGltZSB0byBnZXQgZnVsbHkgZGlzYWJsZWQNCj4gPiAg
CSAqIGFuZCBiZSByZWFkeSBmb3IgcmUtZW5hYmxlLg0KPiA+ICAJICovDQo+ID4gLQlpZiAoIV9f
cHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKGRldl9wcml2KSkNCj4gPiArCWlmICghX19wc3Jfd2Fp
dF9mb3JfaWRsZV9sb2NrZWQoaW50ZWxfZHApKQ0KPiA+ICAJCWdvdG8gdW5sb2NrOw0KPiA+ICAN
Cj4gPiAgCS8qDQo+ID4gQEAgLTE1NjQsMTIgKzE1ODcsMTIgQEAgc3RhdGljIHZvaWQgaW50ZWxf
cHNyX3dvcmsoc3RydWN0DQo+ID4gd29ya19zdHJ1Y3QgKndvcmspDQo+ID4gIAkgKiByZWNoZWNr
LiBTaW5jZSBwc3JfZmx1c2ggZmlyc3QgY2xlYXJzIHRoaXMgYW5kIHRoZW4NCj4gPiByZXNjaGVk
dWxlcyB3ZQ0KPiA+ICAJICogd29uJ3QgZXZlciBtaXNzIGEgZmx1c2ggd2hlbiBiYWlsaW5nIG91
dCBoZXJlLg0KPiA+ICAJICovDQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5idXN5X2Zyb250YnVm
ZmVyX2JpdHMgfHwgZGV2X3ByaXYtDQo+ID4gPnBzci5hY3RpdmUpDQo+ID4gKwlpZiAoaW50ZWxf
ZHAtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgfHwgaW50ZWxfZHAtDQo+ID4gPnBzci5hY3Rp
dmUpDQo+ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gIA0KPiA+IC0JaW50ZWxfcHNyX2FjdGl2YXRl
KGRldl9wcml2LT5wc3IuZHApOw0KPiA+ICsJaW50ZWxfcHNyX2FjdGl2YXRlKGludGVsX2RwKTsN
Cj4gPiAgdW5sb2NrOg0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0K
PiA+ICsJbXV0ZXhfdW5sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICB9DQo+ID4gIA0K
PiA+ICAvKioNCj4gPiBAQCAtMTU4OCwyNyArMTYxMSwzNSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9w
c3Jfd29yayhzdHJ1Y3QNCj4gPiB3b3JrX3N0cnVjdCAqd29yaykNCj4gPiAgdm9pZCBpbnRlbF9w
c3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gIAkJ
CSAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cywgZW51bSBmYl9vcF9vcmlnaW4NCj4gPiBvcmln
aW4pDQo+ID4gIHsNCj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikpDQo+ID4gLQkJcmV0dXJu
Ow0KPiA+ICsJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7DQo+ID4gKwlzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwOw0KPiA+ICANCj4gPiAtCWlmIChvcmlnaW4gPT0gT1JJR0lOX0ZMSVAp
DQo+ID4gLQkJcmV0dXJuOw0KPiA+ICsJZm9yX2VhY2hfaW50ZWxfZHAoJmRldl9wcml2LT5kcm0s
IGVuY29kZXIpIHsNCj4gPiAgDQo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2sp
Ow0KPiA+IC0JaWYgKCFkZXZfcHJpdi0+cHNyLmVuYWJsZWQpIHsNCj4gPiAtCQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gLQkJcmV0dXJuOw0KPiA+IC0JfQ0KPiA+ICsJ
CWludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+ICsJCWlmIChlbmNvZGVy
LT50eXBlICE9IElOVEVMX09VVFBVVF9FRFApDQo+ID4gKwkJCWNvbnRpbnVlOw0KPiA+ICsJCWlm
ICghQ0FOX1BTUihpbnRlbF9kcCkpDQo+ID4gKwkJCWNvbnRpbnVlOw0KPiA+ICsNCj4gPiArCQlp
ZiAob3JpZ2luID09IE9SSUdJTl9GTElQKQ0KPiA+ICsJCQljb250aW51ZTsNCj4gPiAgDQo+ID4g
LQlmcm9udGJ1ZmZlcl9iaXRzICY9IElOVEVMX0ZST05UQlVGRkVSX0FMTF9NQVNLKGRldl9wcml2
LQ0KPiA+ID5wc3IucGlwZSk7DQo+ID4gLQlkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJf
Yml0cyB8PSBmcm9udGJ1ZmZlcl9iaXRzOw0KPiA+ICsJCW11dGV4X2xvY2soJmludGVsX2RwLT5w
c3IubG9jayk7DQo+ID4gKwkJaWYgKCFpbnRlbF9kcC0+cHNyLmVuYWJsZWQpIHsNCj4gPiArCQkJ
bXV0ZXhfdW5sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICsJCQljb250aW51ZTsNCj4g
PiArCQl9DQo+ID4gIA0KPiA+IC0JaWYgKGZyb250YnVmZmVyX2JpdHMpDQo+ID4gLQkJaW50ZWxf
cHNyX2V4aXQoZGV2X3ByaXYpOw0KPiA+ICsJCWZyb250YnVmZmVyX2JpdHMgJj0NCj4gPiBJTlRF
TF9GUk9OVEJVRkZFUl9BTExfTUFTSyhpbnRlbF9kcC0+cHNyLnBpcGUpOw0KPiA+ICsJCWludGVs
X2RwLT5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzIHw9DQo+ID4gZnJvbnRidWZmZXJfYml0czsN
Cj4gPiAgDQo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gLX0N
Cj4gPiArCQlpZiAoZnJvbnRidWZmZXJfYml0cykNCj4gPiArCQkJaW50ZWxfcHNyX2V4aXQoaW50
ZWxfZHApOw0KPiA+ICANCj4gPiArCQltdXRleF91bmxvY2soJmludGVsX2RwLT5wc3IubG9jayk7
DQo+ID4gKwl9DQo+ID4gK30NCj4gPiAgLyoNCj4gPiAgICogV2hlbiB3ZSB3aWxsIGJlIGNvbXBs
ZXRlbHkgcmVseSBvbiBQU1IyIFMvVyB0cmFja2luZyBpbiBmdXR1cmUsDQo+ID4gICAqIGludGVs
X3Bzcl9mbHVzaCgpIHdpbGwgaW52YWxpZGF0ZSBhbmQgZmx1c2ggdGhlIFBTUiBmb3INCj4gPiBP
UklHSU5fRkxJUA0KPiA+IEBAIC0xNjE2LDE1ICsxNjQ3LDE1IEBAIHZvaWQgaW50ZWxfcHNyX2lu
dmFsaWRhdGUoc3RydWN0DQo+ID4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gICAq
IGFjY29yZGluZ2x5IGluIGZ1dHVyZS4NCj4gPiAgICovDQo+ID4gIHN0YXRpYyB2b2lkDQo+ID4g
LXRnbF9kYzNjb19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4g
LQkJdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMsIGVudW0gZmJfb3Bfb3JpZ2luDQo+ID4g
b3JpZ2luKQ0KPiA+ICt0Z2xfZGMzY29fZmx1c2goc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwg
dW5zaWduZWQgaW50DQo+ID4gZnJvbnRidWZmZXJfYml0cywNCj4gPiArCQllbnVtIGZiX29wX29y
aWdpbiBvcmlnaW4pDQo+ID4gIHsNCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9j
ayk7DQo+ID4gKwltdXRleF9sb2NrKCZpbnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICANCj4gPiAt
CWlmICghZGV2X3ByaXYtPnBzci5kYzNjb19lbmFibGVkKQ0KPiA+ICsJaWYgKCFpbnRlbF9kcC0+
cHNyLmRjM2NvX2VuYWJsZWQpDQo+ID4gIAkJZ290byB1bmxvY2s7DQo+ID4gIA0KPiA+IC0JaWYg
KCFkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCB8fCAhZGV2X3ByaXYtPnBzci5hY3RpdmUpDQo+
ID4gKwlpZiAoIWludGVsX2RwLT5wc3IucHNyMl9lbmFibGVkIHx8ICFpbnRlbF9kcC0+cHNyLmFj
dGl2ZSkNCj4gPiAgCQlnb3RvIHVubG9jazsNCj4gPiAgDQo+ID4gIAkvKg0KPiA+IEBAIC0xNjMy
LDE1ICsxNjYzLDE1IEBAIHRnbF9kYzNjb19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0K
PiA+ICpkZXZfcHJpdiwNCj4gPiAgCSAqIHdoZW4gZGVsYXllZCB3b3JrIHNjaGVkdWxlcyB0aGF0
IG1lYW5zIGRpc3BsYXkgaGFzIGJlZW4NCj4gPiBpZGxlLg0KPiA+ICAJICovDQo+ID4gIAlpZiAo
IShmcm9udGJ1ZmZlcl9iaXRzICYNCj4gPiAtCSAgICBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFT
SyhkZXZfcHJpdi0+cHNyLnBpcGUpKSkNCj4gPiArCSAgICBJTlRFTF9GUk9OVEJVRkZFUl9BTExf
TUFTSyhpbnRlbF9kcC0+cHNyLnBpcGUpKSkNCj4gPiAgCQlnb3RvIHVubG9jazsNCj4gPiAgDQo+
ID4gLQl0Z2xfcHNyMl9lbmFibGVfZGMzY28oZGV2X3ByaXYpOw0KPiA+IC0JbW9kX2RlbGF5ZWRf
d29yayhzeXN0ZW1fd3EsICZkZXZfcHJpdi0+cHNyLmRjM2NvX3dvcmssDQo+ID4gLQkJCSBkZXZf
cHJpdi0+cHNyLmRjM2NvX2V4aXRfZGVsYXkpOw0KPiA+ICsJdGdsX3BzcjJfZW5hYmxlX2RjM2Nv
KGludGVsX2RwKTsNCj4gPiArCW1vZF9kZWxheWVkX3dvcmsoc3lzdGVtX3dxLCAmaW50ZWxfZHAt
PnBzci5kYzNjb193b3JrLA0KPiA+ICsJCQkgaW50ZWxfZHAtPnBzci5kYzNjb19leGl0X2RlbGF5
KTsNCj4gPiAgDQo+ID4gIHVubG9jazoNCj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBz
ci5sb2NrKTsNCj4gPiArCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAg
fQ0KPiA+ICANCj4gPiAgLyoqDQo+ID4gQEAgLTE2NTksNDUgKzE2OTAsNTQgQEAgdGdsX2RjM2Nv
X2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlDQo+ID4gKmRldl9wcml2LA0KPiA+ICB2b2lk
IGludGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4g
IAkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzLCBlbnVtIGZiX29wX29yaWdpbg0KPiA+
IG9yaWdpbikNCj4gPiAgew0KPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkNCj4gPiAtCQly
ZXR1cm47DQo+ID4gLQ0KPiA+IC0JaWYgKG9yaWdpbiA9PSBPUklHSU5fRkxJUCkgew0KPiA+IC0J
CXRnbF9kYzNjb19mbHVzaChkZXZfcHJpdiwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsNCj4g
PiAtCQlyZXR1cm47DQo+ID4gLQl9DQo+ID4gLQ0KPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYt
PnBzci5sb2NrKTsNCj4gPiAtCWlmICghZGV2X3ByaXYtPnBzci5lbmFibGVkKSB7DQo+ID4gLQkJ
bXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOw0KPiA+IC0JCXJldHVybjsNCj4gPiAr
CXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOw0KPiA+ICsJc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcDsNCj4gPiArDQo+ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRybSwg
ZW5jb2Rlcikgew0KPiA+ICsJCWludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0K
PiA+ICsNCj4gPiArCQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQICYmDQo+
ID4gQ0FOX1BTUihpbnRlbF9kcCkpIHsNCj4gPiArCQkJaWYgKG9yaWdpbiA9PSBPUklHSU5fRkxJ
UCkgew0KPiA+ICsJCQkJdGdsX2RjM2NvX2ZsdXNoKGludGVsX2RwLA0KPiA+IGZyb250YnVmZmVy
X2JpdHMsIG9yaWdpbik7DQo+ID4gKwkJCQljb250aW51ZTsNCj4gPiArCQkJfQ0KPiA+ICsNCj4g
PiArCQkJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiArCQkJaWYgKCFpbnRl
bF9kcC0+cHNyLmVuYWJsZWQpIHsNCj4gPiArCQkJCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBz
ci5sb2NrKTsNCj4gPiArCQkJCWNvbnRpbnVlOw0KPiA+ICsJCQl9DQo+ID4gKw0KPiA+ICsJCQlm
cm9udGJ1ZmZlcl9iaXRzICY9DQo+ID4gSU5URUxfRlJPTlRCVUZGRVJfQUxMX01BU0soaW50ZWxf
ZHAtPnBzci5waXBlKTsNCj4gPiArCQkJaW50ZWxfZHAtPnBzci5idXN5X2Zyb250YnVmZmVyX2Jp
dHMgJj0NCj4gPiB+ZnJvbnRidWZmZXJfYml0czsNCj4gPiArDQo+ID4gKwkJCS8qIEJ5IGRlZmlu
aXRpb24gZmx1c2ggPSBpbnZhbGlkYXRlICsgZmx1c2ggKi8NCj4gPiArCQkJaWYgKGZyb250YnVm
ZmVyX2JpdHMpDQo+ID4gKwkJCQlwc3JfZm9yY2VfaHdfdHJhY2tpbmdfZXhpdChpbnRlbF9kcCk7
DQo+ID4gKw0KPiA+ICsJCQlpZiAoIWludGVsX2RwLT5wc3IuYWN0aXZlICYmICFpbnRlbF9kcC0N
Cj4gPiA+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cykNCj4gPiArCQkJCXNjaGVkdWxlX3dvcmso
JmludGVsX2RwLT5wc3Iud29yayk7DQo+ID4gKwkJCW11dGV4X3VubG9jaygmaW50ZWxfZHAtPnBz
ci5sb2NrKTsNCj4gPiArCQl9DQo+ID4gIAl9DQo+ID4gLQ0KPiA+IC0JZnJvbnRidWZmZXJfYml0
cyAmPSBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFTSyhkZXZfcHJpdi0NCj4gPiA+cHNyLnBpcGUp
Ow0KPiA+IC0JZGV2X3ByaXYtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgJj0gfmZyb250YnVm
ZmVyX2JpdHM7DQo+ID4gLQ0KPiA+IC0JLyogQnkgZGVmaW5pdGlvbiBmbHVzaCA9IGludmFsaWRh
dGUgKyBmbHVzaCAqLw0KPiA+IC0JaWYgKGZyb250YnVmZmVyX2JpdHMpDQo+ID4gLQkJcHNyX2Zv
cmNlX2h3X3RyYWNraW5nX2V4aXQoZGV2X3ByaXYpOw0KPiA+IC0NCj4gPiAtCWlmICghZGV2X3By
aXYtPnBzci5hY3RpdmUgJiYgIWRldl9wcml2LQ0KPiA+ID5wc3IuYnVzeV9mcm9udGJ1ZmZlcl9i
aXRzKQ0KPiA+IC0JCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5wc3Iud29yayk7DQo+ID4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7DQo+ID4gIH0NCj4gPiAgDQo+ID4gIC8q
Kg0KPiA+ICAgKiBpbnRlbF9wc3JfaW5pdCAtIEluaXQgYmFzaWMgUFNSIHdvcmsgYW5kIG11dGV4
Lg0KPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIHByaXZhdGUNCj4gPiArICogQGludGVs
X2RwOiBJbnRlbCBEUA0KPiA+ICAgKg0KPiA+IC0gKiBUaGlzIGZ1bmN0aW9uIGlzICBjYWxsZWQg
b25seSBvbmNlIGF0IGRyaXZlciBsb2FkIHRvIGluaXRpYWxpemUNCj4gPiBiYXNpYw0KPiA+IC0g
KiBQU1Igc3R1ZmYuDQo+ID4gKyAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGFmdGVyIHRoZSBp
bml0aWFsaXppbmcgY29ubmVjdG9yLg0KPiA+ICsgKiAodGhlIGluaXRpYWxpemluZyBvZiBjb25u
ZWN0b3IgdHJlYXRzIHRoZSBoYW5kbGluZyBvZiBjb25uZWN0b3INCj4gPiBjYXBhYmlsaXRpZXMp
DQo+ID4gKyAqIEFuZCBpdCBpbml0aWFsaXplcyBiYXNpYyBQU1Igc3R1ZmYgZm9yIGVhY2ggRFAg
RW5jb2Rlci4NCj4gPiAgICovDQo+ID4gLXZvaWQgaW50ZWxfcHNyX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQ0KPiA+ICt2b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICsNCj4gPiAgCWlmICghSEFT
X1BTUihkZXZfcHJpdikpDQo+ID4gIAkJcmV0dXJuOw0KPiA+ICANCj4gPiAtCWlmICghZGV2X3By
aXYtPnBzci5zaW5rX3N1cHBvcnQpDQo+ID4gKwlpZiAoIWludGVsX2RwLT5wc3Iuc2lua19zdXBw
b3J0KQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJp
dikpDQo+ID4gQEAgLTE3MTUsMTQgKzE3NTUsMTQgQEAgdm9pZCBpbnRlbF9wc3JfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZQ0KPiA+ICpkZXZfcHJpdikNCj4gPiAgCS8qIFNldCBsaW5rX3N0
YW5kYnkgeCBsaW5rX29mZiBkZWZhdWx0cyAqLw0KPiA+ICAJaWYgKElTX0hBU1dFTEwoZGV2X3By
aXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpDQo+ID4gIAkJLyogSFNXIGFuZCBCRFcgcmVx
dWlyZSB3b3JrYXJvdW5kcyB0aGF0IHdlIGRvbid0DQo+ID4gaW1wbGVtZW50LiAqLw0KPiA+IC0J
CWRldl9wcml2LT5wc3IubGlua19zdGFuZGJ5ID0gZmFsc2U7DQo+ID4gKwkJaW50ZWxfZHAtPnBz
ci5saW5rX3N0YW5kYnkgPSBmYWxzZTsNCj4gPiAgCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPCAxMikNCj4gPiAgCQkvKiBGb3IgbmV3IHBsYXRmb3JtcyB1cCB0byBUR0wgbGV0J3MgcmVz
cGVjdCBWQlQgYmFjaw0KPiA+IGFnYWluICovDQo+ID4gLQkJZGV2X3ByaXYtPnBzci5saW5rX3N0
YW5kYnkgPSBkZXZfcHJpdi0NCj4gPiA+dmJ0LnBzci5mdWxsX2xpbms7DQo+ID4gKwkJaW50ZWxf
ZHAtPnBzci5saW5rX3N0YW5kYnkgPSBkZXZfcHJpdi0NCj4gPiA+dmJ0LnBzci5mdWxsX2xpbms7
DQo+ID4gIA0KPiA+IC0JSU5JVF9XT1JLKCZkZXZfcHJpdi0+cHNyLndvcmssIGludGVsX3Bzcl93
b3JrKTsNCj4gPiAtCUlOSVRfREVMQVlFRF9XT1JLKCZkZXZfcHJpdi0+cHNyLmRjM2NvX3dvcmss
DQo+ID4gdGdsX2RjM2NvX2Rpc2FibGVfd29yayk7DQo+ID4gLQltdXRleF9pbml0KCZkZXZfcHJp
di0+cHNyLmxvY2spOw0KPiA+ICsJSU5JVF9XT1JLKCZpbnRlbF9kcC0+cHNyLndvcmssIGludGVs
X3Bzcl93b3JrKTsNCj4gPiArCUlOSVRfREVMQVlFRF9XT1JLKCZpbnRlbF9kcC0+cHNyLmRjM2Nv
X3dvcmssDQo+ID4gdGdsX2RjM2NvX2Rpc2FibGVfd29yayk7DQo+ID4gKwltdXRleF9pbml0KCZp
bnRlbF9kcC0+cHNyLmxvY2spOw0KPiA+ICB9DQo+ID4gIA0KPiA+ICBzdGF0aWMgaW50IHBzcl9n
ZXRfc3RhdHVzX2FuZF9lcnJvcl9zdGF0dXMoc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2Rw
LA0KPiA+IEBAIC0xNzQ4LDcgKzE3ODgsNyBAQCBzdGF0aWMgdm9pZCBwc3JfYWxwbV9jaGVjayhz
dHJ1Y3QgaW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAgCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJc3Ry
dWN0IGRybV9kcF9hdXggKmF1eCA9ICZpbnRlbF9kcC0+YXV4Ow0KPiA+IC0Jc3RydWN0IGk5MTVf
cHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsNCj4gPiArCXN0cnVjdCBpbnRlbF9wc3IgKnBzciA9
ICZpbnRlbF9kcC0+cHNyOw0KPiA+ICAJdTggdmFsOw0KPiA+ICAJaW50IHI7DQo+ID4gIA0KPiA+
IEBAIC0xNzc1LDcgKzE4MTUsNyBAQCBzdGF0aWMgdm9pZCBwc3JfYWxwbV9jaGVjayhzdHJ1Y3Qg
aW50ZWxfZHANCj4gPiAqaW50ZWxfZHApDQo+ID4gIHN0YXRpYyB2b2lkIHBzcl9jYXBhYmlsaXR5
X2NoYW5nZWRfY2hlY2soc3RydWN0IGludGVsX2RwDQo+ID4gKmludGVsX2RwKQ0KPiA+ICB7DQo+
ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVs
X2RwKTsNCj4gPiAtCXN0cnVjdCBpOTE1X3BzciAqcHNyID0gJmRldl9wcml2LT5wc3I7DQo+ID4g
KwlzdHJ1Y3QgaW50ZWxfcHNyICpwc3IgPSAmaW50ZWxfZHAtPnBzcjsNCj4gPiAgCXU4IHZhbDsN
Cj4gPiAgCWludCByOw0KPiA+ICANCj4gPiBAQCAtMTc5OSwxOCArMTgzOSwxOCBAQCBzdGF0aWMg
dm9pZA0KPiA+IHBzcl9jYXBhYmlsaXR5X2NoYW5nZWRfY2hlY2soc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkNCj4gPiAgdm9pZCBpbnRlbF9wc3Jfc2hvcnRfcHVsc2Uoc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCkNCj4gPiAgew0KPiA+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7DQo+ID4gLQlzdHJ1Y3QgaTkxNV9wc3IgKnBzciA9
ICZkZXZfcHJpdi0+cHNyOw0KPiA+ICsJc3RydWN0IGludGVsX3BzciAqcHNyID0gJmludGVsX2Rw
LT5wc3I7DQo+ID4gIAl1OCBzdGF0dXMsIGVycm9yX3N0YXR1czsNCj4gPiAgCWNvbnN0IHU4IGVy
cm9ycyA9IERQX1BTUl9SRkJfU1RPUkFHRV9FUlJPUiB8DQo+ID4gIAkJCSAgRFBfUFNSX1ZTQ19T
RFBfVU5DT1JSRUNUQUJMRV9FUlJPUiB8DQo+ID4gIAkJCSAgRFBfUFNSX0xJTktfQ1JDX0VSUk9S
Ow0KPiA+ICANCj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikgfHwgIWludGVsX2RwX2lzX2Vk
cChpbnRlbF9kcCkpDQo+ID4gKwlpZiAoIUNBTl9QU1IoaW50ZWxfZHApIHx8ICFpbnRlbF9kcF9p
c19lZHAoaW50ZWxfZHApKQ0KPiA+ICAJCXJldHVybjsNCj4gPiAgDQo+ID4gIAltdXRleF9sb2Nr
KCZwc3ItPmxvY2spOw0KPiA+ICANCj4gPiAtCWlmICghcHNyLT5lbmFibGVkIHx8IHBzci0+ZHAg
IT0gaW50ZWxfZHApDQo+ID4gKwlpZiAoIXBzci0+ZW5hYmxlZCkNCj4gPiAgCQlnb3RvIGV4aXQ7
DQo+ID4gIA0KPiA+ICAJaWYgKHBzcl9nZXRfc3RhdHVzX2FuZF9lcnJvcl9zdGF0dXMoaW50ZWxf
ZHAsICZzdGF0dXMsDQo+ID4gJmVycm9yX3N0YXR1cykpIHsNCj4gPiBAQCAtMTg1MywxNSArMTg5
MywxNCBAQCB2b2lkIGludGVsX3Bzcl9zaG9ydF9wdWxzZShzdHJ1Y3QgaW50ZWxfZHANCj4gPiAq
aW50ZWxfZHApDQo+ID4gIA0KPiA+ICBib29sIGludGVsX3Bzcl9lbmFibGVkKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHApDQo+ID4gIHsNCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOw0KPiA+ICAJYm9vbCByZXQ7DQo+ID4gIA0K
PiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSB8fCAhaW50ZWxfZHBfaXNfZWRwKGludGVsX2Rw
KSkNCj4gPiArCWlmICghQ0FOX1BTUihpbnRlbF9kcCkgfHwgIWludGVsX2RwX2lzX2VkcChpbnRl
bF9kcCkpDQo+ID4gIAkJcmV0dXJuIGZhbHNlOw0KPiA+ICANCj4gPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT5wc3IubG9jayk7DQo+ID4gLQlyZXQgPSAoZGV2X3ByaXYtPnBzci5kcCA9PSBpbnRl
bF9kcCAmJiBkZXZfcHJpdi0+cHNyLmVuYWJsZWQpOw0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+cHNyLmxvY2spOw0KPiA+ICsJbXV0ZXhfbG9jaygmaW50ZWxfZHAtPnBzci5sb2NrKTsN
Cj4gPiArCXJldCA9IGludGVsX2RwLT5wc3IuZW5hYmxlZDsNCj4gPiArCW11dGV4X3VubG9jaygm
aW50ZWxfZHAtPnBzci5sb2NrKTsNCj4gPiAgDQo+ID4gIAlyZXR1cm4gcmV0Ow0KPiA+ICB9DQo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmgN
Cj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcHNyLmgNCj4gPiBpbmRl
eCAwYTUxNzk3OGU4YWYuLjAzZWIxOTU0N2QwOSAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5oDQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuaA0KPiA+IEBAIC0xOCw3ICsxOCw3IEBAIHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGU7DQo+ID4gIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZTsNCj4gPiAg
c3RydWN0IGludGVsX3BsYW5lOw0KPiA+ICANCj4gPiAtI2RlZmluZSBDQU5fUFNSKGRldl9wcml2
KSAoSEFTX1BTUihkZXZfcHJpdikgJiYgZGV2X3ByaXYtDQo+ID4gPnBzci5zaW5rX3N1cHBvcnQp
DQo+ID4gKyNkZWZpbmUgQ0FOX1BTUihpbnRlbF9kcCkgKEhBU19QU1IoZHBfdG9faTkxNShpbnRl
bF9kcCkpICYmDQo+ID4gaW50ZWxfZHAtPnBzci5zaW5rX3N1cHBvcnQpDQo+ID4gIHZvaWQgaW50
ZWxfcHNyX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAgdm9pZCBp
bnRlbF9wc3JfZW5hYmxlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsDQo+ID4gIAkJICAgICAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsDQo+ID4gQEAgLTI4LDI0
ICsyOCwyNCBAQCB2b2lkIGludGVsX3Bzcl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9kcA0KPiA+ICpp
bnRlbF9kcCwNCj4gPiAgdm9pZCBpbnRlbF9wc3JfdXBkYXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAsDQo+ID4gIAkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsDQo+ID4gIAkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGUpOw0KPiA+IC1pbnQgaW50ZWxfcHNyX2RlYnVnX3NldChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHU2NA0KPiA+IHZhbHVlKTsNCj4gPiAraW50IGludGVsX3Bzcl9k
ZWJ1Z19zZXQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgdTY0IHZhbHVlKTsNCj4gPiAgdm9p
ZCBpbnRlbF9wc3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
DQo+ID4gIAkJCSAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cywNCj4gPiAgCQkJICBlbnVtIGZi
X29wX29yaWdpbiBvcmlnaW4pOw0KPiA+ICB2b2lkIGludGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ID4gIAkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZl
cl9iaXRzLA0KPiA+ICAJCSAgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKTsNCj4gPiAtdm9p
ZCBpbnRlbF9wc3JfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOw0KPiA+
ICt2b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOw0KPiA+ICB2
b2lkIGludGVsX3Bzcl9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLA0K
PiA+ICAJCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7DQo+ID4g
LXZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdTMyDQo+ID4gcHNyX2lpcik7DQo+ID4gK3ZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVy
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHUzMg0KPiA+IHBzcl9paXIpOw0KPiA+ICB2b2lk
IGludGVsX3Bzcl9zaG9ydF9wdWxzZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAt
aW50IGludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
DQo+ID4gKm5ld19jcnRjX3N0YXRlLA0KPiA+IC0JCQkgICAgdTMyICpvdXRfdmFsdWUpOw0KPiA+
ICt2b2lkIGludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlDQo+ID4gKm5ld19jcnRjX3N0YXRlKTsNCj4gPiAgYm9vbCBpbnRlbF9wc3JfZW5hYmxlZChz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsNCj4gPiAgaW50IGludGVsX3BzcjJfc2VsX2ZldGNo
X3VwZGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwNCj4gPiAgCQkJCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjKTsNCj4gPiAtdm9pZCBpbnRlbF9wc3IyX3Byb2dyYW1fdHJhbnNf
bWFuX3Rya19jdGwoY29uc3Qgc3RydWN0DQo+ID4gaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSk7DQo+ID4gK3ZvaWQgaW50ZWxfcHNyMl9wcm9ncmFtX3RyYW5zX21hbl90cmtfY3RsKHN0cnVj
dCBpbnRlbF9kcA0KPiA+ICppbnRlbF9kcCwNCj4gPiArCQkJCQkgIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlDQo+ID4gKmNydGNfc3RhdGUpOw0KPiA+ICB2b2lkIGludGVsX3BzcjJfcHJv
Z3JhbV9wbGFuZV9zZWxfZmV0Y2goc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwNCj4gPiAgCQkJ
CQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiA+ICpjcnRjX3N0YXRlLA0KPiA+ICAJ
CQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZQ0KPiA+ICpwbGFuZV9zdGF0ZSwNCj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUu
Yw0KPiA+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYw0KPiA+
IGluZGV4IGI2ZGVlYjMzODQ3Ny4uY2NkODZmMTY4MzU3IDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMNCj4gPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jDQo+ID4gQEAgLTkyLDcgKzkyLDYg
QEAgdm9pZCBpbnRlbF9waXBlX3VwZGF0ZV9zdGFydChjb25zdCBzdHJ1Y3QNCj4gPiBpbnRlbF9j
cnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkNCj4gPiAgCWJvb2wgbmVlZF92bHZfZHNpX3dhID0g
KElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8DQo+ID4gSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
ICYmDQo+ID4gIAkJaW50ZWxfY3J0Y19oYXNfdHlwZShuZXdfY3J0Y19zdGF0ZSwgSU5URUxfT1VU
UFVUX0RTSSk7DQo+ID4gIAlERUZJTkVfV0FJVCh3YWl0KTsNCj4gPiAtCXUzMiBwc3Jfc3RhdHVz
Ow0KPiA+ICANCj4gPiAgCWlmIChuZXdfY3J0Y19zdGF0ZS0+dWFwaS5hc3luY19mbGlwKQ0KPiA+
ICAJCXJldHVybjsNCj4gPiBAQCAtMTE3LDEwICsxMTYsNyBAQCB2b2lkIGludGVsX3BpcGVfdXBk
YXRlX3N0YXJ0KGNvbnN0IHN0cnVjdA0KPiA+IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0
YXRlKQ0KPiA+ICAJICogVkJMIGludGVycnVwdHMgd2lsbCBzdGFydCB0aGUgUFNSIGV4aXQgYW5k
IHByZXZlbnQgYSBQU1INCj4gPiAgCSAqIHJlLWVudHJ5IGFzIHdlbGwuDQo+ID4gIAkgKi8NCj4g
PiAtCWlmIChpbnRlbF9wc3Jfd2FpdF9mb3JfaWRsZShuZXdfY3J0Y19zdGF0ZSwgJnBzcl9zdGF0
dXMpKQ0KPiA+IC0JCWRybV9lcnIoJmRldl9wcml2LT5kcm0sDQo+ID4gLQkJCSJQU1IgaWRsZSB0
aW1lZCBvdXQgMHgleCwgYXRvbWljIHVwZGF0ZSBtYXkNCj4gPiBmYWlsXG4iLA0KPiA+IC0JCQlw
c3Jfc3RhdHVzKTsNCj4gPiArCWludGVsX3Bzcl93YWl0X2Zvcl9pZGxlKG5ld19jcnRjX3N0YXRl
KTsNCj4gPiAgDQo+ID4gIAlsb2NhbF9pcnFfZGlzYWJsZSgpOw0KPiA+ICANCj4gPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaA0KPiA+IGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kcnYuaA0KPiA+IGluZGV4IDE1YmU4ZGViYWU1NC4uNWE0MDI5NTI2MGMy
IDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgNCj4gPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oDQo+ID4gQEAgLTQ3NSw0MiArNDc1
LDYgQEAgc3RydWN0IGk5MTVfZHJycyB7DQo+ID4gIAllbnVtIGRycnNfc3VwcG9ydF90eXBlIHR5
cGU7DQo+ID4gIH07DQo+ID4gIA0KPiA+IC1zdHJ1Y3QgaTkxNV9wc3Igew0KPiA+IC0Jc3RydWN0
IG11dGV4IGxvY2s7DQo+ID4gLQ0KPiA+IC0jZGVmaW5lIEk5MTVfUFNSX0RFQlVHX01PREVfTUFT
SwkweDBmDQo+ID4gLSNkZWZpbmUgSTkxNV9QU1JfREVCVUdfREVGQVVMVAkJMHgwMA0KPiA+IC0j
ZGVmaW5lIEk5MTVfUFNSX0RFQlVHX0RJU0FCTEUJCTB4MDENCj4gPiAtI2RlZmluZSBJOTE1X1BT
Ul9ERUJVR19FTkFCTEUJCTB4MDINCj4gPiAtI2RlZmluZSBJOTE1X1BTUl9ERUJVR19GT1JDRV9Q
U1IxCTB4MDMNCj4gPiAtI2RlZmluZSBJOTE1X1BTUl9ERUJVR19JUlEJCTB4MTANCj4gPiAtDQo+
ID4gLQl1MzIgZGVidWc7DQo+ID4gLQlib29sIHNpbmtfc3VwcG9ydDsNCj4gPiAtCWJvb2wgZW5h
YmxlZDsNCj4gPiAtCXN0cnVjdCBpbnRlbF9kcCAqZHA7DQo+ID4gLQllbnVtIHBpcGUgcGlwZTsN
Cj4gPiAtCWVudW0gdHJhbnNjb2RlciB0cmFuc2NvZGVyOw0KPiA+IC0JYm9vbCBhY3RpdmU7DQo+
ID4gLQlzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd29yazsNCj4gPiAtCXVuc2lnbmVkIGJ1c3lfZnJvbnRi
dWZmZXJfYml0czsNCj4gPiAtCWJvb2wgc2lua19wc3IyX3N1cHBvcnQ7DQo+ID4gLQlib29sIGxp
bmtfc3RhbmRieTsNCj4gPiAtCWJvb2wgY29sb3JpbWV0cnlfc3VwcG9ydDsNCj4gPiAtCWJvb2wg
cHNyMl9lbmFibGVkOw0KPiA+IC0JYm9vbCBwc3IyX3NlbF9mZXRjaF9lbmFibGVkOw0KPiA+IC0J
dTggc2lua19zeW5jX2xhdGVuY3k7DQo+ID4gLQlrdGltZV90IGxhc3RfZW50cnlfYXR0ZW1wdDsN
Cj4gPiAtCWt0aW1lX3QgbGFzdF9leGl0Ow0KPiA+IC0JYm9vbCBzaW5rX25vdF9yZWxpYWJsZTsN
Cj4gPiAtCWJvb2wgaXJxX2F1eF9lcnJvcjsNCj4gPiAtCXUxNiBzdV94X2dyYW51bGFyaXR5Ow0K
PiA+IC0JYm9vbCBkYzNjb19lbmFibGVkOw0KPiA+IC0JdTMyIGRjM2NvX2V4aXRfZGVsYXk7DQo+
ID4gLQlzdHJ1Y3QgZGVsYXllZF93b3JrIGRjM2NvX3dvcms7DQo+ID4gLQlzdHJ1Y3QgZHJtX2Rw
X3ZzY19zZHAgdnNjOw0KPiA+IC19Ow0KPiA+IC0NCj4gPiAgI2RlZmluZSBRVUlSS19MVkRTX1NT
Q19ESVNBQkxFICgxPDwxKQ0KPiA+ICAjZGVmaW5lIFFVSVJLX0lOVkVSVF9CUklHSFRORVNTICgx
PDwyKQ0KPiA+ICAjZGVmaW5lIFFVSVJLX0JBQ0tMSUdIVF9QUkVTRU5UICgxPDwzKQ0KPiA+IEBA
IC0xMDQxLDggKzEwMDUsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7DQo+ID4gIA0KPiA+
ICAJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyBwb3dlcl9kb21haW5zOw0KPiA+ICANCj4gPiAt
CXN0cnVjdCBpOTE1X3BzciBwc3I7DQo+ID4gLQ0KPiA+ICAJc3RydWN0IGk5MTVfZ3B1X2Vycm9y
IGdwdV9lcnJvcjsNCj4gPiAgDQo+ID4gIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqdmx2
X3BjdHg7DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMN
Cj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMNCj4gPiBpbmRleCBlMGViMzJi
ZDk2MDcuLjZkNDMyOThjNDZkZCAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2lycS5jDQo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYw0K
PiA+IEBAIC0yMDU3LDEwICsyMDU3LDIwIEBAIHN0YXRpYyB2b2lkIGl2Yl9kaXNwbGF5X2lycV9o
YW5kbGVyKHN0cnVjdA0KPiA+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LA0KPiA+ICAJCWl2
Yl9lcnJfaW50X2hhbmRsZXIoZGV2X3ByaXYpOw0KPiA+ICANCj4gPiAgCWlmIChkZV9paXIgJiBE
RV9FRFBfUFNSX0lOVF9IU1cpIHsNCj4gPiAtCQl1MzIgcHNyX2lpciA9IEk5MTVfUkVBRChFRFBf
UFNSX0lJUik7DQo+ID4gKwkJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7DQo+ID4gIA0K
PiA+IC0JCWludGVsX3Bzcl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcHNyX2lpcik7DQo+ID4gLQkJ
STkxNV9XUklURShFRFBfUFNSX0lJUiwgcHNyX2lpcik7DQo+ID4gKwkJZm9yX2VhY2hfaW50ZWxf
ZHAoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiArCQkJc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCA9DQo+ID4gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+ICsNCj4gPiArCQkJ
aWYgKGVuY29kZXItPnR5cGUgPT0gSU5URUxfT1VUUFVUX0VEUCAmJg0KPiA+ICsJCQkgICAgQ0FO
X1BTUihpbnRlbF9kcCkpIHsNCj4gPiArCQkJCXUzMiBwc3JfaWlyID0gSTkxNV9SRUFEKEVEUF9Q
U1JfSUlSKTsNCj4gPiArDQo+ID4gKwkJCQlpbnRlbF9wc3JfaXJxX2hhbmRsZXIoaW50ZWxfZHAs
DQo+ID4gcHNyX2lpcik7DQo+ID4gKwkJCQlJOTE1X1dSSVRFKEVEUF9QU1JfSUlSLCBwc3JfaWly
KTsNCj4gPiArCQkJCWJyZWFrOw0KPiA+ICsJCQl9DQo+ID4gKwkJfQ0KPiA+ICAJfQ0KPiA+ICAN
Cj4gPiAgCWlmIChkZV9paXIgJiBERV9BVVhfQ0hBTk5FTF9BX0lWQikNCj4gPiBAQCAtMjI2OCwy
MSArMjI3OCwzNCBAQCBnZW44X2RlX21pc2NfaXJxX2hhbmRsZXIoc3RydWN0DQo+ID4gZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBpaXIpDQo+ID4gIAl9DQo+ID4gIA0KPiA+ICAJaWYg
KGlpciAmIEdFTjhfREVfRURQX1BTUikgew0KPiA+ICsJCXN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyOw0KPiA+ICAJCXUzMiBwc3JfaWlyOw0KPiA+ICAJCWk5MTVfcmVnX3QgaWlyX3JlZzsN
Cj4gPiAgDQo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIpDQo+ID4gLQkJCWlp
cl9yZWcgPSBUUkFOU19QU1JfSUlSKGRldl9wcml2LQ0KPiA+ID5wc3IudHJhbnNjb2Rlcik7DQo+
ID4gLQkJZWxzZQ0KPiA+IC0JCQlpaXJfcmVnID0gRURQX1BTUl9JSVI7DQo+ID4gKwkJZm9yX2Vh
Y2hfaW50ZWxfZHAoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsNCj4gPiArCQkJc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCA9DQo+ID4gZW5jX3RvX2ludGVsX2RwKGVuY29kZXIpOw0KPiA+ICAN
Cj4gPiAtCQlwc3JfaWlyID0gSTkxNV9SRUFEKGlpcl9yZWcpOw0KPiA+IC0JCUk5MTVfV1JJVEUo
aWlyX3JlZywgcHNyX2lpcik7DQo+ID4gKwkJCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEy
ICYmDQo+ID4gQ0FOX1BTUihpbnRlbF9kcCkpIHsNCj4gPiArCQkJCWlpcl9yZWcgPSBUUkFOU19Q
U1JfSUlSKGludGVsX2RwLQ0KPiA+ID5wc3IudHJhbnNjb2Rlcik7DQo+ID4gKwkJCX0gZWxzZSBp
ZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQICYmDQo+ID4gKwkJCQkgICBDQU5f
UFNSKGludGVsX2RwKSkgew0KPiA+ICsJCQkJaWlyX3JlZyA9IEVEUF9QU1JfSUlSOw0KPiA+ICsJ
CQl9IGVsc2Ugew0KPiA+ICsJCQkJY29udGludWU7DQo+ID4gKwkJCX0NCj4gPiArDQo+ID4gKwkJ
CXBzcl9paXIgPSBJOTE1X1JFQUQoaWlyX3JlZyk7DQo+ID4gKwkJCUk5MTVfV1JJVEUoaWlyX3Jl
ZywgcHNyX2lpcik7DQo+ID4gKw0KPiA+ICsJCQlpZiAocHNyX2lpcikNCj4gPiArCQkJCWZvdW5k
ID0gdHJ1ZTsNCj4gPiAgDQo+ID4gLQkJaWYgKHBzcl9paXIpDQo+ID4gLQkJCWZvdW5kID0gdHJ1
ZTsNCj4gPiArCQkJaW50ZWxfcHNyX2lycV9oYW5kbGVyKGludGVsX2RwLCBwc3JfaWlyKTsNCj4g
PiAgDQo+ID4gLQkJaW50ZWxfcHNyX2lycV9oYW5kbGVyKGRldl9wcml2LCBwc3JfaWlyKTsNCj4g
PiArCQkJLyogcHJpb3IgR0VOMTIgb25seSBoYXZlIG9uZSBFRFAgUFNSICovDQo+ID4gKwkJCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTIpDQo+ID4gKwkJCQlicmVhazsNCj4gPiArCQl9DQo+
ID4gIAl9DQo+ID4gIA0KPiA+ICAJaWYgKCFmb3VuZCkNCj4gPiAtLSANCj4gPiAyLjI1LjANCj4g
PiANCj4gPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0K
PiA+IEludGVsLWdmeCBtYWlsaW5nIGxpc3QNCj4gPiBJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnDQo+ID4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9pbnRlbC1nZngNCj4gPiANCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2lu
dGVsLWdmeAo=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1555145551
	for <lists+intel-gfx@lfdr.de>; Fri, 14 Jun 2019 09:10:53 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id ABE2A8936C;
	Fri, 14 Jun 2019 07:10:45 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C716289090
 for <intel-gfx@lists.freedesktop.org>; Fri, 14 Jun 2019 07:10:40 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16897522-1500050 
 for multiple; Fri, 14 Jun 2019 08:10:29 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 14 Jun 2019 08:10:01 +0100
Message-Id: <20190614071023.17929-18-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190614071023.17929-1-chris@chris-wilson.co.uk>
References: <20190614071023.17929-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 17/39] drm/i915: Make the semaphore saturation
 mask global
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Dmitry Ermilov <dmitry.ermilov@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIGlkZWEgYmVoaW5kIGtlZXBpbmcgdGhlIHNhdHVyYXRpb24gbWFzayBsb2NhbCB0byBhIGNv
bnRleHQgYmFja2ZpcmVkCnNwZWN0YWN1bGFybHkuIFRoZSBwcmVtaXNlIHdpdGggdGhlIGxvY2Fs
IG1hc2sgd2FzIHRoYXQgd2Ugd291bGQgYmUgbW9yZQpwcm9hY3RpdmUgaW4gYXR0ZW1wdGluZyB0
byB1c2Ugc2VtYXBob3JlcyBhZnRlciBlYWNoIHRpbWUgdGhlIGNvbnRleHQKaWRsZWQsIGFuZCB0
aGF0IGFsbCBuZXcgY29udGV4dHMgd291bGQgYXR0ZW1wdCB0byB1c2Ugc2VtYXBob3JlcwppZ25v
cmluZyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgc3lzdGVtLiBUaGlzIHR1cm5zIG91dCB0byBi
ZSBob3JyaWJseQpvcHRpbWlzdGljLiBJZiB0aGUgc3lzdGVtIHN0YXRlIGlzIHN0aWxsIG92ZXJz
YXR1cmF0ZWQgYW5kIHRoZSBleGlzdGluZwp3b3JrbG9hZHMgaGF2ZSBhbGwgc3RvcHBlZCB1c2lu
ZyBzZW1hcGhvcmVzLCB0aGUgbmV3IHdvcmtsb2FkcyB3b3VsZAphdHRlbXB0IHRvIHVzZSBzZW1h
cGhvcmVzIGFuZCBiZSBkZXByaW9yaXRpc2VkIGJlaGluZCByZWFsIHdvcmsuIFRoZQpuZXcgY29u
dGV4dHMgd291bGQgbm90IHN3aXRjaCBvZmYgdXNpbmcgc2VtYXBob3JlcyB1bnRpbCB0aGVpciBp
bml0aWFsCmJhdGNoIG9mIGxvdyBwcmlvcml0eSB3b3JrIGhhZCBjb21wbGV0ZWQuIEdpdmVuIHN1
ZmZpY2llbnQgYmFja2xvYWQgbG9hZApvZiBlcXVhbCB1c2VyIHByaW9yaXR5LCB0aGlzIHdvdWxk
IGNvbXBsZXRlbHkgc3RhcnZlIHRoZSBuZXcgd29yayBvZiBhbnkKR1BVIHRpbWUuCgpUbyBjb21w
ZW5zYXRlLCByZW1vdmUgdGhlIGxvY2FsIHRyYWNraW5nIGluIGZhdm91ciBvZiBrZWVwaW5nIGl0
IGFzCmdsb2JhbCBzdGF0ZSBvbiB0aGUgZW5naW5lIC0tIG9uY2UgdGhlIHN5c3RlbSBpcyBzYXR1
cmF0ZWQgYW5kCnNlbWFwaG9yZXMgYXJlIGRpc2FibGVkLCBldmVyeW9uZSBzdG9wcyBhdHRlbXB0
aW5nIHRvIHVzZSBzZW1hcGhvcmVzCnVudGlsIHRoZSBzeXN0ZW0gaXMgaWRsZSBhZ2Fpbi4gT25l
IG9mIHRoZSByZWFzb24gZm9yIHByZWZlcnJpbmcgbG9jYWwKY29udGV4dCB0cmFja2luZyB3YXMg
dGhhdCBpdCB3b3JrZWQgd2l0aCB2aXJ0dWFsIGVuZ2luZXMsIHNvIGZvcgpzd2l0Y2hpbmcgdG8g
Z2xvYmFsIHN0YXRlIHdlIGNvdWxkIGVpdGhlciBkbyBhIGNvbXBsZXRlIGNoZWNrIG9mIGFsbCB0
aGUKdmlydHVhbCBzaWJsaW5ncyBvciBzaW1wbHkgZGlzYWJsZSBzZW1hcGhvcmVzIGZvciB0aG9z
ZSByZXF1ZXN0cy4gVGhpcwp0YWtlcyB0aGUgc2ltcGxlciBhcHByb2FjaCBvZiBkaXNhYmxpbmcg
c2VtYXBob3JlcyBvbiB2aXJ0dWFsIGVuZ2luZXMuCgpUaGUgZG93bnNpZGUgaXMgdGhhdCB0aGUg
ZGVjaXNpb24gdGhhdCB0aGUgZW5naW5lIGlzIHNhdHVyYXRlZCBpcyBhCmxvY2FsIG1lYXN1cmUg
LS0gd2UgYXJlIG9ubHkgY2hlY2tpbmcgd2hldGhlciBvciBub3QgdGhpcyBjb250ZXh0IHdhcwpz
Y2hlZHVsZWQgaW4gYSB0aW1lbHkgZmFzaGlvbiwgaXQgbWF5IGJlIGxlZ2l0aW1hdGVseSBkZWxh
eWVkIGR1ZSB0byB1c2VyCnByaW9yaXRpZXMuIFdlIHN0aWxsIGhhdmUgdGhlIHNhbWUgZGlsZW1t
YSB0aG91Z2gsIHRoYXQgd2UgZG8gbm90IHdhbnQKdG8gZW1wbG95IHRoZSBzZW1hcGhvcmUgcG9s
bCB1bmxlc3MgaXQgd2lsbCBiZSB1c2VkLgoKRml4ZXM6IGNhNmU1NmY2NTRlNyAoImRybS9pOTE1
OiBEaXNhYmxlIHNlbWFwaG9yZSBidXN5d2FpdHMgb24gc2F0dXJhdGVkIHN5c3RlbXMiKQpTaWdu
ZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IFR2
cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+CkNjOiBEbWl0cnkgUm9nb3po
a2luIDxkbWl0cnkudi5yb2dvemhraW5AaW50ZWwuY29tPgpDYzogRG1pdHJ5IEVybWlsb3YgPGRt
aXRyeS5lcm1pbG92QGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9jb250ZXh0LmMgICAgICAgfCAyIC0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9j
b250ZXh0X3R5cGVzLmggfCAyIC0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdp
bmVfcG0uYyAgICAgfCAyICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
dHlwZXMuaCAgfCAyICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAg
ICAgICAgfCAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyAgICAgICAg
ICAgfCA0ICsrLS0KIDYgZmlsZXMgY2hhbmdlZCwgNyBpbnNlcnRpb25zKCspLCA3IGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRleCA4ZTI5OWM2
MzE1NzUuLjNkNjYwYzhjZTQxNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRl
eHQuYwpAQCAtMTQyLDcgKzE0Miw2IEBAIGludGVsX2NvbnRleHRfaW5pdChzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsCiAJY2UtPmVuZ2luZSA9IGVuZ2luZTsKIAljZS0+b3BzID0gZW5naW5lLT5j
b3BzOwogCWNlLT5zc2V1ID0gZW5naW5lLT5zc2V1OwotCWNlLT5zYXR1cmF0ZWQgPSAwOwogCiAJ
SU5JVF9MSVNUX0hFQUQoJmNlLT5zaWduYWxfbGluayk7CiAJSU5JVF9MSVNUX0hFQUQoJmNlLT5z
aWduYWxzKTsKQEAgLTIyMyw3ICsyMjIsNiBAQCB2b2lkIGludGVsX2NvbnRleHRfZW50ZXJfZW5n
aW5lKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIAogdm9pZCBpbnRlbF9jb250ZXh0X2V4aXRf
ZW5naW5lKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHsKLQljZS0+c2F0dXJhdGVkID0gMDsK
IAlpbnRlbF9lbmdpbmVfcG1fcHV0KGNlLT5lbmdpbmUpOwogfQogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmgKaW5kZXggYjU2NWMzZmY0Mzc4Li40YzBl
MjExYzcxNWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRl
eHRfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5
cGVzLmgKQEAgLTU4LDggKzU4LDYgQEAgc3RydWN0IGludGVsX2NvbnRleHQgewogCWF0b21pY190
IHBpbl9jb3VudDsKIAlzdHJ1Y3QgbXV0ZXggcGluX211dGV4OyAvKiBndWFyZHMgcGlubmluZyBh
bmQgYXNzb2NpYXRlZCBvbi1ncHVpbmcgKi8KIAotCWludGVsX2VuZ2luZV9tYXNrX3Qgc2F0dXJh
dGVkOyAvKiBzdWJtaXR0aW5nIHNlbWFwaG9yZXMgdG9vIGxhdGU/ICovCi0KIAkvKioKIAkgKiBh
Y3RpdmU6IEFjdGl2ZSB0cmFja2VyIGZvciB0aGUgcnEgYWN0aXZpdHkgKGluYy4gZXh0ZXJuYWwp
IG9uIHRoaXMKIAkgKiBpbnRlbF9jb250ZXh0IG9iamVjdC4KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX3BtLmMKaW5kZXggM2M0NDhhMDYxYWJkLi4yNTI4NzE0MGZiNjEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCkBAIC0xMDAsNiArMTAw
LDggQEAgc3RhdGljIGludCBfX2VuZ2luZV9wYXJrKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikK
IAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPQogCQljb250YWluZXJfb2Yod2YsIHR5
cGVvZigqZW5naW5lKSwgd2FrZXJlZik7CiAKKwllbmdpbmUtPnNhdHVyYXRlZCA9IDA7CisKIAkv
KgogCSAqIElmIG9uZSBhbmQgb25seSBvbmUgcmVxdWVzdCBpcyBjb21wbGV0ZWQgYmV0d2VlbiBw
bSBldmVudHMsCiAJICogd2Uga25vdyB0aGF0IHdlIGFyZSBpbnNpZGUgdGhlIGtlcm5lbCBjb250
ZXh0IGFuZCBpdCBpcwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlw
ZXMuaAppbmRleCAxMWEyNWYwNjBmZWQuLjFjYmUxMGEwZmVjNyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKQEAgLTI1OCw2ICsyNTgsOCBAQCBzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzIHsKIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqa2VybmVsX2NvbnRl
eHQ7IC8qIHBpbm5lZCAqLwogCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpwcmVlbXB0X2NvbnRleHQ7
IC8qIHBpbm5lZDsgb3B0aW9uYWwgKi8KIAorCWludGVsX2VuZ2luZV9tYXNrX3Qgc2F0dXJhdGVk
OyAvKiBzdWJtaXR0aW5nIHNlbWFwaG9yZXMgdG9vIGxhdGU/ICovCisKIAl1bnNpZ25lZCBsb25n
IHNlcmlhbDsKIAogCXVuc2lnbmVkIGxvbmcgd2FrZXJlZl9zZXJpYWw7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyYy5jCmluZGV4IDA1NjNmZTgzOThjNS4uYmJiZGM2MzkwNmM2IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMzE5OCw3ICszMTk4LDYgQEAgc3RhdGljIHZv
aWQgdmlydHVhbF9jb250ZXh0X2V4aXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQogCXN0cnVj
dCB2aXJ0dWFsX2VuZ2luZSAqdmUgPSBjb250YWluZXJfb2YoY2UsIHR5cGVvZigqdmUpLCBjb250
ZXh0KTsKIAl1bnNpZ25lZCBpbnQgbjsKIAotCWNlLT5zYXR1cmF0ZWQgPSAwOwogCWZvciAobiA9
IDA7IG4gPCB2ZS0+bnVtX3NpYmxpbmdzOyBuKyspCiAJCWludGVsX2VuZ2luZV9wbV9wdXQodmUt
PnNpYmxpbmdzW25dKTsKIH0KQEAgLTMzOTcsNiArMzM5Niw3IEBAIGludGVsX2V4ZWNsaXN0c19j
cmVhdGVfdmlydHVhbChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCXZlLT5iYXNlLnVh
YmlfY2xhc3MgPSBJOTE1X0VOR0lORV9DTEFTU19JTlZBTElEOwogCXZlLT5iYXNlLmluc3RhbmNl
ID0gSTkxNV9FTkdJTkVfQ0xBU1NfSU5WQUxJRF9WSVJUVUFMOwogCXZlLT5iYXNlLmZsYWdzID0g
STkxNV9FTkdJTkVfSVNfVklSVFVBTDsKKwl2ZS0+YmFzZS5zYXR1cmF0ZWQgPSBBTExfRU5HSU5F
UzsKIAogCXNucHJpbnRmKHZlLT5iYXNlLm5hbWUsIHNpemVvZih2ZS0+YmFzZS5uYW1lKSwgInZp
cnR1YWwiKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwppbmRleCBhODJmM2ZmODJi
MzkuLjg2NWI0OTkyOGZmOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9y
ZXF1ZXN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKQEAgLTQx
OCw3ICs0MTgsNyBAQCB2b2lkIF9faTkxNV9yZXF1ZXN0X3N1Ym1pdChzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpyZXF1ZXN0KQogCSAqLwogCWlmIChyZXF1ZXN0LT5zY2hlZC5zZW1hcGhvcmVzICYmCiAJ
ICAgIGk5MTVfc3dfZmVuY2Vfc2lnbmFsZWQoJnJlcXVlc3QtPnNlbWFwaG9yZSkpCi0JCXJlcXVl
c3QtPmh3X2NvbnRleHQtPnNhdHVyYXRlZCB8PSByZXF1ZXN0LT5zY2hlZC5zZW1hcGhvcmVzOwor
CQllbmdpbmUtPnNhdHVyYXRlZCB8PSByZXF1ZXN0LT5zY2hlZC5zZW1hcGhvcmVzOwogCiAJLyog
V2UgbWF5IGJlIHJlY3Vyc2luZyBmcm9tIHRoZSBzaWduYWwgY2FsbGJhY2sgb2YgYW5vdGhlciBp
OTE1IGZlbmNlICovCiAJc3Bpbl9sb2NrX25lc3RlZCgmcmVxdWVzdC0+bG9jaywgU0lOR0xFX0RF
UFRIX05FU1RJTkcpOwpAQCAtNzk5LDcgKzc5OSw3IEBAIGFscmVhZHlfYnVzeXdhaXRpbmcoc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJICoKIAkgKiBTZWUgdGhlIGFyZS13ZS10b28tbGF0ZT8g
Y2hlY2sgaW4gX19pOTE1X3JlcXVlc3Rfc3VibWl0KCkuCiAJICovCi0JcmV0dXJuIHJxLT5zY2hl
ZC5zZW1hcGhvcmVzIHwgcnEtPmh3X2NvbnRleHQtPnNhdHVyYXRlZDsKKwlyZXR1cm4gcnEtPnNj
aGVkLnNlbWFwaG9yZXMgfCBycS0+ZW5naW5lLT5zYXR1cmF0ZWQ7CiB9CiAKIHN0YXRpYyBpbnQK
LS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

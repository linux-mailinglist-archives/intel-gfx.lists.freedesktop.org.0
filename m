Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CE61523EA28
	for <lists+intel-gfx@lfdr.de>; Fri,  7 Aug 2020 11:22:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 00E036E9A1;
	Fri,  7 Aug 2020 09:21:55 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 001686E998;
 Fri,  7 Aug 2020 09:21:51 +0000 (UTC)
IronPort-SDR: eX10jH9rM3F7AZxGi0NDerIbHGpei8VcZO9orbQ9J7EKMGpScuIw8PvK3y3VfP+pZTur5lc7bC
 VQj2SRrlQREQ==
X-IronPort-AV: E=McAfee;i="6000,8403,9705"; a="171106880"
X-IronPort-AV: E=Sophos;i="5.75,445,1589266800"; d="scan'208";a="171106880"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga101.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 07 Aug 2020 02:21:51 -0700
IronPort-SDR: PH+70IW9NlKGQhjcmunH/h1eeLaywxqhSu8Hq8lbyuBwR+zhohy2IHi2rplSulKzWNH8PjwbPc
 4Rqx4k0AQeow==
X-IronPort-AV: E=Sophos;i="5.75,445,1589266800"; d="scan'208";a="333492113"
Received: from jkrzyszt-desk.igk.intel.com ([172.22.244.18])
 by orsmga007-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 07 Aug 2020 02:21:49 -0700
From: Janusz Krzysztofik <janusz.krzysztofik@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Fri,  7 Aug 2020 11:19:52 +0200
Message-Id: <20200807092002.32350-7-janusz.krzysztofik@linux.intel.com>
X-Mailer: git-send-email 2.21.1
In-Reply-To: <20200807092002.32350-1-janusz.krzysztofik@linux.intel.com>
References: <20200807092002.32350-1-janusz.krzysztofik@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t v2 06/16] tests/core_hotunplug: Maintain a
 single data structure instance
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org,
 =?UTF-8?q?Micha=C5=82=20Winiarski?= <michal.winiarski@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIGZvbGxvd2luZyBjaGFuZ2VzIHRvIHRoZSB0ZXN0IGFyZSBwbGFubmVkOgotIGF2b2lkIGds
b2JhbCB2YXJpYWJsZXMsCi0gc2tpcCBzdWJ0ZXN0IGFmdGVyIGRldmljZSBjbG9zZSBlcnJvcnMs
Ci0gcHJlcGFyZSBpbnZhcmlhbnQgZGF0YSBvbmx5IG9uY2UgcGVyIHRlc3QgcnVuLAotIG1vdmUg
ZGV2aWNlIGhlYWx0aCBjaGVja3MgdG8gaWd0X2ZpeHR1cmUgc2VjdGlvbnMsCi0gdHJ5IHRvIHJl
Y292ZXIgZnJvbSBzdWJ0ZXN0IGZhaWx1cmVzIGluc3RlYWQgb2YgYWJvcnRpbmcuCkZvciB0aGF0
IHRvIGJlIHBvc3NpYmxlLCBtYWludGFpbiBhIHNpbmdsZSBpbnN0YW5jZSBvZiBob3R1bnBsdWcK
c3RydWN0dXJlIGF0IGlndF9tYWluIGxldmVsIGFuZCBwYXNzIGl0IGRvd24gdG8gc3VidGVzdHMu
Cgp2MjogUmViYXNlIG9uIGN1cnJlbnQgdXBzdHJlYW0gbWFzdGVyLgoKU2lnbmVkLW9mZi1ieTog
SmFudXN6IEtyenlzenRvZmlrIDxqYW51c3oua3J6eXN6dG9maWtAbGludXguaW50ZWwuY29tPgpS
ZXZpZXdlZC1ieTogTWljaGHFgiBXaW5pYXJza2kgPG1pY2hhbC53aW5pYXJza2lAaW50ZWwuY29t
PgotLS0KIHRlc3RzL2NvcmVfaG90dW5wbHVnLmMgfCA1NiArKysrKysrKysrKysrKysrKysrKy0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAyNiBpbnNlcnRpb25zKCspLCAz
MCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90ZXN0cy9jb3JlX2hvdHVucGx1Zy5jIGIvdGVz
dHMvY29yZV9ob3R1bnBsdWcuYwppbmRleCBjYWM4OGMyZjMuLjBlNjFkYTJkMCAxMDA2NDQKLS0t
IGEvdGVzdHMvY29yZV9ob3R1bnBsdWcuYworKysgYi90ZXN0cy9jb3JlX2hvdHVucGx1Zy5jCkBA
IC0xODMsNjggKzE4Myw2MiBAQCBzdGF0aWMgdm9pZCBzZXRfZmlsdGVyX2Zyb21fZGV2aWNlKGlu
dCBmZCkKIAogLyogU3VidGVzdHMgKi8KIAotc3RhdGljIHZvaWQgdW5iaW5kX3JlYmluZCh2b2lk
KQorc3RhdGljIHZvaWQgdW5iaW5kX3JlYmluZChzdHJ1Y3QgaG90dW5wbHVnICpwcml2KQogewot
CXN0cnVjdCBob3R1bnBsdWcgcHJpdjsKIAljaGFyIGJ1ZltQQVRIX01BWF07CiAKLQlwcmVwYXJl
KCZwcml2LCBidWYsIHNpemVvZihidWYpKTsKKwlwcmVwYXJlKHByaXYsIGJ1Ziwgc2l6ZW9mKGJ1
ZikpOwogCiAJaWd0X2RlYnVnKCJjbG9zaW5nIHRoZSBkZXZpY2VcbiIpOwotCWNsb3NlKHByaXYu
ZmQuZHJtKTsKKwljbG9zZShwcml2LT5mZC5kcm0pOwogCi0JZHJpdmVyX3VuYmluZChwcml2LmZk
LnN5c2ZzX2RydiwgcHJpdi5kZXZfYnVzX2FkZHIsICIiKTsKKwlkcml2ZXJfdW5iaW5kKHByaXYt
PmZkLnN5c2ZzX2RydiwgcHJpdi0+ZGV2X2J1c19hZGRyLCAiIik7CiAKLQlkcml2ZXJfYmluZChw
cml2LmZkLnN5c2ZzX2RydiwgcHJpdi5kZXZfYnVzX2FkZHIpOworCWRyaXZlcl9iaW5kKHByaXYt
PmZkLnN5c2ZzX2RydiwgcHJpdi0+ZGV2X2J1c19hZGRyKTsKIAogCWhlYWx0aGNoZWNrKCk7CiB9
CiAKLXN0YXRpYyB2b2lkIHVucGx1Z19yZXNjYW4odm9pZCkKK3N0YXRpYyB2b2lkIHVucGx1Z19y
ZXNjYW4oc3RydWN0IGhvdHVucGx1ZyAqcHJpdikKIHsKLQlzdHJ1Y3QgaG90dW5wbHVnIHByaXY7
Ci0KLQlwcmVwYXJlKCZwcml2LCBOVUxMLCAwKTsKKwlwcmVwYXJlKHByaXYsIE5VTEwsIDApOwog
CiAJaWd0X2RlYnVnKCJjbG9zaW5nIHRoZSBkZXZpY2VcbiIpOwotCWNsb3NlKHByaXYuZmQuZHJt
KTsKKwljbG9zZShwcml2LT5mZC5kcm0pOwogCi0JZGV2aWNlX3VucGx1Zyhwcml2LmZkLnN5c2Zz
X2RldiwgIiIpOworCWRldmljZV91bnBsdWcocHJpdi0+ZmQuc3lzZnNfZGV2LCAiIik7CiAKLQli
dXNfcmVzY2FuKHByaXYuZmQuc3lzZnNfYnVzKTsKKwlidXNfcmVzY2FuKHByaXYtPmZkLnN5c2Zz
X2J1cyk7CiAKIAloZWFsdGhjaGVjaygpOwogfQogCi1zdGF0aWMgdm9pZCBob3R1bmJpbmRfbGF0
ZWNsb3NlKHZvaWQpCitzdGF0aWMgdm9pZCBob3R1bmJpbmRfbGF0ZWNsb3NlKHN0cnVjdCBob3R1
bnBsdWcgKnByaXYpCiB7Ci0Jc3RydWN0IGhvdHVucGx1ZyBwcml2OwogCWNoYXIgYnVmW1BBVEhf
TUFYXTsKIAotCXByZXBhcmUoJnByaXYsIGJ1Ziwgc2l6ZW9mKGJ1ZikpOworCXByZXBhcmUocHJp
diwgYnVmLCBzaXplb2YoYnVmKSk7CiAKLQlkcml2ZXJfdW5iaW5kKHByaXYuZmQuc3lzZnNfZHJ2
LCBwcml2LmRldl9idXNfYWRkciwgImhvdCAiKTsKKwlkcml2ZXJfdW5iaW5kKHByaXYtPmZkLnN5
c2ZzX2RydiwgcHJpdi0+ZGV2X2J1c19hZGRyLCAiaG90ICIpOwogCi0JZHJpdmVyX2JpbmQocHJp
di5mZC5zeXNmc19kcnYsIHByaXYuZGV2X2J1c19hZGRyKTsKKwlkcml2ZXJfYmluZChwcml2LT5m
ZC5zeXNmc19kcnYsIHByaXYtPmRldl9idXNfYWRkcik7CiAKIAlpZ3RfZGVidWcoImxhdGUgY2xv
c2luZyB0aGUgdW5ib3VuZCBkZXZpY2UgaW5zdGFuY2VcbiIpOwotCWNsb3NlKHByaXYuZmQuZHJt
KTsKKwljbG9zZShwcml2LT5mZC5kcm0pOwogCiAJaGVhbHRoY2hlY2soKTsKIH0KIAotc3RhdGlj
IHZvaWQgaG90dW5wbHVnX2xhdGVjbG9zZSh2b2lkKQorc3RhdGljIHZvaWQgaG90dW5wbHVnX2xh
dGVjbG9zZShzdHJ1Y3QgaG90dW5wbHVnICpwcml2KQogewotCXN0cnVjdCBob3R1bnBsdWcgcHJp
djsKLQotCXByZXBhcmUoJnByaXYsIE5VTEwsIDApOworCXByZXBhcmUocHJpdiwgTlVMTCwgMCk7
CiAKLQlkZXZpY2VfdW5wbHVnKHByaXYuZmQuc3lzZnNfZGV2LCAiaG90ICIpOworCWRldmljZV91
bnBsdWcocHJpdi0+ZmQuc3lzZnNfZGV2LCAiaG90ICIpOwogCi0JYnVzX3Jlc2Nhbihwcml2LmZk
LnN5c2ZzX2J1cyk7CisJYnVzX3Jlc2Nhbihwcml2LT5mZC5zeXNmc19idXMpOwogCiAJaWd0X2Rl
YnVnKCJsYXRlIGNsb3NpbmcgdGhlIHJlbW92ZWQgZGV2aWNlIGluc3RhbmNlXG4iKTsKLQljbG9z
ZShwcml2LmZkLmRybSk7CisJY2xvc2UocHJpdi0+ZmQuZHJtKTsKIAogCWhlYWx0aGNoZWNrKCk7
CiB9CkBAIC0yNTMsNiArMjQ3LDggQEAgc3RhdGljIHZvaWQgaG90dW5wbHVnX2xhdGVjbG9zZSh2
b2lkKQogCiBpZ3RfbWFpbgogeworCXN0cnVjdCBob3R1bnBsdWcgcHJpdjsKKwogCWlndF9maXh0
dXJlIHsKIAkJaW50IGZkX2RybTsKIApAQCAtMjc1LDI4ICsyNzEsMjggQEAgaWd0X21haW4KIAog
CWlndF9kZXNjcmliZSgiQ2hlY2sgaWYgdGhlIGRyaXZlciBjYW4gYmUgY2xlYW5seSB1bmJvdW5k
IGZyb20gYSBkZXZpY2UgYmVsaWV2ZWQgdG8gYmUgY2xvc2VkIik7CiAJaWd0X3N1YnRlc3QoInVu
YmluZC1yZWJpbmQiKQotCQl1bmJpbmRfcmViaW5kKCk7CisJCXVuYmluZF9yZWJpbmQoJnByaXYp
OwogCiAJaWd0X2ZpeHR1cmUKIAkJaWd0X2Fib3J0X29uX2YoZmFpbHVyZSwgIiVzXG4iLCBmYWls
dXJlKTsKIAogCWlndF9kZXNjcmliZSgiQ2hlY2sgaWYgYSBkZXZpY2UgYmVsaWV2ZWQgdG8gYmUg
Y2xvc2VkIGNhbiBiZSBjbGVhbmx5IHVucGx1Z2dlZCIpOwogCWlndF9zdWJ0ZXN0KCJ1bnBsdWct
cmVzY2FuIikKLQkJdW5wbHVnX3Jlc2NhbigpOworCQl1bnBsdWdfcmVzY2FuKCZwcml2KTsKIAog
CWlndF9maXh0dXJlCiAJCWlndF9hYm9ydF9vbl9mKGZhaWx1cmUsICIlc1xuIiwgZmFpbHVyZSk7
CiAKIAlpZ3RfZGVzY3JpYmUoIkNoZWNrIGlmIHRoZSBkcml2ZXIgY2FuIGJlIGNsZWFubHkgdW5i
b3VuZCBmcm9tIGEgc3RpbGwgb3BlbiBkZXZpY2UsIHRoZW4gcmVsZWFzZWQiKTsKIAlpZ3Rfc3Vi
dGVzdCgiaG90dW5iaW5kLWxhdGVjbG9zZSIpCi0JCWhvdHVuYmluZF9sYXRlY2xvc2UoKTsKKwkJ
aG90dW5iaW5kX2xhdGVjbG9zZSgmcHJpdik7CiAKIAlpZ3RfZml4dHVyZQogCQlpZ3RfYWJvcnRf
b25fZihmYWlsdXJlLCAiJXNcbiIsIGZhaWx1cmUpOwogCiAJaWd0X2Rlc2NyaWJlKCJDaGVjayBp
ZiBhIHN0aWxsIG9wZW4gZGV2aWNlIGNhbiBiZSBjbGVhbmx5IHVucGx1Z2dlZCwgdGhlbiByZWxl
YXNlZCIpOwogCWlndF9zdWJ0ZXN0KCJob3R1bnBsdWctbGF0ZWNsb3NlIikKLQkJaG90dW5wbHVn
X2xhdGVjbG9zZSgpOworCQlob3R1bnBsdWdfbGF0ZWNsb3NlKCZwcml2KTsKIAogCWlndF9maXh0
dXJlCiAJCWlndF9hYm9ydF9vbl9mKGZhaWx1cmUsICIlc1xuIiwgZmFpbHVyZSk7Ci0tIAoyLjIx
LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVs
LWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CE74D3A9EFB
	for <lists+intel-gfx@lfdr.de>; Wed, 16 Jun 2021 17:25:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 265856E04B;
	Wed, 16 Jun 2021 15:25:37 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CA7AA6E483;
 Wed, 16 Jun 2021 15:25:35 +0000 (UTC)
IronPort-SDR: 8fSEFKGHIFYou8GKz6Wg9Zwf75kkGKlEavennTaJZZc6g9SojXpmIaKiWXydwuWr2JkEXauFy6
 NE5eopm83QNQ==
X-IronPort-AV: E=McAfee;i="6200,9189,10016"; a="206234402"
X-IronPort-AV: E=Sophos;i="5.83,278,1616482800"; d="scan'208";a="206234402"
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by orsmga103.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 16 Jun 2021 08:25:28 -0700
IronPort-SDR: bCJSkex3VrlPKMSxrxXi6Wg6OxzlhTGnjX5TXjUGZXFpniZcbjsiqce5Xw8cXMpUzYAR4TdlCb
 i0ZmVjPQysHA==
X-IronPort-AV: E=Sophos;i="5.83,278,1616482800"; d="scan'208";a="479129886"
Received: from mrapopor-mobl.ger.corp.intel.com (HELO mwauld-desk1.intel.com)
 ([10.213.236.122])
 by fmsmga003-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 16 Jun 2021 08:25:26 -0700
From: Matthew Auld <matthew.auld@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 16 Jun 2021 16:24:56 +0100
Message-Id: <20210616152501.394518-2-matthew.auld@intel.com>
X-Mailer: git-send-email 2.26.3
In-Reply-To: <20210616152501.394518-1-matthew.auld@intel.com>
References: <20210616152501.394518-1-matthew.auld@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v5 2/7] drm/i915/ttm: add
 i915_sg_from_buddy_resource
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: =?UTF-8?q?Thomas=20Hellstr=C3=B6m?= <thomas.hellstrom@linux.intel.com>,
 dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgbmVlZCB0byBiZSBhYmxlIHRvIGJ1aWxkIGFuIHNnIHRhYmxlIGZyb20gb3VyIGxpc3Qgb2Yg
YnVkZHkgYmxvY2tzLApzbyB0aGF0IHdlIGNhbiBsYXRlciBwbHVnIHRoaXMgaW50byBvdXIgdHRt
IGJhY2tlbmQsIGFuZCByZXBsYWNlIG91ciB1c2UKb2YgdGhlIHJhbmdlIG1hbmFnZXIuCgpTaWdu
ZWQtb2ZmLWJ5OiBNYXR0aGV3IEF1bGQgPG1hdHRoZXcuYXVsZEBpbnRlbC5jb20+CkNjOiBUaG9t
YXMgSGVsbHN0csO2bSA8dGhvbWFzLmhlbGxzdHJvbUBsaW51eC5pbnRlbC5jb20+ClJldmlld2Vk
LWJ5OiBUaG9tYXMgSGVsbHN0csO2bSA8dGhvbWFzLmhlbGxzdHJvbUBsaW51eC5pbnRlbC5jb20+
Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2F0dGVybGlzdC5jIHwgODAgKysrKysr
KysrKysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2F0dGVybGlz
dC5oIHwgIDUgKysKIDIgZmlsZXMgY2hhbmdlZCwgODUgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NhdHRlcmxpc3QuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfc2NhdHRlcmxpc3QuYwppbmRleCA2OWU5ZTZjMzEzNWUuLjRhNjcxMmRj
YTgzOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2F0dGVybGlzdC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NhdHRlcmxpc3QuYwpAQCAtNiw2ICs2
LDkgQEAKIAogI2luY2x1ZGUgImk5MTVfc2NhdHRlcmxpc3QuaCIKIAorI2luY2x1ZGUgImk5MTVf
YnVkZHkuaCIKKyNpbmNsdWRlICJpOTE1X3R0bV9idWRkeV9tYW5hZ2VyLmgiCisKICNpbmNsdWRl
IDxkcm0vZHJtX21tLmg+CiAKICNpbmNsdWRlIDxsaW51eC9zbGFiLmg+CkBAIC0xMDQsNiArMTA3
LDgzIEBAIHN0cnVjdCBzZ190YWJsZSAqaTkxNV9zZ19mcm9tX21tX25vZGUoY29uc3Qgc3RydWN0
IGRybV9tbV9ub2RlICpub2RlLAogCXJldHVybiBzdDsKIH0KIAorLyoqCisgKiBpOTE1X3NnX2Zy
b21fYnVkZHlfcmVzb3VyY2UgLSBDcmVhdGUgYW4gc2dfdGFibGUgZnJvbSBhIHN0cnVjdAorICog
aTkxNV9idWRkeV9ibG9jayBsaXN0CisgKiBAcmVzOiBUaGUgc3RydWN0IGk5MTVfdHRtX2J1ZGR5
X3Jlc291cmNlLgorICogQHJlZ2lvbl9zdGFydDogQW4gb2Zmc2V0IHRvIGFkZCB0byB0aGUgZG1h
IGFkZHJlc3NlcyBvZiB0aGUgc2cgbGlzdC4KKyAqCisgKiBDcmVhdGUgYSBzdHJ1Y3Qgc2dfdGFi
bGUsIGluaXRpYWxpemluZyBpdCBmcm9tIHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrIGxpc3QsCisg
KiB0YWtpbmcgYSBtYXhpbXVtIHNlZ21lbnQgbGVuZ3RoIGludG8gYWNjb3VudCwgc3BsaXR0aW5n
IGludG8gc2VnbWVudHMKKyAqIGlmIG5lY2Vzc2FyeS4KKyAqCisgKiBSZXR1cm46IEEgcG9pbnRl
ciB0byBhIGttYWxsb2NlZCBzdHJ1Y3Qgc2dfdGFibGUgb24gc3VjY2VzcywgbmVnYXRpdmUKKyAq
IGVycm9yIGNvZGUgY2FzdCB0byBhbiBlcnJvciBwb2ludGVyIG9uIGZhaWx1cmUuCisgKi8KK3N0
cnVjdCBzZ190YWJsZSAqaTkxNV9zZ19mcm9tX2J1ZGR5X3Jlc291cmNlKHN0cnVjdCB0dG1fcmVz
b3VyY2UgKnJlcywKKwkJCQkJICAgICB1NjQgcmVnaW9uX3N0YXJ0KQoreworCXN0cnVjdCBpOTE1
X3R0bV9idWRkeV9yZXNvdXJjZSAqYm1hbl9yZXMgPSB0b190dG1fYnVkZHlfcmVzb3VyY2UocmVz
KTsKKwljb25zdCB1NjQgc2l6ZSA9IHJlcy0+bnVtX3BhZ2VzIDw8IFBBR0VfU0hJRlQ7CisJY29u
c3QgdTY0IG1heF9zZWdtZW50ID0gcm91bmRkb3duKFVJTlRfTUFYLCBQQUdFX1NJWkUpOworCXN0
cnVjdCBpOTE1X2J1ZGR5X21tICptbSA9IGJtYW5fcmVzLT5tbTsKKwlzdHJ1Y3QgbGlzdF9oZWFk
ICpibG9ja3MgPSAmYm1hbl9yZXMtPmJsb2NrczsKKwlzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAq
YmxvY2s7CisJc3RydWN0IHNjYXR0ZXJsaXN0ICpzZzsKKwlzdHJ1Y3Qgc2dfdGFibGUgKnN0Owor
CXJlc291cmNlX3NpemVfdCBwcmV2X2VuZDsKKworCUdFTV9CVUdfT04obGlzdF9lbXB0eShibG9j
a3MpKTsKKworCXN0ID0ga21hbGxvYyhzaXplb2YoKnN0KSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFz
dCkKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwlpZiAoc2dfYWxsb2NfdGFibGUoc3Qs
IHJlcy0+bnVtX3BhZ2VzLCBHRlBfS0VSTkVMKSkgeworCQlrZnJlZShzdCk7CisJCXJldHVybiBF
UlJfUFRSKC1FTk9NRU0pOworCX0KKworCXNnID0gc3QtPnNnbDsKKwlzdC0+bmVudHMgPSAwOwor
CXByZXZfZW5kID0gKHJlc291cmNlX3NpemVfdCktMTsKKworCWxpc3RfZm9yX2VhY2hfZW50cnko
YmxvY2ssIGJsb2NrcywgbGluaykgeworCQl1NjQgYmxvY2tfc2l6ZSwgb2Zmc2V0OworCisJCWJs
b2NrX3NpemUgPSBtaW5fdCh1NjQsIHNpemUsIGk5MTVfYnVkZHlfYmxvY2tfc2l6ZShtbSwgYmxv
Y2spKTsKKwkJb2Zmc2V0ID0gaTkxNV9idWRkeV9ibG9ja19vZmZzZXQoYmxvY2spOworCisJCXdo
aWxlIChibG9ja19zaXplKSB7CisJCQl1NjQgbGVuOworCisJCQlpZiAob2Zmc2V0ICE9IHByZXZf
ZW5kIHx8IHNnLT5sZW5ndGggPj0gbWF4X3NlZ21lbnQpIHsKKwkJCQlpZiAoc3QtPm5lbnRzKQor
CQkJCQlzZyA9IF9fc2dfbmV4dChzZyk7CisKKwkJCQlzZ19kbWFfYWRkcmVzcyhzZykgPSByZWdp
b25fc3RhcnQgKyBvZmZzZXQ7CisJCQkJc2dfZG1hX2xlbihzZykgPSAwOworCQkJCXNnLT5sZW5n
dGggPSAwOworCQkJCXN0LT5uZW50cysrOworCQkJfQorCisJCQlsZW4gPSBtaW4oYmxvY2tfc2l6
ZSwgbWF4X3NlZ21lbnQgLSBzZy0+bGVuZ3RoKTsKKwkJCXNnLT5sZW5ndGggKz0gbGVuOworCQkJ
c2dfZG1hX2xlbihzZykgKz0gbGVuOworCisJCQlvZmZzZXQgKz0gbGVuOworCQkJYmxvY2tfc2l6
ZSAtPSBsZW47CisKKwkJCXByZXZfZW5kID0gb2Zmc2V0OworCQl9CisJfQorCisJc2dfbWFya19l
bmQoc2cpOworCWk5MTVfc2dfdHJpbShzdCk7CisKKwlyZXR1cm4gc3Q7Cit9CisKICNpZiBJU19F
TkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKICNpbmNsdWRlICJzZWxmdGVzdHMvc2Nh
dHRlcmxpc3QuYyIKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9zY2F0dGVybGlzdC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2F0dGVybGlzdC5o
CmluZGV4IDVhY2NhNDVlYTk4MS4uYjhiZDU5MjViMDNmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3NjYXR0ZXJsaXN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zY2F0dGVybGlzdC5oCkBAIC0xNCw2ICsxNCw3IEBACiAjaW5jbHVkZSAiaTkxNV9nZW0u
aCIKIAogc3RydWN0IGRybV9tbV9ub2RlOworc3RydWN0IHR0bV9yZXNvdXJjZTsKIAogLyoKICAq
IE9wdGltaXNlZCBTR0wgaXRlcmF0b3IgZm9yIEdFTSBvYmplY3RzCkBAIC0xNDUsNCArMTQ2LDgg
QEAgYm9vbCBpOTE1X3NnX3RyaW0oc3RydWN0IHNnX3RhYmxlICpvcmlnX3N0KTsKIAogc3RydWN0
IHNnX3RhYmxlICppOTE1X3NnX2Zyb21fbW1fbm9kZShjb25zdCBzdHJ1Y3QgZHJtX21tX25vZGUg
Km5vZGUsCiAJCQkJICAgICAgdTY0IHJlZ2lvbl9zdGFydCk7CisKK3N0cnVjdCBzZ190YWJsZSAq
aTkxNV9zZ19mcm9tX2J1ZGR5X3Jlc291cmNlKHN0cnVjdCB0dG1fcmVzb3VyY2UgKnJlcywKKwkJ
CQkJICAgICB1NjQgcmVnaW9uX3N0YXJ0KTsKKwogI2VuZGlmCi0tIAoyLjI2LjMKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5n
IGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=
